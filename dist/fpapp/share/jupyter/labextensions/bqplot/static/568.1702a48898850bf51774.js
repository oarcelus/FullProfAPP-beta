(self.webpackChunkbqplot=self.webpackChunkbqplot||[]).push([[568],{7931:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Axis=void 0;const n=s(5335),l=r(s(8944));s(2802);const o=r(s(6988)),d=r(s(8731));Math.log10=Math.log10||function(e){return Math.log(e)/Math.LN10};const c=["em","ex","px"];class h extends n.WidgetView{initialize(){this.setElement(document.createElementNS(l.namespaces.svg,"g")),this.d3el=l.select(this.el),super.initialize.apply(this,arguments)}render(){this.d3el.style("display",this.model.get("visible")?"inline":"none"),this.parent=this.options.parent;const e=this.set_scale_promise(this.model.get("scale")),t=this.get_offset_promise();Promise.all([e,t]).then((()=>{this.create_listeners(),this.tick_format=this.generate_tick_formatter(),this.set_scales_range(),this.append_axis()}))}create_listeners(){this.listenTo(this.model,"change:scale",((e,t)=>{this.update_scale(e.previous("scale"),t),this.axis.scale(this.axis_scale.scale),this.rescale_axis()})),this.listenTo(this.model,"change:tick_values",this.set_tick_values),this.listenTo(this.model,"change:tick_format",this.tickformat_changed),this.listenTo(this.model,"change:num_ticks",this.set_tick_values),this.listenTo(this.model,"change:tick_rotate",this.apply_tick_styling),this.listenTo(this.model,"change:tick_style",this.apply_tick_styling),this.model.on_some_change(["label","label_color"],this.update_label,this),this.listenTo(this.model,"change:color",this.update_color),this.model.on_some_change(["grid_color","grid_lines"],this.update_grid_lines,this),this.listenTo(this.model,"change:label_location",this.update_label_location),this.listenTo(this.model,"change:label_offset",this.update_label_offset),this.listenTo(this.model,"change:visible",this.update_visibility),this.model.on_some_change(["side","orientation"],this.update_display,this),this.listenTo(this.model,"change:offset",this.update_offset),this.listenTo(this.parent,"margin_updated",this.parent_margin_updated)}update_offset(){this.get_offset_promise().then((()=>{this.set_scales_range(),this.update_offset_scale_domain(),this.g_axisline.attr("transform",this.get_axis_transform()),this.update_grid_lines()}))}update_display(){this.g_axisline.remove(),this.set_scales_range(),this.append_axis()}set_tick_values(e){let t=[];const s=this.model.get("tick_values"),i=this.model.get("num_ticks");if(null!=s&&s.length>0)this.axis.tickValues(this.get_ticks_from_array_or_length(s));else if(null!=i)this.axis.tickValues(this.get_ticks_from_array_or_length());else if("ordinal"===this.axis_scale.model.type)this.axis.tickValues(this.axis_scale.scale.domain());else if("date"===this.axis_scale.model.type){const e=this.width<500?5:void 0;this.axis.tickValues(this.axis_scale.scale.ticks(e))}else if("log"===this.axis_scale.model.type){let e,s;const i=this.axis_scale.scale.ticks(),a=Math.abs(Math.log10(this.axis_scale.scale.domain()[1]/this.axis_scale.scale.domain()[0]));if(a<2)this.axis.tickValues(i);else if(a<7){for(t=[],e=0;e<i.length;e++)s=Math.abs(Math.log10(i[e])%1),(Math.abs(s)<.001||Math.abs(s-1)<.001||Math.abs(s-.30103)<.001||Math.abs(s-.69897)<.001)&&t.push(i[e]);this.axis.tickValues(t)}else{t=[];const r=Math.round(a/10);for(e=0;e<i.length;e++)s=Math.abs(Math.log10(i[e])%r),(Math.abs(s)<.001||Math.abs(s-r)<.001)&&t.push(i[e]);this.axis.tickValues(t)}}else this.axis.tickValues(this.axis_scale.scale.ticks());null!==this.model.get("tick_format")&&void 0!==this.model.get("tick_format")||"ordinal"!==this.axis_scale.type&&(this.tick_format=this.guess_tick_format(this.axis.tickValues())),this.axis.tickFormat(this.tick_format),this.g_axisline&&(this.g_axisline.transition("set_tick_values").duration(!0===e?this.parent.model.get("animation_duration"):0).call(this.axis),this.apply_tick_styling())}tickformat_changed(){this.tick_format=this.generate_tick_formatter(),this.axis.tickFormat(this.tick_format),this.g_axisline&&this.g_axisline.call(this.axis),this.apply_tick_styling()}apply_tick_styling(){this.g_axisline.selectAll(".tick text").styles(this.model.get("tick_style")).attr("transform",this.get_tick_transforms())}get_tick_transforms(){return`rotate(${this.model.get("tick_rotate")})`}update_scales(){this.update_scale_domain(),this.update_offset_scale_domain()}update_scale_domain(){const e="vertical"===this.model.get("orientation"),t=e?this.parent.padded_range("y",this.axis_scale.model):this.parent.padded_range("x",this.axis_scale.model),s=e?this.parent.range("y"):this.parent.range("x");this.axis_scale.expand_domain(t,s),this.axis.scale(this.axis_scale.scale)}update_offset_scale_domain(){const e="vertical"===this.model.get("orientation");if(this.offset_scale){const t=e?this.parent.padded_range("x",this.offset_scale.model):this.parent.padded_range("y",this.offset_scale.model),s=e?this.parent.range("x"):this.parent.range("y");this.offset_scale.expand_domain(t,s)}}generate_tick_formatter(){if("date"===this.axis_scale.model.type||"date_color_linear"===this.axis_scale.model.type)return this.model.get("tick_format")?l.utcFormat(this.model.get("tick_format")):this.guess_tick_format();if("ordinal"===this.axis_scale.model.type){const e=this.model.get("tick_format");return e?o.is_valid_time_format(e)?l.utcFormat(e):l.format(e):e=>e}return this.model.get("tick_format")?l.format(this.model.get("tick_format")):this.guess_tick_format()}set_scales_range(){const e="vertical"===this.model.get("orientation");this.axis_scale.set_range(e?[this.height,0]:[0,this.width]),this.offset_scale&&this.offset_scale.set_range(e?[0,this.width]:[this.height,0])}create_axis(){const e="vertical"===this.model.get("orientation"),t=this.model.get("side");this.axis=e?"right"===t?l.axisRight(this.axis_scale.scale):l.axisLeft(this.axis_scale.scale):"top"===t?l.axisTop(this.axis_scale.scale):l.axisBottom(this.axis_scale.scale)}append_axis(){this.create_axis(),this.update_scales(),this.g_axisline=this.d3el.append("g").attr("class","axis").attr("transform",this.get_axis_transform()).call(this.axis),this.g_axisline.append("text").attr("class","axislabel").attrs(this.get_label_attributes()).styles(this.get_text_styling()).text(this.model.get("label")),this.set_tick_values(),this.update_grid_lines(),this.update_color(),this.apply_tick_styling(),this.update_label()}get_offset_promise(){let e=Promise.resolve();const t=this.model.get("offset"),s="vertical"===this.model.get("orientation");return void 0!==t.value&&null!==t.value?(void 0===t.scale?this.offset_scale=s?this.parent.scale_x:this.parent.scale_y:e=this.create_child_view(t.scale).then((e=>{this.offset_scale=e,"ordinal"!==this.offset_scale.model.type&&this.offset_scale.scale.clamp(!0),this.offset_scale.on("domain_changed",(()=>{this.update_offset_scale_domain(),this.g_axisline.attr("transform",this.get_axis_transform()),this.update_grid_lines()}))})),this.offset_value=t.value):this.offset_scale=this.offset_value=void 0,e}highlight(){this.g_axisline.classed("axisbold",!0)}unhighlight(){this.g_axisline.classed("axisbold",!1)}get_basic_transform(){const e="vertical"===this.model.get("orientation"),t=this.model.get("side");return e?"right"===t?this.width:0:"top"===t?0:this.height}get_axis_transform(){return"vertical"===this.model.get("orientation")?"translate("+this.process_offset()+", 0)":"translate(0, "+this.process_offset()+")"}process_offset(){if(void 0===this.offset_scale||null===this.offset_scale)return this.get_basic_transform();{let e=this.offset_scale.scale(this.offset_value);return e=void 0===e?this.get_basic_transform():e,this.offset_scale.offset+e}}get_label_attributes(){let e=0;const t=this.model.get("label_location"),s=this.calculate_label_offset(),i="vertical"===this.model.get("orientation"),a=this.model.get("side");return i?("start"===t?e=-this.height:"middle"===t&&(e=-this.height/2),"right"===a?{transform:"rotate(-90)",x:e,y:s,dy:"1ex",dx:"0em"}:{transform:"rotate(-90)",x:e,y:s,dy:"0em",dx:"0em"}):("middle"===t?e=this.width/2:"end"===t&&(e=this.width),"top"===a?{x:e,y:s,dy:"0.75ex",dx:"0em",transform:""}:{x:e,y:s,dy:"0.25ex",dx:"0em",transform:""})}get_text_styling(){const e=this.model.get("label_location");return"start"===e?{"text-anchor":"start"}:"end"===e?{"text-anchor":"end"}:{"text-anchor":"middle"}}update_label(){this.g_axisline.select("text.axislabel").text(this.model.get("label")),this.d3el.selectAll(".axislabel").selectAll("text"),""!==this.model.get("label_color")&&null!==this.model.get("label_color")&&(this.g_axisline.select("text.axislabel").style("fill",this.model.get("label_color")),this.d3el.selectAll(".axislabel").selectAll("text").style("fill",this.model.get("label_color")))}update_label_location(){this.g_axisline.select("text.axislabel").attrs(this.get_label_attributes()).styles(this.get_text_styling())}update_label_offset(e,t){this.label_offset=this.calculate_label_offset(),this.g_axisline.select("text.axislabel").attr("y",this.label_offset)}calculate_label_offset(){let e=this.model.get("label_offset");const t="vertical"===this.model.get("orientation"),s=this.model.get("side");e||(e=t?"4ex":"2em");let i=-1;for(let t=0;t<c.length&&-1===i;t++)i=e.indexOf(c[t]);if(-1===i)return e;if("top"===s||"left"===s){const t=-1*parseInt(e.substring(0,i));e=t+e.substring(i)}return e}update_grid_lines(e){const t=this.model.get("grid_lines"),s=this.model.get("side"),i=this.model.get("orientation"),a="vertical"!==i,r=!0===e?this.parent.model.get("animation_duration"):0;let n="vertical"===i?-this.width:-this.height,l=0;if(this.offset_scale){const e=this.offset_scale.scale(this.offset_value);"bottom"===s||"right"==s?(n=-e,l=a?this.height-e:this.width-e):(n+=e,l=-e)}"none"!==t?this.axis.tickSizeInner(n).tickSizeOuter(6):this.axis.tickSize(6),this.g_axisline.selectAll(".tick").classed("short","none"===t),this.g_axisline.transition("update_grid_lines").duration(r).call(this.axis).selectAll(".tick line").attr(a?"y1":"x1",this.offset_scale&&"none"!==t?l:null).style("stroke-dasharray","dashed"===t?"5, 5":null),this.apply_tick_styling(),this.model.get("grid_color")&&this.g_axisline.selectAll(".tick line").style("stroke",this.model.get("grid_color"))}update_color(){this.model.get("color")&&(this.d3el.selectAll(".tick").selectAll("text").style("fill",this.model.get("color")),this.d3el.selectAll(".domain").style("stroke",this.model.get("color")))}redraw_axisline(){this.update_scales(),this.set_tick_values(!0),this.update_grid_lines(!0)}rescale_axis(){this.set_scales_range(),this.update_axis_domain(),this.update_scales(),this.g_axisline.attr("transform",this.get_axis_transform()),this.g_axisline.call(this.axis),this.g_axisline.select("text.axislabel").attrs(this.get_label_attributes()).styles(this.get_text_styling()),this.set_tick_values(),this.update_grid_lines(),this.apply_tick_styling()}update_axis_domain(){const e=this.vertical?this.parent.padded_range("y",this.axis_scale.model):this.parent.padded_range("x",this.axis_scale.model),t=this.vertical?this.parent.range("y"):this.parent.range("x");this.axis_scale.expand_domain(e,t),this.axis.scale(this.axis_scale.scale)}parent_margin_updated(){this.rescale_axis()}update_visibility(e,t){this.d3el.style("display",t?"inline":"none")}get_ticks_from_array_or_length(e){let t,s;const i=this.model.get("num_ticks");if("ordinal"===this.axis_scale.model.type&&(e=this.axis_scale.scale.domain()),null!=i&&i<2)return[];if(e)return null==i||null==i||e.length<=i?e:(t=Math.floor(e.length/(i-1)),d.range(0,e.length,t).map((t=>e[t])));const a=this.axis_scale.scale.domain(),r=this.axis_scale.scale.domain().length-1;return t=(a[r]-a[0])/(i-1),"date"===this.axis_scale.model.type||"date_color_linear"===this.axis_scale.model.type?(a[0]=a[0].getTime(),a[r]=a[r].getTime(),s=a[r]+.5*t,d.range(a[0],s,t).map((e=>new Date(e)))):(s=a[r]+.5*t,d.range(a[0],s,t))}set_scale_promise(e){return this.axis_scale&&this.axis_scale.remove(),this.create_child_view(e).then((e=>{this.displayed.then((()=>{e.trigger("displayed")})),this.axis_scale=e,this.axis_scale.on("domain_changed",this.redraw_axisline,this),this.axis_scale.on("highlight_axis",this.highlight,this),this.axis_scale.on("unhighlight_axis",this.unhighlight,this)}))}update_scale(e,t){this.axis_scale.off(),this.set_scale_promise(t)}_get_digits(e){return 0===e?1:Math.floor(Math.log10(Math.abs(e)))+1}_replace_trailing_zeros(e){const t=e.search("e");return-1!=t?e.substring(0,t).replace(/(\.[0-9]*?)0+$/gi,"$1").replace(/\.$/,"")+e.substring(t):e.replace(/(\.[0-9]*?)0+$/gi,"$1").replace(/\.$/,"")}get_format_func(e){if(0===e)return e=>l.format("d")(Math.round(e));const t=-1==e?"":"."+e;return e=>{const s=l.format(t+"g")(e);if(s.replace(/-|\.|e/gi,"").length<6)return this._replace_trailing_zeros(s);if(""===t){let s=l.format(t+"e")(e);return s.length>=7&&(s=l.format(".6e")(e)),this._replace_trailing_zeros(s)}return this._replace_trailing_zeros(l.format(t+"e")(e))}}_linear_scale_precision(e){if(1===(e=null==e?this.axis_scale.scale.ticks():e).length)return 1;const t=Math.abs(e[1]-e[0]),s=Math.max(Math.abs(e[0]),Math.abs(e[e.length-1])),i=this._get_digits(s),a=this._get_digits(t),r=Math.abs(i-a);return i>=0&&a>0?i<=6?0:Math.min(r,6)+1:a<=0?Math.min(Math.abs(a)+i,6)+1:void 0}linear_sc_format(e){return this.get_format_func(this._linear_scale_precision(e))}date_sc_format(e){e=null==e?this.axis_scale.scale.ticks():e;const t=Math.abs(e[1]-e[0]),s=l.utcFormat(".%L"),i=l.utcFormat(":%S"),a=l.utcFormat("%I:%M"),r=l.utcFormat("%I %p"),n=l.utcFormat("%b %d"),o=l.utcFormat("%b %Y"),d=l.utcFormat("%Y");return e=>{let c=1e3;return 0===Math.floor(t/c)?l.utcSecond(e)<e?s(e):l.utcMinute(e)<e?i(e):a(e):0===Math.floor(t/(c*=60))?l.utcMinute(e)<e?i(e):a(e):0===Math.floor(t/(c*=60))?l.utcHour(e)<e?a(e):r(e):0===Math.floor(t/(c*=24))?l.utcDay(e)<e?r(e):n(e):0===Math.floor(t/(c*=27))||0===Math.floor(t/(c*=12))?l.utcMonth(e)<e?n(e):o(e):l.utcMonth(e)<e?n(e):l.utcYear(e)<e?o(e):d(e)}}log_sc_format(e){return this.get_format_func(this._log_sc_precision(e))}_log_sc_precision(e){return e=null==e?this.axis_scale.scale.ticks():e,Math.abs(Math.log10(e[1]/e[0]))>=.301?-1:3}guess_tick_format(e){return"linear"==this.axis_scale.model.type||"color_linear"==this.axis_scale.model.type?this.linear_sc_format(e):"date"==this.axis_scale.model.type||"date_color_linear"==this.axis_scale.model.type?this.date_sc_format(e):"log"==this.axis_scale.model.type?this.log_sc_format(e):void 0}get width(){return this.parent.width-this.parent.margin.right-this.parent.margin.left}get height(){return this.parent.height-this.parent.margin.top-this.parent.margin.bottom}get margin(){return this.parent.margin}}t.Axis=h},3391:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ColorAxisModel=t.AxisModel=void 0;const n=r(s(5335)),l=r(s(1961)),o=s(8657);class d extends n.WidgetModel{defaults(){return Object.assign(Object.assign({},n.WidgetModel.prototype.defaults()),{_model_name:"AxisModel",_view_name:"Axis",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:o.semver_range,_view_module_version:o.semver_range,orientation:"horizontal",side:null,label:"",grid_lines:"solid",tick_format:null,scale:void 0,num_ticks:null,tick_values:[],offset:{},label_location:"middle",label_color:null,grid_color:null,color:null,label_offset:null,visible:!0,tick_style:{},tick_rotate:0})}initialize(e,t){super.initialize(e,t),this.on("change:side",this.validate_orientation,this),this.on("change:orientation",this.validate_side,this),this.validate_orientation(),this.validate_side()}validate_side(){const e=this.get("orientation"),t=this.get("side");"vertical"===e?"left"!==t&&"right"!==t&&this.set("side","left"):"bottom"!==t&&"top"!==t&&this.set("side","bottom"),this.save_changes()}validate_orientation(){const e=this.get("side");e&&("left"===e||"right"===e?this.set("orientation","vertical"):this.set("orientation","horizontal"),this.save_changes())}}t.AxisModel=d,d.serializers=Object.assign(Object.assign({},n.WidgetModel.serializers),{scale:{deserialize:n.unpack_models},offset:{deserialize:n.unpack_models},tick_values:l.array_or_json}),t.ColorAxisModel=class extends d{defaults(){return Object.assign(Object.assign({},d.prototype.defaults()),{_model_name:"ColorAxisModel",_view_name:"ColorAxis"})}}},1871:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Bars=void 0;const n=r(s(8944));s(2802);const l=function(){return s(8556).B}.bind(this),o=r(s(8731)),d=s(3332);class c extends d.Mark{render(){const e=super.render.apply(this);return this.set_internal_scales(),this.selected_indices=this.model.get("selected"),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.display_el_classes=["bar","legendtext"],this.displayed.then((()=>{this.parent.tooltip_div.node().appendChild(this.tooltip_div.node()),this.create_tooltip()})),e.then((()=>{this.event_listeners={},this.process_interactions(),this.create_listeners(),this.compute_view_padding(),this.draw(!1)}))}set_scale_orientation(){this.dom_scale=this.scales.x,this.range_scale=this.scales.y}set_ranges(){const e=this.model.get("orientation");this.set_scale_orientation();const t=this.dom_scale,s=this.range_scale,i="vertical"===e?"x":"y",a="vertical"===e?"y":"x";"ordinal"!==t.model.type?t.set_range(this.parent.padded_range(i,t.model)):t.set_range(this.parent.padded_range(i,t.model),this.model.get("padding")),s.set_range(this.parent.padded_range(a,s.model)),this.dom_offset=0,this.range_offset="vertical"===e?s.offset:-s.offset}set_positional_scales(){const e=this.scales.x,t=this.scales.y;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.draw(!0)})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw(!0)}))}set_internal_scales(){this.stacked_scale=n.scaleBand(),this.grouped_scale=n.scaleBand()}adjust_offset(){"ordinal"!==this.dom_scale.model.type?"center"===this.model.get("align")?this.dom_offset=-(this.stacked_scale.bandwidth()/2).toFixed(2):"left"===this.model.get("align")?this.dom_offset=-this.stacked_scale.bandwidth().toFixed(2):this.dom_offset=0:"center"===this.model.get("align")?this.dom_offset=0:"left"===this.model.get("align")?this.dom_offset=-this.stacked_scale.bandwidth()/2:this.dom_offset=this.stacked_scale.bandwidth()/2}create_listeners(){super.create_listeners.apply(this),this.d3el.on("mouseover",(()=>{this.event_dispatcher("mouse_over")})).on("mousemove",(()=>{this.event_dispatcher("mouse_move")})).on("mouseout",(()=>{this.event_dispatcher("mouse_out")})),this.listenTo(this.model,"data_updated",(()=>{this.draw(!0)})),this.listenTo(this.model,"change:colors",this.update_colors),this.listenTo(this.model,"change:opacities",this.update_colors),this.listenTo(this.model,"colors_updated",this.update_colors),this.listenTo(this.model,"change:type",this.update_type),this.listenTo(this.model,"change:align",this.relayout),this.listenTo(this.model,"change:padding",this.relayout),this.listenTo(this.model,"change:orientation",this.relayout),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.model.on_some_change(["stroke","fill","stroke_width"],this.apply_styles,this),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",(()=>{this.event_dispatcher("parent_clicked")})),this.model.on_some_change(["label_display_format","label_font_style","label_display","label_display_vertical_offset","label_display_horizontal_offset"],this.draw,this)}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.bar_click_handler)}draw_zero_line(){this.set_scale_orientation();const e=this.range_scale;"vertical"===this.model.get("orientation")?this.d3el.select(".zeroLine").attr("x1",0).attr("x2",this.parent.plotarea_width).attr("y1",e.scale(this.model.base_value)).attr("y2",e.scale(this.model.base_value)):this.d3el.select(".zeroLine").attr("x1",e.scale(this.model.base_value)).attr("x2",e.scale(this.model.base_value)).attr("y1",0).attr("y2",this.parent.plotarea_height)}update_internal_scales(){this.stacked_scale.rangeRound(this.set_x_range());const e=this.model.get("padding");this.stacked_scale.paddingInner(e),this.stacked_scale.paddingOuter(e/2),this.adjust_offset(),this.grouped_scale.rangeRound([0,this.stacked_scale.bandwidth().toFixed(2)])}relayout(){this.set_ranges(),this.compute_view_padding(),this.draw_zero_line(),this.update_internal_scales(),this.draw_bars()}invert_point(e){if(void 0===e)return this.model.set("selected",null),void this.touch();const t=this.x_pixels.map((t=>Math.abs(t-e)));this.model.set("selected",new Uint32Array([t.indexOf(n.min(t))])),this.touch()}selector_changed(e,t){if(void 0===e)return this.model.set("selected",null),this.touch(),[];const s=this.pixel_coords,i=new Uint32Array(o.range(s.length)).filter((e=>{let i=s[e];for(let e=0;e<i.length;e++)if(t(i[e]))return!0;return!1}));this.model.set("selected",i),this.touch()}update_selected(e,t){this.selected_indices=t,this.apply_styles()}draw(e){this.set_ranges();const t=this;let s=this.d3el.selectAll(".bargroup").data(this.model.mark_data,(e=>e.key));const i=this.dom_scale;if("ordinal"!==i.model.type){const e=this.model.mark_data.map((e=>e.key));this.stacked_scale.domain(e)}else this.stacked_scale.domain(i.scale.domain());this.update_internal_scales(),this.model.mark_data.length>0&&this.grouped_scale.domain(o.range(this.model.mark_data[0].values.length)).rangeRound([0,this.stacked_scale.bandwidth().toFixed(2)]),s.exit().remove(),s=s.enter().append("g").attr("class","bargroup").merge(s),s.order(),s.on("click",(function(e,s){return t.event_dispatcher("element_clicked",{data:e,index:s})}));const a=s.selectAll(".bar").data((e=>e.values));if(a.enter().append("rect").attr("class","bar").attr("width",0).attr("height",0),a.exit().remove(),this.model.get("label_display")||s.selectAll("text").remove(),this.model.get("label_display")){const e=s.selectAll(".bar_label").data((e=>e.values));e.exit().remove(),e.enter().append("text").attr("class","bar_label").attr("width",0).attr("height",0)}this.draw_bars(e),this.apply_styles(),this.d3el.selectAll(".zeroLine").remove(),this.d3el.append("g").append("line").attr("class","zeroLine"),this.draw_zero_line()}draw_bars(e){const t=this.d3el.selectAll(".bargroup"),s=t.selectAll(".bar"),i=!0===e?this.parent.model.get("animation_duration"):0,a=this,r=this.model.get("orientation"),l=this.dom_scale,o=this.range_scale,d="vertical"===r?"x":"y",c="vertical"===r?"y":"x",h="vertical"===r?"width":"height",_="vertical"===r?"height":"width";if("ordinal"===l.model.type){const e=n.max(this.parent.range(d));t.attr("transform",(function(t){return"vertical"===r?"translate("+((void 0!==l.scale(t.key)?l.scale(t.key):e)+a.dom_offset)+", 0)":"translate(0, "+((void 0!==l.scale(t.key)?l.scale(t.key):e)+a.dom_offset)+")"}))}else t.attr("transform",(function(e){return"vertical"===r?"translate("+(l.scale(e.key)+a.dom_offset)+", 0)":"translate(0, "+(l.scale(e.key)+a.dom_offset)+")"}));const u="stacked"===this.model.get("type");let g=1;u?(g=Math.max(1,this.stacked_scale.bandwidth()),s.transition().duration(i).attr(d,0).attr(h,g.toFixed(2)).attr(c,(function(e){return"y"===c?o.scale(e.y1):o.scale(e.y0)})).attr(_,(function(e){return Math.abs(o.scale(e.y1+e.y_ref)-o.scale(e.y1))}))):(g=Math.max(1,this.grouped_scale.bandwidth()),s.transition().duration(i).attr(d,(function(e,t){return a.grouped_scale(t)})).attr(h,g.toFixed(2)).attr(c,(function(e){return n.min([o.scale(e.y),o.scale(a.model.base_value)])})).attr(_,(function(e){return Math.abs(o.scale(a.model.base_value)-o.scale(e.y))}))),this.manageBarLabels(t,g,d,c),this.pixel_coords=this.model.mark_data.map((e=>{const t=e.key,s=l.scale(t)+this.dom_offset;return e.values.map((e=>{const t={};return t[d]=u?s:s+this.grouped_scale(e.sub_index),t[c]=u?"y"===c?o.scale(e.y1):o.scale(e.y0):n.min([o.scale(e.y),o.scale(this.model.base_value)]),t[h]=g,t[_]=u?Math.abs(o.scale(e.y1+e.y_ref)-o.scale(e.y1)):Math.abs(o.scale(this.model.base_value)-o.scale(e.y_ref)),[[t.x,t.x+t.width],[t.y,t.y+t.height]]}))})),this.x_pixels=this.model.mark_data.map((e=>l.scale(e.key)+l.offset))}get offsetVertical(){return this.model.get("label_display_vertical_offset")}get offsetHorizontal(){return this.model.get("label_display_horizontal_offset")}get baseLine(){return this.model.get("base")}get barOrientation(){return this.model.get("orientation")}manageBarLabels(e,t,s,i){this.model.get("label_display")&&("stacked"===this.model.get("type")?this.stackedBarLabels(e,t,s,i):this.groupedBarLabels(e,t),this.updateBarLabelsStyle())}stackedBarLabels(e,t,s,i){const a=this.baseLine,r=this.barOrientation;e.selectAll(".bar_label").attr(s,(e=>0)).attr(i,(e=>e.y<=a?this.range_scale.scale(e.y0):this.range_scale.scale(e.y1))).style("font-weight","400").style("text-anchor",((e,t)=>this.styleBarLabelTextAnchor(e,r,a))).style("dominant-baseline",((e,t)=>this.styleBarLabelDominantBaseline(e,a,r))).attr("transform",((e,s)=>this.transformBarLabel(e,a,this.offsetHorizontal,this.offsetVertical,t,r)))}groupedBarLabels(e,t){const s=this.baseLine,i=this.barOrientation;e.selectAll(".bar_label").attr("x",((e,t)=>"horizontal"===i?this.range_scale.scale(e.y):this.grouped_scale(t))).attr("y",((e,t)=>"horizontal"===i?this.grouped_scale(t):this.range_scale.scale(e.y))).style("font-weight","400").style("text-anchor",((e,t)=>this.styleBarLabelTextAnchor(e,i,s))).style("dominant-baseline",((e,t)=>this.styleBarLabelDominantBaseline(e,s,i))).attr("transform",((e,a)=>this.transformBarLabel(e,s,this.offsetHorizontal,this.offsetVertical,t,i)))}transformBarLabel(e,t,s,i,a,r){return"horizontal"===r?e.y<=t?`translate(${e.y0<=t?0-i:0+i}, ${a/2+s})`:`translate(${e.y1<=t?0-i:0+i}, ${a/2+s})`:e.y<=t?`translate(${a/2+s},\n                ${e.y0<=t?0-i:0+i})`:`translate(${a/2+s},\n                ${e.y1<=t?0-i:0+i})`}styleBarLabelTextAnchor(e,t,s){return"horizontal"===t?e.y<=s?"start":"end":"middle"}styleBarLabelDominantBaseline(e,t,s){return"horizontal"===s?"central":e.y<=t?"text-after-edge":"text-before-edge"}updateBarLabelsStyle(){const e=this.model.get("label_display_format"),t=e?n.format(e):null;let s=this.d3el.selectAll(".bar_label").text(((e,s)=>t?t(e.y):null));const i=this.model.get("label_font_style");for(const e in i)s=s.style(e,i[e])}update_type(e,t){this.model.update_domains(),this.draw()}update_colors(){const e=this.model.get("stroke");this.model.mark_data.length>0&&(this.model.is_y_2d?this.d3el.selectAll(".bargroup").selectAll(".bar").style("fill",this.get_mark_color.bind(this)).style("stroke",e||this.get_mark_color.bind(this)).style("opacity",this.get_mark_opacity.bind(this)):this.d3el.selectAll(".bar").style("fill",this.get_mark_color.bind(this)).style("stroke",e||this.get_mark_color.bind(this)).style("opacity",this.get_mark_opacity.bind(this))),this.legend_el&&(this.legend_el.selectAll(".legendrect").style("fill",this.get_mark_color.bind(this)).style("stroke",e||this.get_mark_color.bind(this)).style("opacity",this.get_mark_opacity.bind(this)),this.legend_el.selectAll(".legendtext").style("fill",this.get_mark_color.bind(this)).style("stroke",e||this.get_mark_color.bind(this)).style("opacity",this.get_mark_opacity.bind(this)))}draw_legend(e,t,s,i,a){if(!this.model.is_y_2d&&1!==this.model.get("colors").length&&"element"!==this.model.get("color_mode"))return[0,0];const r=this.model.mark_data[0].values.map((e=>({index:e.sub_index,color_index:e.color_index,opacity_index:e.opacity_index})));this.legend_el=e.selectAll(".legend"+this.uuid).data(r);const l=this,o=.8*a,d=this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",((e,t)=>"translate(0, "+(t*a+s)+")")).on("mouseover",(()=>{this.event_dispatcher("legend_mouse_over")})).on("mouseout",(()=>{this.event_dispatcher("legend_mouse_out")})).on("click",(()=>{this.event_dispatcher("legend_clicked")}));d.append("rect").classed("legendrect",!0).style("fill",this.get_mark_color.bind(this)).attr("x",0).attr("y",0).attr("width",o).attr("height",o),d.append("text").attr("class","legendtext").attr("x",1.2*o).attr("y",o/2).attr("dy","0.35em").text(((e,t)=>l.model.get("labels")[t])).style("fill",this.get_mark_color.bind(this)),this.legend_el=d.merge(this.legend_el);const c=n.max(this.model.get("labels"),(e=>e.length));return this.legend_el.exit().remove(),[this.model.mark_data[0].values.length,c]}clear_style(e,t){if(!t||0===t.length)return;if(0===Object.keys(e).length)return;const s=this.d3el.selectAll(".bargroup").filter(((e,s)=>-1!==t.indexOf(s))),i={};for(const t in e)i[t]=null;s.selectAll(".bar").styles(i)}set_style_on_elements(e,t){t&&0!==t.length&&0!==Object.keys(e).length&&this.d3el.selectAll(".bargroup").filter(((e,s)=>-1!==t.indexOf(s))).selectAll(".bar").styles(e)}set_default_style(e){if(!e||0===e.length)return;const t=this.model.get("fill"),s=this.model.get("stroke"),i=this.model.get("stroke_width");this.d3el.selectAll(".bargroup").filter(((t,s)=>-1!==e.indexOf(s))).selectAll(".bar").style("fill",t?this.get_mark_color.bind(this):"none").style("stroke",s||"none").style("opacity",this.get_mark_opacity.bind(this)).style("stroke-width",i)}get_mark_color(e,t){return super.get_mark_color(e,e.color_index)}get_mark_opacity(e,t){return super.get_mark_opacity(e,e.opacity_index)}set_x_range(){const e=this.dom_scale;return"ordinal"===e.model.type?e.scale.range():[e.scale(n.min(this.stacked_scale.domain())),e.scale(n.max(this.stacked_scale.domain()))]}bar_click_handler(e){const t=e.index,s=this,i=this.model.get("selected")||[];let a=Array.from(i);const r=a.indexOf(t),d=l().ctrlKey||l().metaKey;if(r>-1&&d)a.splice(r,1);else if(l().shiftKey){if(r>-1)return;const e=0!==a.length?n.min(a):-1,i=0!==a.length?n.max(a):s.model.mark_data.length;t>i?o.range(i+1,t+1).forEach((e=>{a.push(e)})):t<e&&o.range(t,e).forEach((e=>{a.push(e)}))}else d||(a=[]),a.push(t);this.model.set("selected",0===a.length?null:new Uint32Array(a),{updated_view:this}),this.touch();const c=l();void 0!==c.cancelBubble&&(c.cancelBubble=!0),c.stopPropagation&&c.stopPropagation(),c.preventDefault()}reset_selection(){this.model.set("selected",null),this.selected_indices=null,this.touch()}compute_view_padding(){const e=this.dom_scale,t=this.model.get("orientation");let s=0;const i="vertical"===t?this.parent.plotarea_width:this.parent.plotarea_height;e&&null!==this.stacked_scale&&void 0!==this.stacked_scale&&0!==this.stacked_scale.domain().length&&("ordinal"!==e.model.type?"center"===this.model.get("align")?s=i/(2*this.stacked_scale.domain().length)+1:"left"!==this.model.get("align")&&"right"!==this.model.get("align")||(s=i/this.stacked_scale.domain().length+1):"left"!==this.model.get("align")&&"right"!==this.model.get("align")||(s=parseFloat((this.stacked_scale.bandwidth()/2).toFixed(2)))),"vertical"===t?s!==this.x_padding&&(this.x_padding=s,this.trigger("mark_padding_updated")):s!==this.y_padding&&(this.y_padding=s,this.trigger("mark_padding_updated"))}}t.Bars=c},8276:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.BarsModel=void 0;const n=r(s(8944)),l=r(s(8731)),o=r(s(9250)),d=r(s(1961));class c extends o.MarkModel{defaults(){return Object.assign(Object.assign({},o.MarkModel.prototype.defaults()),{_model_name:"BarsModel",_view_name:"Bars",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},color_mode:"auto",opacity_mode:"auto",type:"stacked",colors:["steelblue"],padding:.05,fill:!0,stroke:null,stroke_width:1,base:0,opacities:[],orientation:"vertical",align:"center",label_display:!1,label_display_format:".2f",label_display_font_style:{},label_display_horizontal_offset:0,label_display_vertical_offset:0})}initialize(e,t){super.initialize(e,t),this.is_y_2d=!1,this.on_some_change(["x","y","base"],this.update_data,this),this.on_some_change(["color","opacities","color_mode","opacity_mode"],(function(){this.update_color(),this.trigger("colors_updated")}),this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_color(),this.update_domains()}update_data(){let e=this.get("x"),t=this.get("y");t=0!==t.length&&l.isNumber(t[0])?[t]:t,this.base_value=this.get("base"),void 0!==this.base_value&&null!==this.base_value||(this.base_value=0),0===e.length||0===t.length?(this.mark_data=[],this.is_y_2d=!1):(e=e.slice(0,n.min(t.map((e=>e.length)))),this.mark_data=Array.prototype.map.call(e,((e,s)=>{const i={};let a=this.base_value,r=this.base_value,n=this.base_value;return i.key=e,i.values=Array.prototype.map.call(t,((t,i)=>{let l=t[s]-this.base_value;isNaN(l)&&(l=0);const o=l>=0;return{index:s,sub_index:i,x:e,y0:o?a:(n+=l,n),y1:o?a+=l:(r+=l,r-l),y_ref:l,y:t[s]}})),i.pos_max=a,i.neg_max=r,i})),this.is_y_2d=this.mark_data[0].values.length>1,this.update_color()),this.update_domains(),this.trigger("data_updated")}get_data_dict(e,t){return e}update_color(){if(!this.mark_data)return;const e=this.get("color")||[],t=this.get("scales").color,s=this.get("color_mode"),i="group"===s||"auto"===s&&!this.is_y_2d,a="element"===s||"auto"===s&&this.is_y_2d,r=this.get("opacity_mode"),n="group"===r||"auto"===r&&!this.is_y_2d,l="element"===r||"auto"===r&&this.is_y_2d;let o=0;this.mark_data.forEach((function(t,s){t.values.forEach((function(t,r){t.color_index=i?s:a?r:o,t.opacity_index=n?s:l?r:o,t.color=e[t.color_index],o++}))})),t&&e.length>0&&(this.get("preserve_domain").color?t.del_domain([],this.model_id+"_color"):t.compute_and_set_domain(e,this.model_id+"_color"))}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.x,s=e.y;if(this.get("preserve_domain").x?t.del_domain([],this.model_id+"_x"):t.compute_and_set_domain(this.mark_data.map((function(e){return e.key})),this.model_id+"_x"),this.get("preserve_domain").y)s.del_domain([],this.model_id+"_y");else if("stacked"===this.get("type"))s.compute_and_set_domain([n.min(this.mark_data,(function(e){return e.neg_max})),n.max(this.mark_data,(function(e){return e.pos_max})),this.base_value],this.model_id+"_y");else{const e=n.min(this.mark_data,(function(e){return n.min(e.values,(function(e){return e.y_ref}))})),t=n.max(this.mark_data,(function(e){return n.max(e.values,(function(e){return e.y_ref}))}));s.compute_and_set_domain([e,t,this.base_value],this.model_id+"_y")}}}t.BarsModel=c,c.serializers=Object.assign(Object.assign({},o.MarkModel.serializers),{x:d.array_or_json,y:d.array_or_json,color:d.array_or_json})},9101:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Boxplot=void 0;const n=r(s(8944));s(2802);const l=function(){return s(8556).B}.bind(this),o=r(s(8731)),d=s(3332);class c extends d.Mark{render(){const e=super.render.apply(this),t=this;return this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),e.then((function(){t.event_listeners={},t.create_listeners(),t.process_interactions(),t.draw()}),null)}set_ranges(){const e=this.scales.x;e&&e.set_range(this.parent.padded_range("x",e.model));const t=this.scales.y;t&&t.set_range(this.parent.padded_range("y",t.model))}set_positional_scales(){const e=this.scales.x;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.draw()}));const t=this.scales.y;this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw()}))}create_listeners(){super.create_listeners.apply(this),this.listenTo(this.model,"change:stroke",this.update_stroke),this.listenTo(this.model,"change:opacities",this.update_opacities),this.listenTo(this.model,"change:marker",this.update_marker),this.listenTo(this.model,"change:outlier_fill_color",this.update_outlier_fill_color),this.listenTo(this.model,"change:box_fill_color",this.update_box_fill_color),this.listenTo(this.model,"data_updated",this.draw),this.listenTo(this.model,"change:box_width",this.update_box_width),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")}))}update_stroke(){const e=this.model.get("stroke");this.d3el.selectAll(".boxplot").selectAll("path, rect").style("stroke",e),this.d3el.selectAll(".outlier").style("stroke",e),this.legend_el&&(this.legend_el.selectAll("path").attr("stroke",e),this.legend_el.selectAll("text").style("fill",e))}update_outlier_fill_color(){this.d3el.selectAll(".outlier").style("fill",this.model.get("outlier_fill_color"))}update_box_fill_color(){this.d3el.selectAll(".box").style("fill",this.model.get("box_fill_color"))}update_opacities(){const e=this.model.get("opacities");this.d3el.selectAll(".boxplot").style("opacity",(function(t,s){return e[s]})),this.legend_el&&this.legend_el.selectAll("path").attr("opacity",(function(t,s){return e[s]}))}update_marker(){const e=this.model.get("marker");this.legend_el&&this.rect_dim&&this.draw_mark_paths(e,this.rect_dim/2),this.draw_mark_paths(e,this.calculate_mark_max_width())}get_box_width(){let e=this.model.get("box_width");if(!e){const t=this.parent.plotarea_width,s=t/10;e=t/(this.model.mark_data.length+1)/1.5,e=Math.min(e,s)}return e}compute_view_padding(){const e=this.get_box_width()/2+1;e!==this.x_padding&&(this.x_padding=e,this.trigger("mark_padding_updated"))}update_box_width(){this.compute_view_padding(),this.draw()}update_idx_selected(e,t){this.selected_indices=t,this.apply_styles(t)}set_style_on_elements(e,t){if(void 0===t||0===t.length)return;let s=this.d3el.selectAll(".box");s=s.filter((function(e,s){return-1!=t.indexOf(s)})),s.styles(e)}set_default_style(e){this.update_outlier_fill_color(),this.update_box_fill_color(),this.update_stroke(),this.update_opacities()}clear_style(e,t){let s=this.d3el.selectAll(".boxplot");void 0!==t&&(s=s.filter((function(e,s){return-1!=t.indexOf(s)})));const i={};for(let t in e)i[t]=null;s.styles(i)}style_updated(e,t){this.set_default_style(t),this.set_style_on_elements(e,t)}selected_style_updated(e,t){this.selected_style=t,this.style_updated(t,this.selected_indices)}unselected_style_updated(e,t){this.unselected_style=t;const s=this.selected_indices,i=s?o.range(this.model.mark_data.length).filter((function(e){return-1==s.indexOf(e)})):[];this.style_updated(t,i)}update_selected_colors(e){const t=this.model.get("stroke"),s=t;this.d3el.selectAll(".boxplot").style("stroke",(function(i,a){return e.indexOf(a)>-1?s:t}))}selector_changed(e,t){if(void 0===e)return this.model.set("selected",null),this.touch(),this.update_selected_colors([]),[];const s=this.pixel_coords,i=new Uint32Array(o.range(s.length)).filter((e=>t(s[e])));this.update_selected_colors(i),this.model.set("selected",i),this.touch()}invert_point(e){if(void 0===e)return this.update_selected_colors([]),this.model.set("selected",null),void this.touch();const t=this.x_pixels.map((function(t){return Math.abs(t-e)})),s=t.indexOf(n.min(t));return this.model.set("selected",new Uint32Array([s])),this.update_selected_colors([s]),this.touch(),s}prepareBoxPlots(){const e=!1!==this.model.get("auto_detect_outliers"),t=this.scales.x,s=this.scales.y;this.plotData=[],this.outlierData=[];for(let i=0;i<this.model.mark_data.length;++i){const a=this.model.mark_data[i],r={};r.x=t.scale(a[0]),r.boxUpper=s.scale(n.quantile(a[1],.75)),r.boxLower=s.scale(n.quantile(a[1],.25)),r.boxMedian=s.scale(n.quantile(a[1],.5));const l=r.boxLower-r.boxUpper,o=r.boxLower+1.5*l,d=r.boxUpper-1.5*l;r.whiskerMax=Number.MAX_VALUE,r.whiskerMin=Number.MIN_VALUE;for(let i=0;i<a[1].length;++i){const n=s.scale(a[1][i]);e&&(n>o||n<d)?this.outlierData.push({x:t.scale(a[0]),y:n}):(n>r.whiskerMin&&(r.whiskerMin=n),n<r.whiskerMax&&(r.whiskerMax=n))}this.plotData.push(r)}}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.box_click_handler)}box_click_handler(e){const t=e.index,s=this,i=this.model.get("selected")||[];let a=Array.from(i);const r=a.indexOf(t),d=l().ctrlKey||l().metaKey;if(r>-1&&d)a.splice(r,1);else if(l().shiftKey){if(r>-1)return;const e=0!==a.length?n.min(a):-1,i=0!==a.length?n.max(a):s.model.mark_data.length;t>i?o.range(i+1,t+1).forEach((function(e){a.push(e)})):t<e&&o.range(t,e).forEach((function(e){a.push(e)}))}else d||(a=[]),a.push(t);this.model.set("selected",0===a.length?null:new Uint32Array(a),{updated_view:this}),this.touch();const c=l();void 0!==c.cancelBubble&&(c.cancelBubble=!0),c.stopPropagation&&c.stopPropagation(),c.preventDefault()}reset_selection(){this.model.set("selected",null),this.selected_indices=null,this.touch()}update_selected(e,t){this.selected_indices=t,this.apply_styles()}draw(){this.set_ranges();const e=this.scales.x;this.prepareBoxPlots(),this.draw_mark_paths(".boxplot",this.d3el),this.x_pixels=this.model.mark_data.map((function(t){return e.scale(t[0])+e.offset}));const t=this.get_box_width()/2;this.pixel_coords=this.plotData.map((function(e){return[[e.x-t,e.x+t],[e.boxLower,e.boxUpper]]}))}draw_mark_paths(e,t){const s=this,i=this.plotData,a=this.outlierData,r=this.model.get("color"),n=this.d3el.selectAll(e).data(i),l=this.model.get("box_fill_color"),o=n.enter().append("g").attr("class","boxplot").attr("id",(function(e,t){return"boxplot"+t}));o.append("path").attr("class","whisker_max"),o.append("path").attr("class","whisker_max_end"),o.append("path").attr("class","whisker_min"),o.append("path").attr("class","whisker_min_end"),o.append("rect").attr("class","box"),o.append("path").attr("class","median_line"),o.append("g").attr("class","outliers");const d=this.scales.x,c="ordinal"===d.model.type?d.scale.bandwidth()/2:0;t.selectAll(".boxplot").data(i).style("stroke",this.model.get("stroke")).style("opacity",r).attr("transform",(function(e,t){return"translate("+(e.x+c)+", 0)"}));const h=this.get_box_width();t.selectAll(".box").data(i).style("fill",l).attr("x",-h/2).attr("width",h).attr("y",(function(e,t){return e.boxUpper})).attr("height",(function(e,t){return e.boxLower-e.boxUpper})).on("click",(function(e,t){return s.event_dispatcher("element_clicked",{data:e,index:t})})),t.selectAll(".median_line").data(i).style("stroke-width",2).attr("d",(function(e,t){const s=e.boxMedian;return"M"+(0-h/2)+","+s+" L"+(0+h/2)+","+s})),t.selectAll(".whisker_max").data(i).attr("d",(function(e,t){return"M0,"+e.whiskerMax+" L0,"+e.boxUpper})).attr("stroke-dasharray",(function(e,t){return"5,5"})),t.selectAll(".whisker_max_end").data(i).attr("d",(function(e,t){const s=e.whiskerMax;return"M"+(0-h/2)+","+s+" L"+(0+h/2)+","+s})),t.selectAll(".whisker_min").data(i).attr("d",(function(e,t){return"M0,"+e.whiskerMin+" L0,"+e.boxLower})).attr("stroke-dasharray",(function(e,t){return"5,5"})),t.selectAll(".whisker_min_end").data(i).attr("d",(function(e,t){const s=e.whiskerMin;return"M"+(0-h/2)+","+s+" L"+(0+h/2)+","+s})),n.exit().remove();const _=t.selectAll(".outlier").data(a);_.enter().append("circle").attr("class","outlier"),_.exit().remove(),t.selectAll(".outlier").data(a).style("fill",this.model.get("outlier_fill_color")).attr("cx",(function(e){return e.x+c})).attr("r",3).attr("cy",(function(e){return e.y})),this.apply_styles(this.selected_indices)}calculate_mark_max_width(){const e=this,t=this.scales.x;let s=1/0;for(let i=1;i<e.model.mark_data.length;i++){let a=t.scale(e.model.mark_data[i][0])-t.scale(e.model.mark_data[i-1][0]);a=a<0?-1*a:a,a<s&&(s=a)}let i=0;return i=s==1/0?(t.scale(this.model.max_x)-t.scale(this.model.min_x))/2:s,i}relayout(){this.set_ranges(),this.compute_view_padding(),this.d3el.select(".intselmouse").attr("width",this.width).attr("height",this.height),this.draw()}draw_legend(e,t,s,i,a){const r=this.model.get("stroke");this.rect_dim=.8*a;const l=this;this.legend_el=e.selectAll(".legend"+this.uuid).data([this.model.mark_data]);const d=this.legend_el.enter().append("g").attr("transform",(function(e,t){return"translate(0, "+(t*a+s)+")"})).attr("class","legend"+this.uuid).on("mouseover",o.bind(this.highlight_axes,this)).on("mouseout",o.bind(this.unhighlight_axes,this));d.selectAll("path").attr("stroke",r).attr("transform","translate("+l.rect_dim/2+",0)"),this.legend_el.append("text").attr("class","legendtext").attr("x",1.2*l.rect_dim).attr("y",l.rect_dim/2).attr("dy","0.35em").text((function(e,t){return l.model.get("labels")[t]})).style("fill",r),this.legend_el=d.merge(this.legend_el);const c=n.max(this.model.get("labels"),(function(e){return e.length}));return this.legend_el.exit().remove(),[1,c]}}t.Boxplot=c},5935:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.BoxplotModel=void 0;const n=r(s(8944)),l=r(s(8731)),o=s(9250),d=r(s(1961));class c extends o.MarkModel{defaults(){return Object.assign(Object.assign({},o.MarkModel.prototype.defaults()),{_model_name:"BoxplotModel",_view_name:"Boxplot",x:[],y:[],scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"}},stroke:null,box_fill_color:"dodgerblue",outlier_fill_color:"gray",opacities:[],box_width:null,auto_detect_outliers:!0})}initialize(){super.initialize.apply(this,arguments),this.on_some_change(["x","y"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()}update_data(){let e=this.get("x"),t=this.get("y");t.forEach((function(e){e.sort((function(e,t){return e-t}))})),e.length>t.length?e=e.slice(0,t.length):e.length<t.length&&(t=t.slice(0,e.length)),this.mark_data=l.zip(e,t),this.update_domains(),this.trigger("data_updated")}update_domains(){const e=this.get("scales"),t=e.x,s=e.y;if(!this.get("preserve_domain").x&&this.mark_data?t.compute_and_set_domain(this.mark_data.map((function(e){return e[0]})),this.model_id+"_x"):t.del_domain([],this.model_id+"_x"),!this.get("preserve_domain").y&&this.mark_data){const e=n.min(this.mark_data.map((function(e){return e[1][0]}))),t=n.max(this.mark_data.map((function(e){const t=e[1];return t[t.length-1]})));s.set_domain([e,t],this.model_id+"_y")}else s.del_domain([],this.model_id+"_y")}}t.BoxplotModel=c,c.serializers=Object.assign(Object.assign({},o.MarkModel.serializers),{x:d.array_or_json,y:d.array_or_json})},6401:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MultiSelector=t.BrushIntervalSelector=t.BrushSelector=void 0;const n=r(s(8944)),l=function(){return s(8556).B}.bind(this),o=r(s(8731)),d=r(s(3248)),c=r(s(6988)),h=r(s(8882));function _(e,t){return e-t}function u(e,t,s){if(void 0===t||0===t.length)return void o.each(e.mark_views,(e=>e.selector_changed()));let i,a;if(void 0===s){const s=e.model.get("orientation");i="vertical"==s?[]:t,a="vertical"==s?t:[]}else i=t,a=s;i.length&&i.sort(_),a.length&&a.sort(_),o.each(e.mark_views,(e=>{e.selector_changed(function(e,t){return function(s,i){if(void 0===i)return h.point_in_rectangle(s,e,t);const a=Math.min(s.length,i.length),r=new Uint8Array(a);if(e.length&&t.length){for(let n=0;n<a;n++)r[n]=e[0]<=s[n]&&s[n]<=e[1]&&t[0]<=i[n]&&i[n]<=t[1]?1:0;return r}if(e.length)for(let t=0;t<a;t++)r[t]=e[0]<=s[t]&&s[t]<=e[1]?1:0;else for(let e=0;e<a;e++)r[e]=t[0]<=i[e]&&i[e]<=t[1]?1:0;return r}}(i,a),function(e,t){return function(s){return h.rect_inter_rect(s[0],s[1],e,t)}}(i,a))}))}function g(e){"vertical"==e.model.get("orientation")?e.d3el.selectAll("rect").attr("x",0).attr("width",e.width):e.d3el.selectAll("rect").attr("y",0).attr("height",e.height)}class m extends d.BaseXYSelector{constructor(){super(...arguments),this.ignoreBrushEvents=!1}brush_render(){this.brushing=!1}color_change(){null!==this.model.get("color")&&this.d3el.selectAll(".selection").style("fill",this.model.get("color"))}brush_start(){this.ignoreBrushEvents||(this.brushing=!0,this.model.set("brushing",!0),this.touch())}brush_move(){this.ignoreBrushEvents||this.convert_and_save()}brush_end(){this.ignoreBrushEvents||(this.model.set("brushing",!1),this.convert_and_save(),this.brushing=!1)}adjust_rectangle(){g(this)}update_mark_selected(e,t){return u(this,e,t)}}class p extends d.BaseXSelector{constructor(){super(...arguments),this.ignoreBrushEvents=!1}brush_render(){this.brushing=!1}color_change(){null!==this.model.get("color")&&this.d3el.selectAll(".selection").style("fill",this.model.get("color"))}brush_start(){this.ignoreBrushEvents||(this.brushing=!0,this.model.set("brushing",!0),this.touch())}brush_move(){this.ignoreBrushEvents||this.convert_and_save()}brush_end(){this.ignoreBrushEvents||(this.model.set("brushing",!1),this.convert_and_save(),this.brushing=!1)}adjust_rectangle(){g(this)}update_mark_selected(e,t){return u(this,e,t)}}function f(e,t,s){s&&s.forEach((function(t){e.classed(t,!1)})),t&&t.forEach((function(t){e.classed(t,!0)}))}t.BrushSelector=class extends m{async render(){await super.render(),this.brush_render(),await this.create_scales(),await this.mark_views_promise,this.brush=n.brush().on("start",o.bind(this.brush_start,this)).on("brush",o.bind(this.brush_move,this)).on("end",o.bind(this.brush_end,this)),this.brush.extent([[0,0],[this.width,this.height]]),this.d3el.attr("class","selector brushintsel"),this.d3el.call(this.brush),this.adjust_rectangle(),this.color_change(),this.create_listeners(),this.selected_changed()}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:color",this.color_change),this.listenTo(this.model,"change:selected_x",this.selected_changed),this.listenTo(this.model,"change:selected_y",this.selected_changed)}empty_selection(){this.update_mark_selected(),this.model.set("selected_x",null),this.model.set("selected_y",null),this.touch()}convert_and_save(){const e=l();if(e.sourceEvent)if(e.selection){const i=e.selection;var t=[i[0][0],i[1][0]],s=[i[1][1],i[0][1]];const a=t.map(this.x_scale.invert.bind(this.x_scale)).sort(_),r=s.map(this.y_scale.invert.bind(this.y_scale)).sort(_);this.update_mark_selected(t,s),this.set_selected("selected_x",this.x_scale.model.typedRange(a)),this.set_selected("selected_y",this.y_scale.model.typedRange(r)),this.touch()}else this.empty_selection()}selected_changed(){if(this.brushing)return;const e=this.model.get("selected_x")||[],t=this.model.get("selected_y")||[];if(0===e.length||0===t.length)this.update_mark_selected();else{if(2!=e.length||2!=t.length)return;{const s=e.map((e=>this.x_scale.offset+this.x_scale.scale(e))).sort(_),i=t.map((e=>this.y_scale.offset+this.y_scale.scale(e))).sort(_);this.update_mark_selected(s,i)}}this.syncModelToBrush()}relayout(){super.relayout(),this.d3el.select(".background").attr("width",this.width).attr("height",this.height),this.set_x_range([this.x_scale]),this.set_y_range([this.y_scale]),this.brush.extent([[0,0],[this.width,this.height]]),this.syncModelToBrush()}syncModelToBrush(){this.ignoreBrushEvents=!0;try{if(this.model.get("selected_x")&&this.model.get("selected_y")){const e=this.model.get("selected_x").map((e=>this.x_scale.offset+this.x_scale.scale(e))).sort(_),t=this.model.get("selected_y").map((e=>this.y_scale.offset+this.y_scale.scale(e))).sort(_);this.brush.move(this.d3el,[[e[0],t[0]],[e[1],t[1]]])}else this.brush.move(this.d3el,null);this.d3el.call(this.brush)}finally{this.ignoreBrushEvents=!1}this.d3el.call(this.brush)}adjust_rectangle(){}reset(){}},t.BrushIntervalSelector=class extends p{async render(){await super.render(),this.brush_render(),await this.mark_views_promise,await this.create_scales(),this.brush=("vertical"==this.model.get("orientation")?n.brushY():n.brushX()).on("start",o.bind(this.brush_start,this)).on("brush",o.bind(this.brush_move,this)).on("end",o.bind(this.brush_end,this)),this.brush.extent([[0,0],[this.width,this.height]]),this.d3el.attr("class","selector brushintsel"),this.d3el.call(this.brush),this.adjust_rectangle(),this.color_change(),this.create_listeners(),this.selected_changed()}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:color",this.color_change),this.listenTo(this.model,"change:selected",this.selected_changed)}empty_selection(){this.update_mark_selected(),this.model.set("selected",null),this.touch()}convert_and_save(){const e=l();if(e.sourceEvent)if(e.selection){const t=e.selection,s=t.map(this.scale.invert.bind(this.scale)).sort(_);this.update_mark_selected(t),this.set_selected("selected",this.scale.model.typedRange(s)),this.touch()}else this.empty_selection()}update_scale_domain(e){super.update_scale_domain(),!0!==e&&this.selected_changed()}selected_changed(){if(this.brushing)return;const e=this.model.get("selected")||[];if(0===e.length)this.update_mark_selected();else{if(2!=e.length)return;{const t=[e[0],e[1]].map((e=>this.scale.scale(e))).sort(_);this.update_mark_selected(t)}}this.syncModelToBrush()}relayout(){super.relayout(),this.adjust_rectangle(),this.d3el.select(".background").attr("width",this.width).attr("height",this.height),this.set_range([this.scale]),this.brush.extent([[0,0],[this.width,this.height]]),this.syncModelToBrush()}syncModelToBrush(){this.ignoreBrushEvents=!0;try{if(this.model.get("selected")){const e=this.model.get("selected").map((e=>this.scale.scale(e))).sort(_);this.brush.move(this.d3el,e)}else this.brush.move(this.d3el,null);this.d3el.call(this.brush)}finally{this.ignoreBrushEvents=!1}}reset(){}},t.MultiSelector=class extends p{constructor(){super(...arguments),this.brushes=[],this.brush_g=[]}render(){super.render.apply(this),this.brush_render(),this.names=this.model.get("names"),this.curr_index=0;const e=this.create_scales();Promise.all([this.mark_views_promise,e]).then((()=>{this.d3el.attr("class","multiselector"),this.d3el.attr("width",this.width),this.d3el.attr("height",this.height),this.create_brush(),this.selecting_brush=!1,this.create_listeners()}))}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:names",this.labels_change),this.listenTo(this.model,"change:color",this.color_change)}labels_change(e,t){const s=e.previous("names");this.names=t;const i=o.range(this.curr_index+1),a=c.deepCopy(this.model.get("selected"));i.forEach((e=>{const t=this.get_label(e),i=this.get_label(e,s);i!==t&&(this.d3el.select(".brush_text_"+e).text(t),a[t]=a[i],delete a[i])})),this.set_selected("_selected",a),this.touch()}create_brush(){const e=this.curr_index,t=("vertical"==this.model.get("orientation")?n.brushY():n.brushX()).on("start",(()=>{this.brush_start()})).on("brush",(()=>{this.multi_brush_move(e)})).on("end",(()=>{this.multi_brush_end(e)}));t.extent([[0,0],[this.width,this.height]]);const s=this.d3el.append("g").attr("class","selector brushintsel active");s.append("text").text(this.get_label(this.curr_index)).attr("class","brush_text_"+this.curr_index).style("display","none"),"vertical"==this.model.get("orientation")?s.select("text").attr("x",30):s.select("text").attr("y",30),s.call(t),this.color_change(),this.adjust_rectangle(),this.reset_handler(s),this.brushes[this.curr_index]=t,this.brush_g[this.curr_index]=s,this.curr_index=this.curr_index+1}reset_handler(e){const t=this,s=e.on("mousedown.brush");e.on("mousedown.brush",(function(){const e=l().ctrlKey||l().metaKey;l().shiftKey&&e?t.reset():e?(f(n.select(this),["inactive"],["active"]),t.create_brush()):l().shiftKey&&!1===t.selecting_brush?(f(t.d3el.selectAll(".selector"),["visible"],["active","inactive"]),t.selecting_brush=!0):(f(t.d3el.selectAll(".selector"),["inactive"],["visible"]),f(n.select(this),["active"],["inactive"]),s.call(this),t.selecting_brush=!1)}))}get_label(e,t){return null==t&&(t=this.names),t.length>e?t[e]:e}multi_brush_move(e){if(this.ignoreBrushEvents)return;const t=l().selection;this.update_text(e,t),this.convert_and_save(t,e)}update_text(e,t){if(null===t)return void this.d3el.select(".brush_text_"+e).style("display","none");const s="vertical"==this.model.get("orientation")?"y":"x",i=!this.model.get("show_names"),a=(t[0]+t[1])/2;this.d3el.select(".brush_text_"+e).style("display",i?"none":"inline").attr(s,a)}multi_brush_end(e){if(this.ignoreBrushEvents)return;const t=l().selection;this.model.set("brushing",!1),this.convert_and_save(t,e),this.brushing=!1}reset(){this.d3el.selectAll(".selector").remove(),this.model.set("_selected",{}),this.curr_index=0,this.brushes=[],this.brush_g=[],this.touch(),this.create_brush()}convert_and_save(e,t){if(e){const s=c.deepCopy(this.model.get("_selected"));s[this.get_label(t)]=e.map(this.scale.invert.bind(this.scale)),this.update_mark_selected(e),this.model.set("_selected",s)}else this.update_mark_selected(),this.model.set("_selected",{});this.touch()}selected_changed(){}relayout(){super.relayout(),this.adjust_rectangle(),this.d3el.select(".background").attr("width",this.width).attr("height",this.height),this.set_range([this.scale]),this.brushes.forEach((e=>{e.extent([[0,0],[this.width,this.height]])})),this.syncModelToBrush()}syncModelToBrush(){this.ignoreBrushEvents=!0;try{const e=this.model.get("_selected");this.brushes.forEach(((t,s)=>{const i=e[this.get_label(s)];if(i){const e=i.map((e=>this.scale.scale(e))).sort(_);this.update_text(s,e),t.move(this.brush_g[s],e)}else this.update_text(s,null),t.move(this.brush_g[s],null);this.brush_g[s].call(t),this.reset_handler(this.brush_g[s])}))}finally{this.ignoreBrushEvents=!1}}remove(){this.model.off("change:names",null,this),this.model.off("change:color",null,this),super.remove()}}},1718:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ColorAxis=void 0;const n=r(s(8944)),l=s(7931);class o extends l.Axis{render(){this.parent=this.options.parent,this.vertical="vertical"===this.model.get("orientation");const e=this.set_scale(this.model.get("scale"));this.side=this.model.get("side"),this.x_offset=100,this.y_offset=40,this.bar_height=20,this.d3el.attr("class","ColorBar").attr("display",this.model.get("visible")?"inline":"none").attr("transform",this.get_topg_transform()),this.ordinal=!1,this.num_ticks=this.model.get("num_ticks");const t=this;return e.then((function(){t.create_listeners(),t.tick_format=t.generate_tick_formatter(),t.set_scales_range(),t.append_axis()}))}create_listeners(){this.listenTo(this.model,"change:scale",(function(e,t){this.update_scale(e.previous("scale"),t),this.axis.scale(this.axis_scale.scale),this.rescale_axis()})),this.listenTo(this.model,"change:tick_format",this.tickformat_changed),this.axis_scale.on("domain_changed",this.redraw_axisline,this),this.axis_scale.on("color_scale_range_changed",this.redraw_axis,this),this.axis_scale.on("highlight_axis",this.highlight,this),this.axis_scale.on("unhighlight_axis",this.unhighlight,this),this.listenTo(this.parent,"margin_updated",this.parent_margin_updated),this.listenTo(this.model,"change:visible",this.update_visibility),this.listenTo(this.model,"change:label",this.update_label),this.model.on_some_change(["side","orientation"],this.update_display,this)}update_display(){this.side=this.model.get("side"),this.vertical="vertical"===this.model.get("orientation"),this.vertical?this.axis="right"===this.side?n.axisRight(this.axis_scale.scale):n.axisLeft(this.axis_scale.scale):this.axis="top"===this.side?n.axisTop(this.axis_scale.scale):n.axisBottom(this.axis_scale.scale),this.g_axisline.remove(),this.g_axisline=this.d3el.select("#colorBarG"+this.cid).append("g").attr("class","axis"),this.rescale_axis(),this.d3el.select("#colorBarG"+this.cid).attr("transform",this.get_colorbar_transform()),this.d3el.select("#colorBarG"+this.cid).select(".g-rect").attr("transform",this.vertical?"rotate(-90)":""),this.redraw_axisline()}set_scale(e){const t=this;return this.axis_scale&&this.axis_scale.remove(),this.create_child_view(e).then((function(e){t.displayed.then((function(){e.trigger("displayed")})),t.axis_scale=e,"date_color_linear"===t.axis_scale.model.type?t.axis_line_scale=n.scaleUtc().nice():"ordinal"===t.axis_scale.model.type?(t.axis_line_scale=n.scaleBand(),t.ordinal=!0):t.axis_line_scale=n.scaleLinear()}))}append_axis(){void 0!==this.model.get("label")&&null!==this.model.get("label")&&this.d3el.append("g").attr("transform",this.get_label_transform()).attr("class","axis label_g").append("text").append("tspan").attr("id","text_elem").attr("dy","0.5ex").attr("class","axislabel").style("text-anchor",this.vertical?"middle":"end").text(this.model.get("label"));const e=this.d3el.append("g").attr("id","colorBarG"+this.cid);this.draw_color_bar(),this.set_axisline_domain(),this.g_axisline=e.append("g").attr("class","axis"),this.vertical?this.axis="right"===this.side?n.axisRight(this.axis_scale.scale):n.axisLeft(this.axis_scale.scale):this.axis="top"===this.side?n.axisTop(this.axis_scale.scale):n.axisBottom(this.axis_scale.scale),this.axis=this.axis.tickFormat(this.tick_format),this.redraw_axisline()}draw_color_bar(){const e=this.d3el.select("#colorBarG"+this.cid);e.attr("transform",this.get_colorbar_transform());const t=this;e.selectAll(".g-rect").remove(),e.selectAll(".g-defs").remove(),this.colors=this.axis_scale.scale.range();const s=100/(this.colors.length-1);if(this.ordinal){const s=this.get_color_bar_width()/this.colors.length;let i=e.append("g").attr("class","g-rect axis").selectAll("rect").data(this.colors);i=i.enter().append("rect").attr("y",0).attr("height",this.bar_height).attr("width",s).style("fill",(function(e){return e})).merge(i),this.vertical?i.attr("x",(function(e,i){return i*s-(t.height-2*t.x_offset)})):i.attr("x",(function(e,t){return t*s}))}else e.append("g").attr("class","g-defs").append("defs").append("linearGradient").attrs({id:"colorBarGradient"+this.cid,x1:"0%",y1:"0%",x2:"100%",y2:"0%"}).selectAll("stop").data(this.colors).enter().append("stop").attrs({offset:function(e,t){return s*t+"%"},"stop-color":function(e,s){return t.colors[s]},"stop-opacity":1}),e.append("g").attr("class","g-rect axis").append("rect").attrs({width:this.get_color_bar_width(),height:this.bar_height,x:this.vertical?-(this.height-2*this.x_offset):0,y:0,"stroke-width":1}).style("fill","url(#colorBarGradient"+this.cid+")");this.vertical&&e.select(".g-rect").attr("transform","rotate(-90)")}get_topg_transform(){return this.vertical?"right"===this.side?"translate("+String(this.get_basic_transform()+this.margin.right/2-this.bar_height)+", 0)":"translate("+String(this.get_basic_transform()-this.margin.left/2+this.bar_height)+", 0)":"top"===this.side?"translate(0, "+String(this.get_basic_transform()-this.margin.top+this.bar_height+24)+")":"translate(0, "+String(this.get_basic_transform()+this.margin.bottom-this.bar_height-24)+")"}get_label_transform(){return this.vertical?"translate("+("right"===this.side?this.bar_height/2:-this.bar_height/2)+", "+(this.x_offset-15)+")":"translate("+(this.x_offset-5)+", "+this.bar_height/2+")"}get_colorbar_transform(){return this.vertical?"translate(0, "+String(this.x_offset)+")":"translate("+String(this.x_offset)+", 0)"}set_axisline_scale_range(){const e=this.vertical?[this.height-2*this.x_offset,0]:[0,this.width-2*this.x_offset];if(this.ordinal)this.axis_line_scale.rangeRound(e).padding(.05);else{null==this.axis_scale.model.mid?this.axis_line_scale.range(e):this.axis_line_scale.range([e[0],.5*(e[0]+e[1]),e[1]])}}set_scales_range(){this.axis_scale.set_range(),this.set_axisline_scale_range()}get_color_bar_width(){return this.vertical?this.height-2*this.x_offset:this.width-2*this.x_offset}update_label(){this.d3el.select("#text_elem").text(this.model.get("label"))}rescale_axis(){this.set_axisline_scale_range(),this.d3el.attr("transform",this.get_topg_transform());const e=this,t=this.get_color_bar_width()/this.colors.length;if(this.ordinal){const s=this.d3el.select("#colorBarG"+this.cid).select(".g-rect").selectAll("rect").attr("width",t);this.vertical?s.attr("x",(function(s,i){return i*t-(e.height-2*e.x_offset)})):s.attr("x",(function(e,s){return s*t}))}else this.d3el.select("#colorBarG"+this.cid).select(".g-rect").selectAll("rect").attr("width",this.get_color_bar_width()).attr("x",this.vertical?-(this.height-2*this.x_offset):0);void 0!==this.model.get("label")&&null!==this.model.get("label")&&this.d3el.select(".label_g").attr("transform",this.get_label_transform()).select("#text_elem").style("text-anchor",this.vertical?"middle":"end"),this.g_axisline.call(this.axis)}redraw_axisline(){if(this.axis){let e;this.set_axisline_domain(),this.set_axisline_scale_range(),this.axis.scale(this.axis_line_scale),this.set_tick_values(),e=this.vertical?"translate("+("right"===this.side?this.bar_height:0)+", 0)":"translate(0, "+("top"===this.side?0:this.bar_height)+")",this.g_axisline.attr("transform",e).call(this.axis)}}set_axisline_domain(){const e=this.axis_scale.scale.domain();if(this.ordinal)this.axis_line_scale.domain(e);else{const t=this.axis_scale.model.mid;null==t?this.axis_line_scale.domain([e[0],e[e.length-1]]):this.axis_line_scale.domain([e[0],t,e[e.length-1]])}}redraw_axis(){this.draw_color_bar(),this.redraw_axisline()}}t.ColorAxis=o},6535:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ColorScale=void 0;const n=r(s(8944)),l=s(8980);class o extends l.Scale{render(){this.create_d3_scale(),this.update_extrapolation(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners(),this.set_range()}create_d3_scale(){this.scale=n.scaleLinear()}create_event_listeners(){super.create_event_listeners(),this.listenTo(this.model,"colors_changed",this.set_range),this.model.on("change:extrapolation",(function(){this.update_extrapolation(),this.trigger("color_scale_range_changed")}),this)}update_extrapolation(){this.scale.clamp("constant"===this.model.get("extrapolation"))}set_range(){this.scale.range(this.model.color_range),this.trigger("color_scale_range_changed")}}t.ColorScale=o},9422:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ColorScaleModel=void 0;const n=r(s(8731)),l=r(s(8944)),o=s(4060),d=r(s(8393));class c extends o.LinearScaleModel{defaults(){return Object.assign(Object.assign({},o.LinearScaleModel.prototype.defaults()),{_model_name:"ColorScaleModel",_view_name:"ColorScale",mid:null,scheme:"RdYlGn",extrapolation:"constant",colors:null})}set_init_state(){this.type="color_linear",this.color_range=[],this.mid=null}set_listeners(){super.set_listeners(),this.on_some_change(["colors","scheme"],this.colors_changed,this),this.on("change:mid",this.update_domain,this),this.colors_changed()}update_domain(){const e=this,t=this.min_from_data?l.min(n.map(this.domains,(function(t){return t.length>0?t[0]:e.global_max}))):this.min,s=this.max_from_data?l.max(n.map(this.domains,(function(t){return t.length>0?t[t.length-1]:e.global_min}))):this.max,i=this.mid;this.mid=this.get("mid");const a=this.domain,r=a.length,o=this.color_range.length;t==a[0]&&s==a[r-1]&&o==r&&this.mid==i||(this.domain=this.create_domain(t,this.mid,s,o),this.trigger("domain_changed",this.domain))}create_domain(e,t,s,i){const a=l.scaleLinear();if(null==t)a.domain([0,i-1]).range([e,s]);else{const r=(i-1)/2;a.domain([0,r,i-1]).range([e,t,s])}const r=[];for(let e=0;e<i;e++){const t=this.reverse?i-1-e:e;r.push(this.toDomainType(a(t)))}return r}colors_changed(){const e=this.get("colors");this.color_range=e.length>0?e:d.get_linear_scale_range(this.get("scheme")),this.update_domain(),this.trigger("colors_changed")}toDomainType(e){return e}}t.ColorScaleModel=c},8393:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.get_ordinal_scale_range=t.get_linear_scale_range=t.get_ordinal_scale=t.get_linear_scale=t.cycle_colors_from_scheme=t.cycle_colors=void 0;const l=r(s(8944)),o=n(s(7491)),d="RdYlGn";function c(e){return l.max(Object.keys(e).map(Number))}t.cycle_colors=function(e,t){const s=e.length;if(s>t)return e.slice(0,t);{let i=[],a=Math.floor(t/s);for(;a>0;a--)i=i.concat(e);return i.concat(e.slice(0,t%s))}},t.cycle_colors_from_scheme=function(e,t){e=e in o.default?e:d;const s=o.default[e];let i=t.toString();return 2===t?[s[3][0],s[3][2]]:i in s?s[i]:(i=c(s).toString(),this.cycle_colors(s[i],t))},t.get_linear_scale=function(e){e=e in o.default&&"qual"!==o.default[e].type?e:d;const t=o.default[e],s=t[c(t).toString()];return l.scaleLinear().range(s)},t.get_ordinal_scale=function(e,t){const s=l.scaleOrdinal();return s.range(this.cycle_colors_from_scheme(e,t)),s},t.get_linear_scale_range=function(e){return this.get_linear_scale(e).range()},t.get_ordinal_scale_range=function(e,t){return this.get_ordinal_scale(e,t).range()}},7247:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DateColorScale=void 0;const n=r(s(8944)),l=s(6535);class o extends l.ColorScale{create_d3_scale(){this.scale=n.scaleUtc()}}t.DateColorScale=o},971:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateColorScaleModel=void 0;const i=s(9422),a=s(6988);class r extends i.ColorScaleModel{defaults(){return Object.assign(Object.assign({},i.ColorScaleModel.prototype.defaults()),{_model_name:"DateColorScaleModel",_view_name:"DateColorScale",min:null,max:null,mid:null})}set_init_state(){this.type="date_color_linear",this.color_range=[],this.mid=null,this.global_min=(new Date).setTime(0),this.global_max=new Date}min_max_changed(){this.min=a.getDate(this.get("min")),this.max=a.getDate(this.get("max")),this.min_from_data=null===this.min,this.max_from_data=null===this.max,this.update_domain()}toDomainType(e){return new Date(e)}}t.DateColorScaleModel=r},7119:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DateScale=void 0;const n=r(s(8944)),l=s(2205);class o extends l.LinearScale{render(){this.scale=n.scaleUtc(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()}}t.DateScale=o},1266:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateScaleModel=void 0;const i=s(4060),a=s(6988);class r extends i.LinearScaleModel{defaults(){return Object.assign(Object.assign({},i.LinearScaleModel.prototype.defaults()),{_model_name:"DateScaleModel",_view_name:"DateScale",min:null,max:null})}typedRange(e){const t=new Float64Array(e.map(Number));return t.type="date",t}set_init_state(){this.type="date",this.global_min=(new Date).setTime(0),this.global_max=new Date}min_max_changed(){this.min=a.getDate(this.get("min")),this.max=a.getDate(this.get("max")),this.min_from_data=null===this.min,this.max_from_data=null===this.max,this.update_domain()}}t.DateScaleModel=r},8392:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FastIntervalSelector=void 0;const n=r(s(8731)),l=r(s(8944)),o=s(3248),d=r(s(8882));class c extends o.BaseXSelector{render(){super.render(),this.freeze_but_move=!0,this.freeze_dont_move=!1,this.active=!1,this.dirty=!1,this.size=this.model.get("size"),this.width=this.parent.width-this.parent.margin.left-this.parent.margin.right,this.height=this.parent.height-this.parent.margin.top-this.parent.margin.bottom;const e=this,t=this.create_scales();Promise.all([this.mark_views_promise,t]).then((function(){e.background=e.d3el.append("rect").attr("x",0).attr("y",0).attr("width",e.width).attr("height",e.height).attr("class","selector selectormouse").attr("pointer-events","all").attr("visibility","hidden"),e.background.on("mousemove",n.bind(e.mousemove,e)).on("click",n.bind(e.click,e)).on("dblclick",n.bind(e.dblclick,e)),e.rect=e.d3el.append("rect").attr("class","selector intsel").attr("x",0).attr("y",0).attr("width",e.size).attr("height",e.height).attr("pointer-events","none").attr("display","none"),e.color_change(),e.selected_changed(),e.create_listeners()}))}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:color",this.color_change)}color_change(){null!==this.model.get("color")&&this.rect.style("fill",this.model.get("color"))}click(){this.active=!0,this.rect.style("display","inline"),this.freeze_but_move=!!this.model.get("size")||!this.freeze_but_move}dblclick(){this.freeze_dont_move=!this.freeze_dont_move}mousemove(){if(this.freeze_dont_move||!this.active)return;this.dirty=!0;const e=l.mouse(this.background.node()),t=this.size>0?this.size:parseInt(this.rect.attr("width")),s=(this.height-e[1])/this.height,i=this.freeze_but_move?t:Math.round(s*this.width);let a;a=e[0]-i/2<0?0:e[0]+i/2>this.width?this.width-i:e[0]-i/2,this.rect.attr("x",a),this.rect.attr("width",i);const r=[a,a+i];this.set_selected("selected",this.scale.invert_range(r)),this.update_mark_selected(r,void 0),this.touch(),this.dirty=!1}update_mark_selected(e,t){if(void 0===e||0===e.length)return void n.each(this.mark_views,(function(e){return e.selector_changed()}));let s,i;if(void 0===t){const t=this.model.get("orientation");s="vertical"==t?[]:e,i="vertical"==t?e:[]}else s=e,i=t;const a=function(e){return d.point_in_rectangle(e,s,i)},r=function(e){return d.rect_inter_rect(e[0],e[1],s,i)};n.each(this.mark_views,(function(e){e.selector_changed(a,r)}),this)}relayout(){super.relayout(),this.adjust_rectangle(),this.background.attr("width",this.width).attr("height",this.height),this.set_range([this.scale])}reset(){this.rect.attr("x",0).attr("width",0),this.model.set("selected",null),this.update_mark_selected(void 0,void 0),this.touch()}update_scale_domain(e){super.update_scale_domain(),!0!==e&&this.selected_changed()}selected_changed(){if(this.dirty)return;const e=this.model.get("selected")||[];if(0===e.length)this.reset();else{if(2!=e.length)return;{let t=e.map(this.scale.scale);t=t.sort((function(e,t){return e-t})),this.rect.attrs({x:t[0],width:t[1]-t[0]}).style("display","inline"),this.active=!0,this.update_mark_selected(t,void 0)}}}adjust_rectangle(){"vertical"==this.model.get("orientation")?this.d3el.selectAll("rect").attr("x",0).attr("width",this.width):this.d3el.selectAll("rect").attr("y",0).attr("height",this.height)}}t.FastIntervalSelector=c},7105:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Figure=void 0;const l=r(s(5335)),o=r(s(8944));s(2802);const d=r(s(8731)),c=r(s(2298)),h=n(s(7398)),_=r(s(5384));_.ShaderChunk.scales=s(8016).Z;class u extends l.DOMWidgetView{constructor(){super(...arguments),this.relayoutRequested=!1}initialize(){this.debouncedRelayout=d.debounce((()=>{this.relayout()}),300),this.el.classList.add("bqplot"),this.el.classList.add("figure"),this.el.classList.add("jupyter-widgets"),this.change_theme();const e=document.createElementNS(o.namespaces.svg,"svg");e.classList.add("svg-figure"),this.svg=o.select(e);const t=document.createElementNS(o.namespaces.svg,"svg");t.classList.add("svg-background"),this.svg_background=o.select(t),this.el.appendChild(t),this.el.appendChild(e),this._initial_marks_created=new Promise((e=>{this._initial_marks_created_resolve=e})),super.initialize.apply(this,arguments)}getFigureSize(){const e=this.el.getBoundingClientRect(),t=e.width/e.height,s=this.model.get("min_aspect_ratio"),i=this.model.get("max_aspect_ratio");return t<s?e.height=e.width/s:t>i&&(e.width=e.height*i),e}render(){this.displayed.then((()=>{this.layoutPromise.then(this.renderImpl.bind(this))}))}renderImpl(){const e=this.getFigureSize();return this.width=e.width,this.height=e.height,this.id=l.uuid(),this.x_pad_dict={},this.y_pad_dict={},this.x_padding_arr={},this.y_padding_arr={},this.figure_padding_x=this.model.get("padding_x"),this.figure_padding_y=this.model.get("padding_y"),this.clip_id="clip_path_"+this.id,this.margin=this.model.get("fig_margin"),this.update_plotarea_dimensions(),this.plotarea_width<1||this.plotarea_height<1?this.el.style.visibility="hidden":this.el.style.visibility="",this.fig=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.fig_background=this.svg_background.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.tooltip_div=o.select(document.createElement("div")).attr("class","tooltip_div"),this.popper_reference=new c.PositionReference({x:0,y:0,width:20,height:20}),this.popper=new h.default(this.popper_reference,this.tooltip_div.node(),{placement:"auto"}),this.bg=this.fig_background.append("rect").attr("class","plotarea_background").attr("x",0).attr("y",0).attr("width",this.plotarea_width).attr("height",this.plotarea_height).styles(this.model.get("background_style")).style("pointer-events","inherit"),this.bg_events=this.fig.append("rect").attr("class","plotarea_events").attr("x",0).attr("y",0).attr("width",this.plotarea_width).attr("height",this.plotarea_height).style("pointer-events","inherit"),this.bg_events.on("click",(()=>{this.trigger("bg_clicked")})),this.fig_axes=this.fig_background.append("g"),this.fig_marks=this.fig.append("g"),this.interaction=this.fig.append("g"),this.clip_path=this.svg.append("svg:defs").append("svg:clipPath").attr("id",this.clip_id).append("rect").attr("x",0).attr("y",0).attr("width",this.plotarea_width).attr("height",this.plotarea_height),this.title=this.fig.append("text").attr("class","mainheading").attr("x",.5*this.plotarea_width).attr("y",-this.margin.top/2).attr("dy","1em").styles(this.model.get("title_style")),this.title.text(this.model.get("title")),this.model.on("save_png",this.save_png,this),this.model.on("save_svg",this.save_svg,this),this.create_figure_scales().then((()=>{this.mark_views=new l.ViewList(this.add_mark,this.remove_mark,this);const e=this.mark_views.update(this.model.get("marks")).then((e=>{this.replace_dummy_nodes(e),this.update_marks(e),this.update_legend(),this.set_interaction(this.model.get("interaction")),this._initial_marks_created_resolve(),this.update_gl()}));this.axis_views=new l.ViewList(this.add_axis,null,this);const t=this.axis_views.update(this.model.get("axes"));return this.model.on_some_change(["fig_margin","min_aspect_ratio","max_aspect_ratio"],this.debouncedRelayout,this),this.model.on_some_change(["padding_x","padding_y"],(()=>{this.figure_padding_x=this.model.get("padding_x"),this.figure_padding_y=this.model.get("padding_y"),this.trigger("margin_updated")}),this),this.model.on("change:axes",((e,t,s)=>{this.axis_views.update(t)}),this),this.model.on("change:marks",((e,t,s)=>{this.mark_views.update(t).then((e=>{this.replace_dummy_nodes(e),this.update_marks(e),this.update_legend(),this.update_gl()}))}),this),this.model.on("change:legend_location",this.update_legend,this),this.model.on("change:title",this.update_title,this),this.model.on("change:interaction",((e,t)=>{Promise.all(this.mark_views.views).then((e=>{this.set_interaction(t)}))}),this),document.body.appendChild(this.tooltip_div.node()),this.create_listeners(),window.addEventListener("resize",this.debouncedRelayout),this.once("remove",(()=>{window.removeEventListener("resize",this.debouncedRelayout)})),Promise.all([e,t])}))}createWebGLRenderer(){this.renderer||(this.renderer=new _.WebGLRenderer({antialias:!0,alpha:!0,premultipliedAlpha:!0}),this.renderer.setSize(100,100),this.renderer.setClearAlpha(0),this.renderer.setPixelRatio(this.model.get("pixel_ratio")||window.devicePixelRatio)),this.renderer&&!this.el.contains(this.renderer.domElement)&&this.el.insertBefore(this.renderer.domElement,this.el.childNodes[1]),this.layout_webgl_canvas()}replace_dummy_nodes(e){d.each(e,(function(e){null!==e.dummy_node&&e.dummy_node.parentNode&&(e.dummy_node.parentNode.replaceChild(e.el,e.dummy_node),e.dummy_node=null,this.displayed.then((function(){e.trigger("displayed")})))}),this)}create_listeners(){this.listenTo(this.model,"change:title_style",this.title_style_updated),this.listenTo(this.model,"change:background_style",this.background_style_updated),this.listenTo(this.model,"change:layout",this.change_layout),this.listenTo(this.model,"change:legend_style",this.legend_style_updated),this.listenTo(this.model,"change:legend_text",this.legend_text_updated),this.listenTo(this.model,"change:pixel_ratio",(()=>{this.renderer&&(this.renderer.setPixelRatio(this.model.get("pixel_ratio")||window.devicePixelRatio),this.update_gl())})),this.listenTo(this.model,"change:theme",this.change_theme)}title_style_updated(){this.title.styles(this.model.get("title_style"))}background_style_updated(){this.bg.styles(this.model.get("background_style"))}legend_style_updated(){this.fig_marks.selectAll(".g_legend").selectAll(".axis").selectAll("rect").styles(this.model.get("legend_style"))}legend_text_updated(){this.fig_marks.selectAll(".g_legend").selectAll("text.legendtext").styles(this.model.get("legend_text"))}create_figure_scales(){const e=this,t=this.create_child_view(this.model.get("scale_x")).then((function(t){e.scale_x=t,e.scale_x.scale.clamp(!0),e.scale_x.set_range([0,e.plotarea_width])})),s=this.create_child_view(this.model.get("scale_y")).then((function(t){e.scale_y=t,e.scale_y.scale.clamp(!0),e.scale_y.set_range([e.plotarea_height,0])}));return Promise.all([t,s])}padded_range(e,t){if(!t.get("allow_padding"))return this.range(e);const s=t.model_id;if("x"===e){const e=void 0!==this.x_padding_arr[s]?this.x_padding_arr[s]:0,t=this.plotarea_width*this.figure_padding_x;return[t+e,this.plotarea_width-t-e]}if("y"===e){const e=void 0!==this.y_padding_arr[s]?this.y_padding_arr[s]:0,t=this.plotarea_height*this.figure_padding_y;return[this.plotarea_height-e-t,e+t]}}range(e){return"x"===e?[0,this.plotarea_width]:"y"===e?[this.plotarea_height,0]:void 0}get_mark_plotarea_height(e){if(!e.get("allow_padding"))return this.plotarea_height;const t=e.model_id,s=void 0!==this.y_padding_arr[t]?this.y_padding_arr[t]:0;return this.plotarea_height*(1-this.figure_padding_y)-s-s}get_mark_plotarea_width(e){if(!e.get("allow_padding"))return this.plotarea_width;const t=e.model_id,s=void 0!==this.x_padding_arr[t]?this.x_padding_arr[t]:0;return this.plotarea_width*(1-this.figure_padding_x)-s-s}add_axis(e){const t=this;return this.create_child_view(e).then((function(e){return t.fig_axes.node().appendChild(e.el),t.displayed.then((function(){e.trigger("displayed")})),e}))}remove_from_padding_dict(e,t,s){if(null==s)return;const i=s.model_id;void 0!==e[i]&&(delete e[i][t.model.model_id+"_"+t.cid],0===Object.keys(e[i]).length&&delete e[i])}update_padding_dict(e,t,s,i){const a=s.model_id;e[a]||(e[a]={}),e[a][t.model.model_id+"_"+t.cid]=i}mark_scales_updated(e){const t=e.model,s=t.previous("scales");this.remove_from_padding_dict(this.x_pad_dict,e,s[t.get_key_for_orientation("horizontal")]),this.remove_from_padding_dict(this.y_pad_dict,e,s[t.get_key_for_orientation("vertical")]);const i=t.get("scales");this.update_padding_dict(this.x_pad_dict,e,i[t.get_key_for_orientation("horizontal")],e.x_padding),this.update_padding_dict(this.y_pad_dict,e,i[t.get_key_for_orientation("vertical")],e.y_padding),this.update_paddings()}mark_padding_updated(e){const t=e.model,s=t.get("scales");this.update_padding_dict(this.x_pad_dict,e,s[t.get_key_for_orientation("horizontal")],e.x_padding),this.update_padding_dict(this.y_pad_dict,e,s[t.get_key_for_orientation("vertical")],e.y_padding),this.update_paddings()}update_marks(e){this.update_paddings()}remove_mark(e){const t=e.model;t.off("redraw_legend",null,this),t.off("data_updated",null,this),t.off("scales_updated",null,this),t.off("mark_padding_updated",null,this);const s=t.get("scales");this.remove_from_padding_dict(this.x_pad_dict,e,s[t.get_key_for_orientation("horizontal")]),this.remove_from_padding_dict(this.y_pad_dict,e,s[t.get_key_for_orientation("vertical")]),e.remove()}add_mark(e){e.state_change.then((()=>{e.on("data_updated redraw_legend",this.update_legend,this)}));const t=this.fig_marks.node().appendChild(document.createElementNS(o.namespaces.svg,"g"));return this.create_child_view(e,{clip_id:this.clip_id}).then((e=>{e.dummy_node=t,e.on("mark_padding_updated",(()=>{this.mark_padding_updated(e)}),this),e.on("mark_scales_updated",(()=>{this.mark_scales_updated(e)}),this);let s=e.model.get("scales")[e.model.get_key_for_dimension("x")],i=e.model.get("scales")[e.model.get_key_for_dimension("y")];return void 0===s&&(s=this.scale_x.model),void 0===i&&(i=this.scale_y.model),this.update_padding_dict(this.x_pad_dict,e,s,e.x_padding),this.update_padding_dict(this.y_pad_dict,e,i,e.y_padding),e.render_gl&&this.createWebGLRenderer(),e.on("remove",(()=>{t.parentNode&&t.remove()})),e}))}update_paddings(){this.x_padding_arr={},this.y_padding_arr={};const e=this;d.forEach(this.x_pad_dict,(function(t,s){let i=0;d.forEach(t,(function(e,t){i=Math.max(i,e)})),e.x_padding_arr[s]=i})),d.forEach(this.y_pad_dict,(function(t,s){let i=0;d.forEach(t,(function(e,t){i=Math.max(i,e)})),e.y_padding_arr[s]=i})),this.trigger("margin_updated")}update_plotarea_dimensions(){this.plotarea_width=this.width-this.margin.left-this.margin.right,this.plotarea_height=this.height-this.margin.top-this.margin.bottom}processPhosphorMessage(e){switch(super.processPhosphorMessage.apply(this,arguments),e.type){case"resize":case"after-show":case"after-attach":if(this.pWidget.isVisible){const e=this.getFigureSize();this.width===e.width&&this.height===e.height||this.debouncedRelayout()}}}relayout(){this.relayoutRequested||(this.relayoutRequested=!0,requestAnimationFrame((()=>{this.relayoutRequested=!1;const e=this.getFigureSize();this.width=e.width,this.height=e.height,this.margin=this.model.get("fig_margin"),this.update_plotarea_dimensions(),this.plotarea_width<1||this.plotarea_width<1?this.el.style.visibility="hidden":(this.el.style.visibility="",void 0!==this.scale_x&&null!==this.scale_x&&this.scale_x.set_range([0,this.plotarea_width]),void 0!==this.scale_y&&null!==this.scale_y&&this.scale_y.set_range([this.plotarea_height,0]),this.fig.attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.fig_background.attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.title.attrs({x:.5*this.plotarea_width,y:-this.margin.top/2,dy:"1em"}),this.bg.attr("width",this.plotarea_width).attr("height",this.plotarea_height),this.bg_events.attr("width",this.plotarea_width).attr("height",this.plotarea_height),this.clip_path.attr("width",this.plotarea_width).attr("height",this.plotarea_height),this.trigger("margin_updated"),this.update_legend(),this.layout_webgl_canvas())}).bind(this)))}layout_webgl_canvas(){this.renderer&&(this.renderer.domElement.style="left: "+this.margin.left+"px; top: "+this.margin.top+"px;",this.renderer.setSize(this.plotarea_width,this.plotarea_height),this.update_gl())}update_legend(){this.fig_marks.selectAll(".g_legend").remove();const e=this.model.get("legend_location"),t=this.fig_marks.append("g").attr("class","g_legend"),s=this;let i=1,a=1;void 0!==this.mark_views&&null!==this.mark_views&&Promise.all(this.mark_views.views).then((function(r){r.forEach((function(e){if(e.model.get("display_legend")){const s=e.draw_legend(t,0,16*i,0,16);i+=s[0],a=s[1]?Math.max(a,s[1]):a}}));const n=s.get_legend_coords(e,24,16*(i+1),0);1!==i&&t.insert("g",":first-child").attr("class","axis").append("rect").attr("y",8).attr("x",-8).attr("width",a+2+"em").attr("height",16*i),a="top-right"===e||"right"===e||"bottom-right"===e?-(a+2):1,t.attr("transform","translate("+String(n[0]+16*a)+" "+String(n[1])+") "),t.selectAll("text.legendtext").styles(s.model.get("legend_text")),t.selectAll(".axis").selectAll("rect").styles(s.model.get("legend_style"))}))}get_legend_coords(e,t,s,i){let a=0,r=0;const n=this.plotarea_width,l=this.plotarea_height;switch(e){case"top":a=.5*n-t,r=0;break;case"top-right":a=n-i,r=0;break;case"right":a=n-i,r=.5*l-s;break;case"bottom-right":a=n-i,r=l-s;break;case"bottom":a=.5*n-t,r=l-s;break;case"bottom-left":a=0,r=l-s;break;case"left":a=0,r=.5*l-s;break;default:a=0,r=0}return[a,r]}set_interaction(e){return e?e.state_change.then((()=>this.create_child_view(e).then((e=>(this.interaction_view&&this.interaction_view.remove(),this.interaction_view=e,this.interaction.node().appendChild(e.el),this.displayed.then((()=>{e.trigger("displayed")})),e))))):(this.interaction_view&&this.interaction_view.remove(),Promise.resolve(null))}update_title(e,t){this.title.text(this.model.get("title"))}remove(){return void 0!==this.mark_views&&null!==this.mark_views&&this.mark_views.remove(),void 0!==this.axis_views&&null!==this.axis_views&&this.axis_views.remove(),void 0!==this.tooltip_div&&this.tooltip_div.remove(),super.remove.apply(this,arguments)}get_svg(){return this.render_gl().then((async()=>{const e=this.svg_background.node(),t=this.svg.node(),s=this.plotarea_width,i=this.plotarea_height,a=t.cloneNode(!0),r=[...a.querySelectorAll("image")];await Promise.all(r.map((async e=>{const t=await(await fetch(e.getAttribute("href"))).blob(),s=new FileReader,i=new Promise(((e,t)=>{s.onloadend=e,s.onerror=t,s.abort=t}));s.readAsDataURL(t),await i,e.setAttribute("href",s.result)}))),a.setAttribute("version","1.1"),a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("width",this.width),a.setAttribute("height",this.height),a.style.background=window.getComputedStyle(document.body).background;const n=window.getComputedStyle(this.el);var l=function(e,t){let s="";const i=document.styleSheets;let a;for(let n=0;n<i.length;n++){let l=null;try{l=i[n].cssRules}catch(e){}if(l)for(let i=0;i<l.length;i++){const n=l[i];if(void 0!==n.style){let i=null;try{i=e.querySelectorAll(n.selectorText)}catch(e){console.warn("Invalid CSS selector '"+n.selectorText+"'",e)}if(i){if(e.querySelectorAll(n.selectorText).length>0){a=n.selectorText;for(let e=0;e<t.length;e++)r=t[e],"",a=a.replace(new RegExp(r,"g"),"");s+=`${a} { ${n.style.cssText} }\n                                    `}}else n.cssText.match(/^@font-face/)&&(s+=n.cssText+"\n")}}}var r;return s+="svg { font-size: 10px; }\n",s}(this.el,[".theme-dark",".theme-light",".bqplot > ",":root"])+"\n",d=(l.match(/(--\w[\w-]*)/g)||[]).reduce(((e,t)=>`${e}\n\t${t}: ${n.getPropertyValue(t)};`),":root {")+"\n}\n";const c=document.createElement("style");c.setAttribute("type","text/css"),c.innerHTML="<![CDATA[\n"+d+l+"]]>";const h=document.createElement("defs");h.appendChild(c);const _=a.children[0],u=e.cloneNode(!0);if(_.insertBefore(u.children[0].children[1],_.children[0]),_.insertBefore(u.children[0].children[0],_.children[0]),this.renderer){const e=this.renderer.domElement.toDataURL("image/png");o.select(_.children[3]).insert("image",":first-child").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("preserveAspectRatio","none").attr("transform","scale("+s+", "+i+")").attr("href",e)}return a.insertBefore(h,a.firstChild),a.outerHTML}))}get_rendered_canvas(e){return e=e||window.devicePixelRatio,this.get_svg().then((t=>new Promise((s=>{const i=new Image;i.onload=()=>{const t=document.createElement("canvas");t.classList.add("bqplot"),t.width=this.width*e,t.height=this.height*e,t.style.width=this.width,t.style.height=this.height;const a=t.getContext("2d");a.scale(e,e),a.drawImage(i,0,0),s(t)},i.src="data:image/svg+xml;base64,"+btoa(t)}))))}save_png(e,t){this.get_rendered_canvas(t).then((t=>{const s=document.createElement("a");s.download=e||"image.png",s.href=t.toDataURL("image/png"),document.body.appendChild(s),s.click()}))}save_svg(e){this.get_svg().then((t=>{const s=document.createElement("a");s.download=e||"bqplot.svg",s.href="data:text/plain;charset=utf-8,"+encodeURIComponent(t),document.body.appendChild(s),s.click(),document.body.removeChild(s)}))}async getPixel(e,t){return(await this.get_rendered_canvas(window.devicePixelRatio)).getContext("2d").getImageData(e*window.devicePixelRatio,t*window.devicePixelRatio,1,1).data}update_gl(){this._update_requested||(this._update_requested=!0,requestAnimationFrame(this._update_gl.bind(this)))}_update_gl(){this.render_gl(),this._update_requested=!1}render_gl(){return this.renderer?Promise.all(this.mark_views.views).then((e=>{this.renderer.autoClear=!1,this.renderer.autoClearColor=new _.Color(0),this.renderer.clear();let t=d.filter(e,(e=>e.render_gl));d.each(t,(e=>{e.render_gl()}))})):Promise.resolve()}change_theme(){this.el.classList.remove(this.model.previous("theme")),this.el.classList.add(this.model.get("theme"))}}t.Figure=u},9539:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FigureModel=void 0;const n=r(s(5335)),l=s(8657);class o extends n.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},n.DOMWidgetModel.prototype.defaults()),{_model_name:"FigureModel",_view_name:"Figure",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:l.semver_range,_view_module_version:l.semver_range,title:"",axes:[],marks:[],interaction:null,scale_x:void 0,scale_y:void 0,title_style:{},background_style:{},legend_style:{},legend_text:{},theme:"classic",min_aspect_ratio:.01,max_aspect_ratio:100,pixel_ratio:null,fig_margin:{top:60,bottom:60,left:60,right:60},padding_x:0,padding_y:.025,legend_location:"top-right",animation_duration:0})}initialize(e,t){super.initialize(e,t),this.on("msg:custom",this.handle_custom_messages,this)}handle_custom_messages(e){"save_png"===e.type?this.trigger("save_png",e.filename,e.scale):"save_svg"===e.type&&this.trigger("save_svg",e.filename)}save_png(){this.trigger("save_png")}}t.FigureModel=o,o.serializers=Object.assign(Object.assign({},n.DOMWidgetModel.serializers),{marks:{deserialize:n.unpack_models},axes:{deserialize:n.unpack_models},interaction:{deserialize:n.unpack_models},scale_x:{deserialize:n.unpack_models},scale_y:{deserialize:n.unpack_models},layout:{deserialize:n.unpack_models}})},7703:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FlexLine=void 0;const n=r(s(8944)),l=s(9233);class o extends l.Lines{render(){const e=super.render.apply(this),t=this;return e.then((function(){t.create_listeners(),t.draw()}))}set_ranges(){super.set_ranges();const e=this.scales.width;e&&e.set_range([.5,this.model.get("stroke_width")])}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:labels_visibility",this.update_legend_labels)}draw_legend(e,t,s,i,a){const r=e.selectAll(".legend"+this.uuid).data(this.model.mark_data,(function(e,t){return e.name})),l=this,o=.8*a;r.enter().append("g").attr("class","legend"+this.uuid).attr("transform",(function(e,t){return"translate(0, "+(t*a+s)+")"})).append("line").style("stroke",(function(e,t){return l.get_colors(t)})).attr("x1",0).attr("x2",o).attr("y1",o/2).attr("y2",o/2),r.append("text").attr("class","legendtext").attr("x",1.2*o).attr("y",o/2).attr("dy","0.35em").text((function(e,t){return l.model.get("labels")[t]})).style("fill",(function(e,t){return l.get_colors(t)}));const d=n.max(this.model.get("labels"),(function(e){return e.length}));return r.exit().remove(),[this.model.mark_data.length,d]}set_positional_scales(){const e=this.scales.x,t=this.scales.y;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.draw()})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw()}))}initialize_additional_scales(){const e=this.scales.color;e&&(this.listenTo(e,"domain_changed",(function(){this.draw()})),e.on("color_scale_range_changed",this.draw,this))}draw(){this.set_ranges();let e=this.d3el.selectAll(".curve").data(this.model.mark_data,(function(e,t){return e.name}));e.exit().transition("draw").duration(this.parent.model.get("animation_duration")).remove(),e=e.enter().append("g").attr("class","curve").merge(e);const t=this.scales.x,s=this.scales.y,i=this;e.nodes().forEach((function(e,a){let r=n.select(e).selectAll("line").data(i.model.mark_data[a].values);r=r.enter().append("line").merge(r),r.attr("class","line-elem").attr("x1",(function(e){return t.scale(e.x1)})).attr("x2",(function(e){return t.scale(e.x2)})).attr("y1",(function(e){return s.scale(e.y1)})).attr("y2",(function(e){return s.scale(e.y2)})).attr("stroke",i.get_mark_color.bind(i)).attr("stroke-width",(function(e){return i.get_element_width(e)}))}))}get_element_width(e){const t=this.scales.width;return void 0!==t&&void 0!==e.size?t.scale(e.size):this.model.get("stroke_width")}relayout(){this.set_ranges();const e=this.scales.x,t=this.scales.y;this.d3el.selectAll(".curve").selectAll(".line-elem").transition("relayout").duration(this.parent.model.get("animation_duration")).attr("x1",(function(t){return e.scale(t.x1)})).attr("x2",(function(t){return e.scale(t.x2)})).attr("y1",(function(e){return t.scale(e.y1)})).attr("y2",(function(e){return t.scale(e.y2)}))}}t.FlexLine=o},36:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Stereographic=t.Gnomonic=t.Orthographic=t.EquiRectangular=t.AlbersUSA=t.Albers=t.Mercator=t.GeoScale=void 0;const n=r(s(8944)),l=r(s(5335));class o extends l.WidgetView{render(){this.set_projection(),this.listenTo(this.model,"attribute_changed",this.reset_scale)}set_projection(){this.path=n.geoPath().projection(this.model.projection),this.scale=this.model.projection}reset_scale(){this.set_projection(),this.trigger("domain_changed",null)}}t.GeoScale=o,t.Mercator=class extends o{},t.Albers=class extends o{},t.AlbersUSA=class extends o{},t.EquiRectangular=class extends o{},t.Orthographic=class extends o{},t.Gnomonic=class extends o{},t.Stereographic=class extends o{}},6865:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.StereographicModel=t.GnomonicModel=t.OrthographicModel=t.EquiRectangularModel=t.AlbersUSAModel=t.AlbersModel=t.MercatorModel=t.GeoScaleModel=void 0;const n=r(s(8944)),l=s(6370);class o extends l.ScaleModel{defaults(){return Object.assign(Object.assign({},l.ScaleModel.prototype.defaults()),{_model_name:"GeoScaleModel",_view_name:"GeoScale"})}compute_and_set_domain(e,t){}update_domain(){}}t.GeoScaleModel=o,t.MercatorModel=class extends o{defaults(){return Object.assign(Object.assign({},o.prototype.defaults()),{_model_name:"MercatorModel",_view_name:"Mercator",scale_factor:190,center:[0,60],rotate:[0,0]})}initialize(e,t){super.initialize(e,t),this.on_some_change(["scale_factor","center","rotate"],this.create_projection,this),this.create_projection()}create_projection(){this.projection=n.geoMercator().center(this.get("center")).scale(this.get("scale_factor")).rotate(this.get("rotate")),this.attribute_changed()}attribute_changed(){this.trigger("attribute_changed")}},t.AlbersModel=class extends o{defaults(){return Object.assign(Object.assign({},o.prototype.defaults()),{_model_name:"AlbersModel",_view_name:"Albers",scale_factor:250,center:[0,60],parallels:[29.5,45.5],precision:.1})}initialize(e,t){super.initialize(e,t),this.on_some_change(["rotate","center","parallels","scale_factor","precision"],this.create_projection,this),this.create_projection()}create_projection(){this.projection=n.geoAlbers().rotate(this.get("rotate")).center(this.get("center")).parallels(this.get("parallels")).scale(this.get("scale_factor")).precision(this.get("precision")),this.attribute_changed()}attribute_changed(){this.trigger("attribute_changed")}},t.AlbersUSAModel=class extends o{defaults(){return Object.assign(Object.assign({},o.prototype.defaults()),{_model_name:"AlbersUSAModel",_view_name:"AlbersUSA",scale_factor:1200,translate:[600,490]})}initialize(e,t){super.initialize(e,t),this.on_some_change(["scale_factor","translate"],this.create_projection,this),this.create_projection()}create_projection(){this.projection=n.geoAlbersUsa().scale(this.get("scale_factor")).translate(this.get("translate")),this.attribute_changed()}attribute_changed(){this.trigger("attribute_changed")}},t.EquiRectangularModel=class extends o{defaults(){return Object.assign(Object.assign({},o.prototype.defaults()),{_model_name:"EquiRectangularModel",_view_name:"EquiRectangular",scale_factor:145})}initialize(e,t){super.initialize(e,t),this.on_some_change(["scale_factor","center"],this.create_projection,this),this.create_projection()}create_projection(){this.projection=n.geoEquirectangular().center(this.get("center")).scale(this.get("scale_factor")),this.attribute_changed()}attribute_changed(){this.trigger("attribute_changed")}},t.OrthographicModel=class extends o{defaults(){return Object.assign(Object.assign({},o.prototype.defaults()),{_model_name:"OrthographicModel",_view_name:"Orthographic",scale_factor:145,center:[0,60],rotate:[0,0],clip_angle:90,precision:.1})}initialize(e,t){super.initialize(e,t),this.on_some_change(["scale_factor","center","clip_angle","rotate","precision"],this.create_projection,this),this.create_projection()}create_projection(){this.projection=n.geoOrthographic().center(this.get("center")).scale(this.get("scale_factor")).clipAngle(this.get("clip_angle")).rotate(this.get("rotate")).precision(this.get("precision")),this.attribute_changed()}attribute_changed(){this.trigger("attribute_changed")}},t.GnomonicModel=class extends o{defaults(){return Object.assign(Object.assign({},o.prototype.defaults()),{_model_name:"GnomonicModel",_view_name:"Gnomonic",scale_factor:145,center:[0,60],precision:.1,clip_angle:89.999})}initialize(e,t){super.initialize(e,t),this.on_some_change(["scale_factor","precision","clip_angle"],this.create_projection,this),this.create_projection()}create_projection(){this.projection=n.geoGnomonic().clipAngle(this.get("clip_angle")).scale(this.get("scale_factor")).precision(this.get("precision")),this.attribute_changed()}attribute_changed(){this.trigger("attribute_changed")}},t.StereographicModel=class extends o{defaults(){return Object.assign(Object.assign({},o.prototype.defaults()),{_model_name:"StereographicModel",_view_name:"StereographicModel",scale_factor:245,center:[0,60],precision:.1,rotate:[96,0],clip_angle:179.9999})}initialize(e,t){super.initialize(e,t),this.on_some_change(["scale_factor","center","clip_angle","rotate","precision"],this.create_projection,this),this.create_projection()}create_projection(){this.projection=n.geoStereographic().scale(this.get("scale_factor")).rotate(this.get("rotate")).clipAngle(this.get("clip_angle")).center(this.get("center")).precision(this.get("precision")),this.attribute_changed()}attribute_changed(){this.trigger("attribute_changed")}}},2931:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=void 0;const n=r(s(8944));s(2802);const l=function(){return s(8556).B}.bind(this),o=r(s(8731)),d=s(3332);class c extends d.Mark{render(){const e=super.render();return this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.selected_indices=this.model.get("selected"),this.hovered_style=this.model.get("hovered_style"),this.unhovered_style=this.model.get("unhovered_style"),this.hovered_index=this.model.get("hovered_point")?[this.model.get("hovered_point")]:null,this.display_el_classes=["element"],this.event_metadata={mouse_over:{msg_name:"hover",lookup_data:!1,hit_test:!0},element_clicked:{msg_name:"element_click",lookup_data:!1,hit_test:!0},parent_clicked:{msg_name:"background_click",hit_test:!1}},this.displayed.then((()=>{this.parent.tooltip_div.node().appendChild(this.tooltip_div.node()),this.create_tooltip()})),this.d3el.attr("class","network"),this.arrow=this.parent.svg.append("defs").append("marker").attr("id","arrow").attr("refX",0).attr("refY",3).attr("markerWidth",10).attr("markerHeight",10).attr("orient","auto").append("path").attr("class","linkarrow").attr("d","M0,0 L0,6 L9,3 z"),e.then((()=>{this.event_listeners={},this.process_interactions(),this.create_listeners(),this.compute_view_padding(),this.draw()}))}set_ranges(){const e=this.scales.x,t=this.scales.y;e&&e.set_range(this.parent.padded_range("x",e.model)),t&&t.set_range(this.parent.padded_range("y",t.model))}set_positional_scales(){this.x_scale=this.scales.x,this.y_scale=this.scales.y,this.x_scale||(this.x_scale=this.parent.scale_x),this.y_scale||(this.y_scale=this.parent.scale_y),this.listenTo(this.x_scale,"domain_changed",(function(){this.model.dirty||this.update_position()})),this.listenTo(this.y_scale,"domain_changed",(function(){this.model.dirty||this.update_position()}))}relayout(){this.set_ranges(),this.update_position()}update_position(){const e=this.scales.x,t=this.scales.y;this.set_ranges(),e&&t&&(this.model.mark_data.forEach((function(s){s.x=e.scale(s.xval)+e.offset,s.y=t.scale(s.yval)+t.offset})),this.force_layout&&(this.force_layout.nodes(this.model.mark_data).force("link",n.forceLink(this.model.link_data).distance(this.model.get("link_distance"))),this.links&&this.links.data(this.model.link_data),this.nodes&&this.nodes.data(this.force_layout.nodes()),this.nodes&&this.links&&this.tick()))}initialize_additional_scales(){const e=this.scales.color;e&&(this.listenTo(e,"domain_changed",(function(){this.color_scale_updated()})),e.on("color_scale_range_changed",this.color_scale_updated,this));const t=this.scales.link_color;t&&this.listenTo(t,"domain_changed",(function(){this.link_color_scale_updated()}))}create_listeners(){super.create_listeners(),this.d3el.on("mouseover",o.bind((function(){this.event_dispatcher("mouse_over")}),this)).on("mousemove",o.bind((function(){this.event_dispatcher("mouse_move")}),this)).on("mouseout",o.bind((function(){this.event_dispatcher("mouse_out")}),this)),this.listenTo(this.model,"change:charge",this.update_charge),this.listenTo(this.model,"change:link_distance",this.update_link_distance),this.listenTo(this.model,"data_updated",this.data_updated),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.listenTo(this.model,"change:enable_hover",(function(){this.hide_tooltip()})),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:hovered_point",this.update_hovered),this.listenTo(this.model,"change:hovered_style",this.hovered_style_updated),this.listenTo(this.model,"change:unhovered_style",this.unhovered_style_updated),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")}))}data_updated(){this.draw(),this.relayout()}draw(){this.set_ranges();const e=this.scales.x,t=this.scales.y,s=this.scales.link_color;this.d3el.selectAll(".node").remove(),this.d3el.selectAll(".link").remove(),e&&t&&this.model.mark_data.forEach((function(s){s.x=e.scale(s.xval)+e.offset,s.y=t.scale(s.yval)+t.offset}));const i=this.parent.fig.node().getBBox(),a=i.width,r=i.height;this.force_layout=n.forceSimulation().force("center",n.forceCenter(a/2,r/2)).force("forceX",n.forceX().strength(.1).x(a/2)).force("forceY",n.forceY().strength(.1).y(r/2)),e||t||this.force_layout.force("charge",n.forceManyBody().strength(this.model.get("charge"))).on("tick",o.bind(this.tick,this));const l=this.model.get("directed");this.links=this.d3el.selectAll(".link").data(this.model.link_data).enter().append("path").attr("class","link").style("stroke",(function(e){return s?s.scale(e.value):null})).style("stroke-width",(function(e){return e.link_width})).attr("marker-mid",l?"url(#arrow)":null),this.force_layout.nodes(this.model.mark_data).force("link",n.forceLink(this.model.link_data).distance(this.model.get("link_distance"))),this.nodes=this.d3el.selectAll(".node").data(this.force_layout.nodes()).enter().append("g").attr("class","node").call(n.drag().on("start",this.dragstarted.bind(this)).on("drag",this.dragged.bind(this)).on("end",this.dragended.bind(this))),this.nodes.append((function(e){return document.createElementNS(n.namespaces.svg,e.shape)})).attr("class","element").each((function(e){const t=n.select(this);for(let s in e.shape_attrs)t.attr(s,e.shape_attrs[s])})).style("fill",this.get_mark_color.bind(this)),this.nodes.append("text").attr("class","label").attr("text-anchor",(function(e){return"center"===e.label_display?"middle":"start"})).attr("x",(function(e){let t=0;if("outside"===e.label_display)switch(e.shape){case"rect":t=e.shape_attrs.width/2+5;break;case"circle":t=e.shape_attrs.r+5;break;case"ellipse":t=e.shape_attrs.rx+5;break;default:t=0}return t})).attr("y",".31em").text((function(e){return e.label})).style("display",(function(e){return"none"===e.label_display?"none":"inline"})),this.nodes.on("click",o.bind((function(e,t){this.event_dispatcher("element_clicked",{data:e,index:t})}),this)),this.nodes.on("mouseover",o.bind((function(e,t){this.hover_handler({data:e,index:t})}),this)),this.nodes.on("mouseout",o.bind((function(){this.reset_hover_points()}),this))}dragstarted(e){l().active||this.force_layout.alphaTarget(.4).restart(),e.fx=e.x,e.fy=e.y}dragged(e){e.fx=l().x,e.fy=l().y}dragended(e){l().active||this.force_layout.alphaTarget(.4),e.fx=null,e.fy=null}color_scale_updated(){this.nodes.selectAll(".element").style("fill",this.get_mark_color.bind(this))}link_color_scale_updated(){const e=this.scales.link_color;this.links.style("stroke",(function(t){return e?e.scale(t.value):null}))}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler)}reset_hover_points(){this.links.style("opacity",1),this.model.set("hovered_point",null),this.hovered_index=null,this.touch()}hover_handler(e){const t=e.data,s=e.index;this.model.get("highlight_links")?this.links.style("opacity",(function(e){return e.source.label===t.label||e.target.label===t.label?1:.1})):this.links.style("opacity",1),this.model.set("hovered_point",s,{updated_view:this}),this.touch()}reset_selection(){this.model.set("selected",null),this.selected_indices=null,this.touch()}click_handler(e){const t=e.index,s=this.model.get("selected")||[];let i=Array.from(s);const a=i.indexOf(t),r=l().ctrlKey||l().metaKey;a>-1&&r?i.splice(a,1):(r||(i=[]),i.push(t)),this.model.set("selected",0===i.length?null:i,{updated_view:this}),this.touch();let n=l();n||(n=window.event),void 0!==n.cancelBubble&&(n.cancelBubble=!0),n.stopPropagation&&n.stopPropagation(),n.preventDefault()}hovered_style_updated(e,t){this.hovered_style=t,this.clear_style(e.previous("hovered_style"),this.hovered_index),this.style_updated(t,this.hovered_index)}unhovered_style_updated(e,t){this.unhovered_style=t;const s=this.hovered_index,i=s?o.range(this.model.mark_data.length).filter((function(e){return-1===s.indexOf(e)})):[];this.clear_style(e.previous("unhovered_style"),i),this.style_updated(t,i)}update_selected(e,t){this.selected_indices=t,this.apply_styles()}update_hovered(e,t){this.hovered_index=null===t?t:[t],this.apply_styles()}apply_styles(e){null==e&&(e=[this.selected_style,this.unselected_style,this.hovered_style,this.unhovered_style]),super.apply_styles(e);const t=o.range(this.model.mark_data.length);this.set_style_on_elements(this.hovered_style,this.hovered_index);const s=this.hovered_index?o.difference(t,this.hovered_index):[];this.set_style_on_elements(this.unhovered_style,s)}clear_style(e,t){let s=this.d3el.selectAll(".element");t&&(s=s.filter((function(e,s){return-1!==t.indexOf(s)})));const i={};for(let t in e)i[t]=null;s.styles(i)}set_style_on_elements(e,t){if(!t||0===t.length)return;if(void 0!==e&&0===Object.keys(e).length)return;let s=this.d3el.selectAll(".element");s=s.filter((function(e,s){return-1!==t.indexOf(s)})),s.styles(e)}compute_view_padding(){const e=n.max(this.model.mark_data.map((function(e){return(e.shape_attrs.r||e.shape_attrs.width/2||e.shape_attrs.rx)+1}))),t=n.max(this.model.mark_data.map((function(e){return(e.shape_attrs.r||e.shape_attrs.height/2||e.shape_attrs.ry)+1})));e===this.x_padding&&t===this.y_padding||(this.x_padding=e,this.y_padding=e,this.trigger("mark_padding_updated"))}selected_deleter(){l().stopPropagation()}update_link_distance(){const e=this.scales.x,t=this.scales.y,s=this.model.get("link_distance");e||t||this.force_layout.linkDistance(s).start()}update_charge(){const e=this.scales.x,t=this.scales.y,s=this.model.get("charge");e||t||this.force_layout.charge(s).start()}link_arc(e){const t=e.target.x-e.source.x,s=e.target.y-e.source.y,i=Math.sqrt(t*t+s*s);return"M"+e.source.x+","+e.source.y+"A"+i+","+i+" 0 0,1 "+e.target.x+","+e.target.y}link_line(e){const t=(e.source.x+e.target.x)/2,s=(e.source.y+e.target.y)/2;return"M"+e.source.x+","+e.source.y+"L"+t+","+s+"L"+e.target.x+","+e.target.y}link_slant_line(e){const t=(e.source.x+e.target.x)/2;return"M"+e.source.x+","+e.source.y+"L"+t+","+e.target.y+"L"+e.target.x+","+e.target.y}tick(){const e=this.model.get("link_type");this.nodes.attr("transform",(function(e){return"translate("+e.x+","+e.y+")"})),this.nodes.select("rect").attr("transform",(function(e){return"translate("+-e.shape_attrs.width/2+","+-e.shape_attrs.height/2+")"}));let t=this.link_arc;switch(e){case"arc":t=this.link_arc;break;case"line":t=this.link_line;break;case"slant_line":t=this.link_slant_line;break;default:t=this.link_arc}this.links.attr("d",(function(e){return t(e)}))}set_default_style(e){}}t.Graph=c},9213:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.GraphModel=void 0;const n=r(s(8944)),l=s(9250),o=r(s(1961));class d extends l.MarkModel{defaults(){return Object.assign(Object.assign({},l.MarkModel.prototype.defaults()),{_model_name:"GraphModel",_view_name:"Graph",node_data:[],link_matrix:[],link_data:[],charge:300,link_distance:100,link_type:"arc",directed:!0,highlight_links:!0,colors:n.scaleOrdinal(n.schemeCategory10).range(),x:[],y:[],color:null,link_color:null,hovered_point:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}}})}initialize(e,t){super.initialize(e,t),this.on_some_change(["x","y","color","link_color","node_data","link_data","link_color"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data()}update_node_data(){let e=this.get("node_data");const t=this.get("x"),s=this.get("y"),i=this.get("color")||[],a=this.get("scales").color;e.length>0&&"string"==typeof e[0]&&(e=e.map((function(e){return{label:e}}))),this.mark_data=[];const r=this;e.forEach((function(e,t){e.label=e.label||"N"+t,e.label_display=e.label_display||"center",e.shape=e.shape||"circle",e.shape_attrs=function(e,t){const s={};switch(e){case"circle":s.r=t.r||15;break;case"rect":s.width=t.width||25,s.height=t.height||.8*s.width,s.rx=t.rx||0,s.ry=t.ry||0;break;case"ellipse":s.rx=t.rx||20,s.ry=t.ry||.6*s.rx;break;default:console.log("Invalid shape passed - ",e)}return s}(e.shape,e.shape_attrs||{}),e.value=e.value||null,r.mark_data.push(e)})),0!==t.length&&0!==s.length&&(a&&(this.get("preserve_domain").color?a.del_domain([],this.model_id+"_color"):a.compute_and_set_domain(i,this.model_id+"_color")),this.mark_data.forEach((function(e,a){e.xval=t[a],e.yval=s[a],e.color=i[a]})))}update_link_data(){const e=this.get("scales").link_color;this.link_data=this.get("link_data");let t=this.get("link_matrix");const s=this.get("link_color"),i=this;void 0!==e&&s.length>0&&(t=s),0===this.link_data.length&&t.length>0&&t.forEach((function(e,t){e.forEach((function(e,s){null!==e&&i.link_data.push({source:t,target:s,value:e})}))}))}update_data(){this.dirty=!0,this.update_node_data(),this.update_link_data(),this.update_unique_ids(),this.update_domains(),this.dirty=!1,this.trigger("data_updated")}update_unique_ids(){}get_data_dict(e,t){return e}update_domains(){const e={x:"xval",y:"yval"};if(!this.mark_data)return;const t=this.get("scales");for(let s in t)if(t.hasOwnProperty(s)){const i=t[s];this.get("preserve_domain")[s]?i.del_domain([],this.model_id+s):i.compute_and_set_domain(this.mark_data.map((function(t){return t[s]||t[e[s]]})),this.model_id+s)}}}t.GraphModel=d,d.serializers=Object.assign(Object.assign({},l.MarkModel.serializers),{x:o.array_or_json,y:o.array_or_json,color:o.array_or_json,link_color:o.array_or_json,link_matrix:o.array_or_json})},3445:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.GridHeatMap=void 0;const n=r(s(8944));s(2802);const l=function(){return s(8556).B}.bind(this),o=r(s(8731)),d=s(3332);class c extends d.Mark{render(){const e=super.render(),t=this;return this.displayed.then((function(){t.parent.tooltip_div.node().appendChild(t.tooltip_div.node()),t.create_tooltip()})),this.selected_indices=this.model.get("selected"),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.anchor_style=this.model.get("anchor_style"),this.display_el_classes=["heatmapcell"],e.then((function(){t.event_listeners={},t.process_interactions(),t.create_listeners(),t.compute_view_padding(),t.draw()}))}initialize_additional_scales(){const e=this.scales.color;e&&(this.listenTo(e,"domain_changed",(function(){this.apply_styles()})),e.on("color_scale_range_changed",this.apply_styles,this))}set_ranges(){const e=this.scales.row;if(e){const t=this.parent.padded_range("y",e.model);e.set_range(t)}const t=this.scales.column;t&&t.set_range(this.parent.padded_range("x",t.model))}set_positional_scales(){const e=this.scales.column,t=this.scales.row;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.draw()})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw()}))}expand_scale_domain(e,t,s,i){let a,r;if("expand_one"===s){a=t.map((function(t){return e.scale(t)}));const s=a.slice(1).map((function(e,t){return e-a[t]}));if(r=0,s[0]<0?(i=!i,r=n.max(s)):r=n.min(s),i){const s=a[a.length-1]+r;return[t[0],e.invert(s)]}{const s=a[0]-r;return[e.invert(s),t[a.length-1]]}}if("expand_two"===s){a=t.map((function(t){return e.scale(t)})),r=n.min(a.slice(1).map((function(e,t){return e-a[t]})));const s=a[a.length-1]+r,i=a[0]-r;return[e.invert(i),e.invert(s)]}}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:stroke",this.update_stroke),this.listenTo(this.model,"change:opacity",this.update_opacity),this.d3el.on("mouseover",o.bind((function(){this.event_dispatcher("mouse_over")}),this)).on("mousemove",o.bind((function(){this.event_dispatcher("mouse_move")}),this)).on("mouseout",o.bind((function(){this.event_dispatcher("mouse_out")}),this)),this.listenTo(this.model,"data_updated",this.draw),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")})),this.model.on_some_change(["display_format","font_style"],this.update_labels,this),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:interactions",this.process_interactions)}click_handler(e){const t=this.model.colors[0].length,s=e.row_num*t+e.column_num,i=e.row_num,a=e.column_num,r=this;let n=Array.from(this.model.get("selected")||[]),d=this._cell_nums_from_indices(n);const c=d.indexOf(s),h=l().ctrlKey||l().metaKey;if(c>-1&&h)n.splice(c,1);else if(h||(d=[],n=[]),n.push([i,a]),d.push(r._cell_nums_from_indices([[i,a]])[0]),l().shiftKey){if(c>-1)return;const e=0!==d.length?r.anchor_cell_index[0]:i,t=0!==d.length?r.anchor_cell_index[1]:a;o.range(Math.min(i,e),Math.max(i,e)+1).forEach((function(e){o.range(Math.min(a,t),Math.max(a,t)+1).forEach((function(t){const s=r._cell_nums_from_indices([[e,t]])[0];-1===d.indexOf(s)&&(d.push(s),n.push([e,t]))}))}))}else this.anchor_cell_index=[i,a];this.model.set("selected",0===n.length?null:n,{updated_view:this}),this.touch();let _=l();_||(_=window.event),void 0!==_.cancelBubble&&(_.cancelBubble=!0),_.stopPropagation&&_.stopPropagation(),_.preventDefault(),this.selected_indices=n,this.apply_styles()}update_selected(e,t){this.selected_indices=t,this.apply_styles()}set_style_on_elements(e,t,s){t&&(0!==t.length||s&&0!==s.length)&&0!==Object.keys(e).length&&(s=s&&0!==s.length?s:this._filter_cells_by_cell_num(this._cell_nums_from_indices(t))).styles(e)}set_default_style(e,t){if(!e||0===e.length&&(!t||0===t.length))return;t=t&&0!==t.length?t:this._filter_cells_by_cell_num(this._cell_nums_from_indices(e));const s=this.model.get("stroke"),i=this.model.get("opacity"),a=this;t.style("fill",(function(e){return a.get_element_fill(e)})).style("opacity",i).style("stroke",s)}clear_style(e,t,s){if(0===Object.keys(e).length)return;s&&0!==s.length||(s=t?this._filter_cells_by_cell_num(this._cell_nums_from_indices(t)):this.display_cells);const i={};for(let t in e)i[t]=null;s.styles(i)}_filter_cells_by_cell_num(e){return null==e?[]:this.display_cells.filter((function(t){return-1!==e.indexOf(t._cell_num)}))}selected_style_updated(e,t){this.selected_style=t,this.clear_style(e.previous("selected_style"),this.selected_indices,this.selected_elements),this.style_updated(t,this.selected_indices,this.selected_elements)}unselected_style_updated(e,t){this.unselected_style=t,this.clear_style(e.previous("unselected_style"),[],this.unselected_elements),this.style_updated(t,[],this.unselected_elements)}apply_styles(){const e=this.model.colors.length,t=this.model.colors[0].length;this.clear_style(this.selected_style),this.clear_style(this.unselected_style),this.clear_style(this.anchor_style),this.set_default_style([],this.display_cells);const s=this._cell_nums_from_indices(this.selected_indices),i=null===s||0===s.length?[]:o.difference(o.range(e*t),s);if(this.selected_elements=this._filter_cells_by_cell_num(s),this.set_style_on_elements(this.selected_style,this.selected_indices,this.selected_elements),this.unselected_elements=this._filter_cells_by_cell_num(i),this.set_style_on_elements(this.unselected_style,[],this.unselected_elements),null!==this.anchor_cell_index&&void 0!==this.anchor_cell_index){const e=this._cell_nums_from_indices([this.anchor_cell_index]);this.anchor_element=this._filter_cells_by_cell_num(e),this.set_style_on_elements(this.anchor_style,[],this.anchor_element)}}style_updated(e,t,s){this.set_default_style(t,s),this.set_style_on_elements(e,t,s)}reset_selection(){this.model.set("selected",null),this.touch(),this.selected_indices=null,this.clear_style(this.selected_style),this.clear_style(this.unselected_style),this.clear_style(this.anchor_style),this.set_default_style([],this.display_cells)}relayout(){this.set_ranges(),this.compute_view_padding(),this.draw()}_cell_nums_from_indices(e){if(null==e)return null;const t=this.model.colors[0].length;return e.map((function(e){return e[0]*t+e[1]}))}invert_point(e){}selector_changed(e,t){if(void 0===e)return this.model.set("selected",null),this.touch(),[];const s=o.range(this.model.colors[0].length),i=o.range(this.model.colors.length),a=this,r=o.filter(s,(function(e){return t([a.column_pixels[e],[]])})),n=o.filter(i,(function(e){return t([[],a.row_pixels[e]])}));let l=r.map((function(e){return n.map((function(t){return[t,e]}))}));l=o.flatten(l,!0),this.model.set("selected",l),this.touch()}draw(){this.set_ranges();const e=this,t=this.model.colors.length,s=this.model.colors[0].length,i=this.scales.row,a=this.scales.column,r="start"===this.model.get("row_align"),l="start"===this.model.get("column_align");let d;"middle"!==this.model.modes.row&&"boundaries"!==this.model.modes.row&&(d=this.expand_scale_domain(i,this.model.rows,this.model.modes.row,r),(n.min(d)<n.min(i.model.domain)||n.max(d)>n.max(i.model.domain))&&i.model.compute_and_set_domain(d,i.model.model_id)),"middle"!==this.model.modes.column&&"boundaries"!==this.model.modes.column&&(d=this.expand_scale_domain(a,this.model.columns,this.model.modes.column,l),(n.min(d)<n.min(a.model.domain)||n.max(d)>n.max(a.model.domain))&&a.model.compute_and_set_domain(d,a.model.model_id));const c=this.get_tile_plotting_data(i,this.model.rows,this.model.modes.row,r),h=this.get_tile_plotting_data(a,this.model.columns,this.model.modes.column,l);this.row_pixels=c.start.map((function(e,t){return[e,e+c.widths[t]]})),this.column_pixels=h.start.map((function(e,t){return[e,e+h.widths[t]]})),this.display_rows=this.d3el.selectAll(".heatmaprow").data(o.range(t)).join("g").attr("class","heatmaprow").attr("transform",(function(e){return"translate(0, "+c.start[e]+")"}));const _=o.range(s),u=o.range(t).map((function(t){return _.map((function(i){return e.model.mark_data[t*s+i]}))}));this.display_cells=this.display_rows.selectAll(".heatmapcell").data((function(e,t){return u[t]})).join("rect").attr("class","heatmapcell").on("click",o.bind((function(){this.event_dispatcher("element_clicked")}),this)),this.display_cells.attr("x",(function(e,t){return h.start[t]})).attr("y",0).attr("width",(function(e,t){return h.widths[t]})).attr("height",(function(e){return c.widths[e.row_num]})),this.display_cell_labels=this.display_rows.selectAll(".heatmapcell_label").data((function(e,t){return u[t]})).join("text").attr("class","heatmapcell_label").attr("x",(function(e,t){return h.start[t]+h.widths[t]/2})).attr("y",(function(e){return c.widths[e.row_num]/2})).style("text-anchor","middle").style("fill","black").style("pointer-events","none").style("dominant-baseline","central"),this.apply_styles(),this.update_labels(),this.display_cells.on("click",(function(t,s){return e.event_dispatcher("element_clicked",{data:t.color,index:s,row_num:t.row_num,column_num:t.column_num})}))}update_stroke(e,t){this.display_cells.style("stroke",t)}update_opacity(e,t){this.display_cells.style("opacity",t)}update_labels(){const e=this.model.get("display_format"),t=e?n.format(e):null;let s=this.d3el.selectAll(".heatmapcell_label").text((function(e,s){return t?t(e.color):null}));const i=this.model.get("font_style");for(const e in i)s=s.style(e,i[e])}get_tile_plotting_data(e,t,s,i){let a=[],r=[];if(t=Array.from(t),"middle"===s)return a=t.map((function(t){return e.scale(t)})),r=t.map((function(t){return e.scale.bandwidth()})),{start:a,widths:r};if("boundaries"===s){const s=t.map((function(t){return e.scale(t)}));r=[];for(let e=1;e<s.length;++e)r[e-1]=Math.abs(s[e]-s[e-1]);return a=s[1]>s[0]?s.slice(0,-1):s.slice(1),{start:a,widths:r}}if("expand_one"===s){let s;return i?(a=t.map((function(t){return e.scale(t)})),r=a.slice(1).map((function(e,t){return Math.abs(e-a[t])})),s=n.max(e.scale.range()),r=a[0]<a[1]?Array.prototype.concat(r,[Math.abs(s-n.max(a))]):Array.prototype.concat([Math.abs(s-n.max(a))],r)):(a=t.map((function(t){return e.scale(t)})),r=a.slice(1).map((function(e,t){return Math.abs(e-a[t])})),s=n.min(e.scale.range()),s=n.min(e.scale.range()),a[1]>a[0]?(a.unshift(Math.abs(s)),r.splice(0,0,a[1]-a[0]),a.pop()):(r=Array.prototype.concat(r,[Math.abs(s-a.slice(-1)[0])]),a=Array.prototype.concat(a,s),a.splice(0,1))),{widths:r,start:a}}if("expand_two"===s){a=t.map((function(t){return e.scale(t)}));const s=a[1]-a[0]>0;let i=s?n.min(e.scale.range()):n.max(e.scale.range());return a.splice(0,0,i),r=a.slice(1).map((function(e,t){return Math.abs(e-a[t])})),i=s?n.max(e.scale.range()):n.min(e.scale.range()),r[r.length]=Math.abs(i-a.slice(-1)[0]),{start:a,widths:r}}}get_element_fill(e){return null===e.color?this.model.get("null_color"):this.scales.color.scale(e.color)}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler)}compute_view_padding(){}}t.GridHeatMap=c},9825:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.GridHeatMapModel=void 0;const n=r(s(8731)),l=s(9250),o=r(s(1961));class d extends l.MarkModel{defaults(){return Object.assign(Object.assign({},l.MarkModel.prototype.defaults()),{_model_name:"GridHeatMapModel",_view_name:"GridHeatMap",row:null,column:null,color:null,scales_metadata:{row:{orientation:"vertical",dimension:"y"},column:{orientation:"horizontal",dimension:"x"},color:{dimension:"color"}},row_align:"start",column_align:"start",null_color:"black",stroke:"black",opacity:1,anchor_style:{},display_format:null,font_style:{}})}initialize(e,t){super.initialize(e,t),this.on_some_change(["row","column","color"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()}update_data(){this.dirty=!0,this.colors=this.get("color")||[[]];const e=this.colors.length,t=this.colors[0].length;this.rows=this.get("row")||n.range(e),this.columns=this.get("column")||n.range(t);const s=[].concat.apply([],this.colors.map((e=>Array.prototype.slice.call(e,0))));this.mark_data=s.map(((e,s)=>{const i=Math.floor(s/t),a=s%t;return{row_num:i,row:this.rows[i],column:this.columns[a],column_num:a,color:e,_cell_num:s}})),this.identify_modes(),this.update_domains(),this.dirty=!1,this.trigger("data_updated")}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.row,s=e.column,i=e.color;this.get("preserve_domain").row?t.del_domain([],this.model_id+"_row"):t.compute_and_set_domain(this.rows,this.model_id+"_row"),this.get("preserve_domain").column?s.del_domain([],this.model_id+"_column"):s.compute_and_set_domain(this.columns,this.model_id+"_column"),null!=i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(this.mark_data.map((function(e){return e.color})),this.model_id+"_color"))}get_data_dict(e,t){return e}identify_modes(){const e={},t=this.get("scales"),s=t.row,i=t.column,a=this.colors.length,r=this.colors[0].length;"ordinal"===s.type?e.row="middle":a===this.rows.length-1?e.row="boundaries":a===this.rows.length?e.row="expand_one":a===this.rows.length+1&&(e.row="expand_two"),"ordinal"===i.type?e.column="middle":r===this.columns.length-1?e.column="boundaries":r===this.columns.length?e.column="expand_one":r===this.columns.length+1&&(e.column="expand_two"),this.modes=e}}t.GridHeatMapModel=d,d.serializers=Object.assign(Object.assign({},l.MarkModel.serializers),{row:o.array_or_json,column:o.array_or_json,color:o.array_or_json})},1007:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandDraw=void 0;const n=r(s(8944)),l=r(s(6988)),o=s(5237),d=s(6988).convert_dates;class c extends o.Interaction{render(){super.render(),this.d3el.style("cursor","crosshair"),this.active=!1,this.set_lines_view().then((()=>{this.d3el.on("mousedown",(()=>this.mousedown())),this.set_limits()})),this.update_line_index(),this.listenTo(this.model,"change:line_index",this.update_line_index),this.model.on_some_change(["min_x","max_x"],this.set_limits,this)}set_lines_view(){const e=this.parent,t=this.model.get("lines");return Promise.all(e.mark_views.views).then((s=>{const i=e.mark_views._models.map((e=>e.model_id)).indexOf(t.model_id);this.lines_view=s[i]}))}mousedown(){this.active=!0,this.mouse_entry(!1),this.d3el.on("mousemove",(()=>{this.mousemove()})),this.d3el.on("mouseleave",(()=>{this.mouseup()})),this.d3el.on("mouseup",(()=>{this.mouseup()}))}mouseup(){if(this.active){this.mouse_entry(!0);const e=this.model.get("lines");e.set("y",d(l.deepCopy(e.y_data))),this.lines_view.touch(),this.active=!1,this.d3el.on("mousemove",null),this.d3el.on("mouseleave",null),this.d3el.on("mouseup",null)}}mousemove(){this.mouse_entry(!0)}mouse_entry(e){if(this.active){const t=this.model.get("lines"),s=Math.min(this.line_index,t.x_data.length-1),i=n.mouse(this.el);e&&"previous_pos"in this||(this.previous_pos=i);const a=this.lines_view.scales.x.scale,r=this.lines_view.scales.y.scale,l=a.invert(i[0]),o=r.invert(i[1]),d=a.invert(this.previous_pos[0]);r.invert(this.previous_pos[1]);const c=this.nns(t.x_data[s],d),h=this.nns(t.x_data[s],l),_=Math.min(c,h),u=Math.max(c,h);for(let e=_;e<=u;++e)(!this.valid_min||t.x_data[s][e]>=this.min_x)&&(!this.valid_max||t.x_data[s][e]<=this.max_x)&&(t.y_data[this.line_index][e]=o);const g=Array.prototype.map.call(t.x_data[s],((e,s)=>({x:e,y:t.y_data[this.line_index][s]})));this.lines_view.d3el.select("#curve"+(this.line_index+1)).attr("d",function(e){return this.lines_view.line(g)}.bind(this)),this.previous_pos=i}}capnfloor(e){return Math.max(Math.min(e,this.model.get("max_x")),this.model.get("min_x"))}set_limits(){"date"==this.lines_view.scales.x.model.type?(this.min_x=l.getDate(this.model.get("min_x")),this.valid_min=!(null===this.min_x||void 0===this.min_x||isNaN(this.min_x.getTime())),this.max_x=l.getDate(this.model.get("max_x")),this.valid_max=!(null===this.max_x||void 0===this.max_x||isNaN(this.max_x.getTime()))):(this.min_x=this.model.get("min_x"),this.max_x=this.model.get("max_x"),this.valid_min=!(null===this.min_x||void 0===this.min_x),this.valid_max=!(null===this.max_x||void 0===this.max_x))}nns(e,t){const s=this.lines_view.bisect(e,t);return t-e[s-1]>e[s]-t?s:s-1}update_line_index(){this.line_index=this.model.get("line_index")}}t.HandDraw=c},5662:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandDrawModel=void 0;const n=r(s(5335)),l=s(8657);class o extends n.WidgetModel{defaults(){return Object.assign(Object.assign({},n.WidgetModel.prototype.defaults()),{_model_name:"HandDrawModel",_view_name:"HandDraw",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:l.semver_range,_view_module_version:l.semver_range,lines:null,line_index:0,min_x:null,max_x:null})}}t.HandDrawModel=o,o.serializers=Object.assign(Object.assign({},n.DOMWidgetModel.serializers),{lines:{deserialize:n.unpack_models}})},5561:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HeatMap=void 0;const n=r(s(8944)),l=r(s(8731)),o=s(3332);class d extends o.Mark{render(){const e=super.render(),t=this;return this.displayed.then((function(){t.parent.tooltip_div.node().appendChild(t.tooltip_div.node()),t.create_tooltip()})),this.image=n.select(this.el).append("image").classed("heatmap",!0).attr("width",this.parent.width).attr("height",this.parent.height),this.canvas=document.createElement("canvas"),e.then((function(){t.event_listeners={},t.process_interactions(),t.create_listeners(),t.compute_view_padding(),t.draw()}))}set_ranges(){const e=this.scales.x;if(e){const t=this.parent.padded_range("x",e.model);e.set_range(t)}const t=this.scales.y;t&&t.set_range(this.parent.padded_range("y",t.model))}set_positional_scales(){const e=this.scales.x,t=this.scales.y;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.draw()})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw()}))}initialize_additional_scales(){const e=this.scales.color;e&&(this.listenTo(e,"domain_changed",(function(){this.draw()})),e.on("color_scale_range_changed",this.draw,this))}create_listeners(){super.create_listeners(),this.d3el.on("mouseover",l.bind((function(){this.event_dispatcher("mouse_over")}),this)).on("mousemove",l.bind((function(){this.event_dispatcher("mouse_move")}),this)).on("mouseout",l.bind((function(){this.event_dispatcher("mouse_out")}),this)),this.listenTo(this.model,"data_updated",this.draw),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")})),this.listenTo(this.model,"change:interactions",this.process_interactions)}click_handler(e){}relayout(){this.set_ranges(),this.compute_view_padding(),this.draw()}drawCanvas(){this.image.attr("href",this.canvas.toDataURL("image/png"))}draw(){this.set_ranges();const e=this.getPlottingData();this.canvas.setAttribute("width",e.totalWidth),this.canvas.setAttribute("height",e.totalHeight);const t=this.canvas.getContext("2d");this.model.mark_data.color.forEach(((s,i)=>{const a=e.heights[i],r=e.yOrigin+e.yStartPoints[i];s.forEach(((s,i)=>{const n=e.widths[i],l=e.xOrigin+e.xStartPoints[i];t.fillStyle=this.getElementFill(s),t.fillRect(l,r,this.expandRect(n),this.expandRect(a))}))})),this.image.attr("width",e.totalWidth).attr("height",e.totalHeight).attr("x",e.x0).attr("y",e.y0),this.drawCanvas()}expandRect(e){return e>0?e+.5:e-.5}getPlottingData(){const e=Array.from(this.model.mark_data.x).map(this.scales.x.scale),t=Array.from(this.model.mark_data.y).map(this.scales.y.scale),s=this.scales.x.model.get("reverse"),i=this.scales.y.model.get("reverse"),a=this.getPadding(e,t),r=this.computeRectSizes(e,a.left,a.right),n=this.computeRectSizes(t,a.bottom,a.top,!0),l=Math.abs(e[e.length-1]-e[0]+a.left+a.right),o=Math.abs(t[0]-t[t.length-1]+a.top+a.bottom),d=e[0]-a.left,c=t[t.length-1]-a.top;return{widths:r,heights:n,totalWidth:l,totalHeight:o,xOrigin:s?l:0,yOrigin:i?o:0,xStartPoints:e.map(((t,s)=>0==s?0:.5*(t+e[s-1])-d)),yStartPoints:t.map(((e,s)=>s==t.length-1?0:.5*(e+t[s+1])-c)),x0:s?d-l:d,y0:i?c-o:c}}getPadding(e,t){const s=e.length,i=t.length;return{left:.5*(e[1]-e[0]),right:.5*(e[s-1]-e[s-2]),bottom:.5*-(t[1]-t[0]),top:.5*-(t[i-1]-t[i-2])}}computeRectSizes(e,t,s,i=!1){const a=i?-1:1;return e.map(((i,r)=>0==r?a*(e[1]-i)*.5+t:r==e.length-1?a*(i-e[r-1])*.5+s:a*(e[r+1]-e[r-1])*.5))}getElementFill(e){return null===e?this.model.get("null_color"):this.scales.color.scale(e)}clear_style(e,t,s){}compute_view_padding(){}set_default_style(e,t){}set_style_on_elements(e,t,s){}}t.HeatMap=d},4448:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HeatMapModel=void 0;const n=s(9250),l=r(s(1961));class o extends n.MarkModel{defaults(){return Object.assign(Object.assign({},n.MarkModel.prototype.defaults()),{_model_name:"HeatMapModel",_view_name:"HeatMap",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},null_color:"black"})}initialize(e,t){super.initialize(e,t),this.on_some_change(["x","y","color"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()}update_data(){this.dirty=!0,this.mark_data={x:this.get("x"),y:this.get("y"),color:this.get("color")},this.update_domains(),this.dirty=!1,this.trigger("data_updated")}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.x,s=e.y,i=e.color,a=[].concat.apply([],this.mark_data.color.map((e=>Array.prototype.slice.call(e,0))));this.get("preserve_domain").x?t.del_domain([],this.model_id+"_x"):t.compute_and_set_domain(this.mark_data.x,this.model_id+"_x"),this.get("preserve_domain").y?s.del_domain([],this.model_id+"_y"):s.compute_and_set_domain(this.mark_data.y,this.model_id+"_y"),null!=i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(a,this.model_id+"_color"))}get_data_dict(e,t){return e}}t.HeatMapModel=o,o.serializers=Object.assign(Object.assign({},n.MarkModel.serializers),{x:l.array_or_json,y:l.array_or_json,color:l.array_or_json})},4245:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Hist=void 0;const n=r(s(8731)),l=r(s(8944)),o=function(){return s(8556).B}.bind(this),d=r(s(6988)),c=s(3332);class h extends c.Mark{render(){const e=super.render();this.selected_indices=this.calc_bar_indices_from_data_idx(this.model.get("selected")),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.display_el_classes=["rect","legendtext"];const t=this;return this.displayed.then((function(){t.parent.tooltip_div.node().appendChild(t.tooltip_div.node()),t.create_tooltip()})),e.then((function(){t.event_listeners={},t.process_interactions(),t.create_listeners(),t.draw(),t.update_selected(t.model,t.model.get("selected"))}))}set_ranges(){const e=this.scales.sample;e&&e.set_range(this.parent.padded_range("x",e.model));const t=this.scales.count;t&&t.set_range(this.parent.padded_range("y",t.model))}set_positional_scales(){const e=this.scales.sample,t=this.scales.count;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.model.update_data()})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw()}))}create_listeners(){super.create_listeners(),this.d3el.on("mouseover",n.bind((function(){this.event_dispatcher("mouse_over")}),this)).on("mousemove",n.bind((function(){this.event_dispatcher("mouse_move")}),this)).on("mouseout",n.bind((function(){this.event_dispatcher("mouse_out")}),this)),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.listenTo(this.model,"data_updated",this.draw),this.listenTo(this.model,"change:colors",this.update_colors),this.model.on_some_change(["stroke","opacities"],this.update_stroke_and_opacities,this),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")}))}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.bar_click_handler)}update_colors(){this.d3el.selectAll(".bargroup").selectAll("rect").style("fill",((e,t)=>this.get_colors(e.index))),this.model.get("labels")&&this.d3el.selectAll(".bargroup").selectAll("text").style("fill",((e,t)=>this.get_colors(t))),this.legend_el&&(this.legend_el.selectAll("rect").style("fill",((e,t)=>this.get_colors(t))),this.legend_el.selectAll("text").style("fill",((e,t)=>this.get_colors(t))))}update_stroke_and_opacities(){const e=this.model.get("stroke"),t=this.model.get("opacities");this.d3el.selectAll(".rect").style("stroke",e).style("opacity",(function(e,s){return t[s]}))}calculate_bar_width(){const e=this.scales.sample;let t=(e.scale(this.model.max_x)-e.scale(this.model.min_x))/this.model.num_bins;return t>=10&&(t-=2),t}relayout(){this.set_ranges();const e=this.scales.sample,t=this.scales.count;this.d3el.selectAll(".bargroup").attr("transform",(function(s){return"translate("+e.scale(s.x0)+","+t.scale(s.y)+")"}));const s=this.calculate_bar_width();this.d3el.selectAll(".bargroup").select("rect").transition("relayout").duration(this.parent.model.get("animation_duration")).attr("x",2).attr("width",s).attr("height",(function(e){return t.scale(0)-t.scale(e.y)}))}draw(){this.set_ranges();const e=[];this.model.mark_data.forEach((function(t,s){e.push(s)}));const t=this.scales.sample,s=this.scales.count,i=this,a=this.calculate_bar_width();let r=this.d3el.selectAll(".bargroup").data(this.model.mark_data);r.exit().remove();const n=r.enter().append("g").attr("class","bargroup");n.append("rect").attr("class","rect").attr("x",2).attr("width",0).attr("height",0),r=n.merge(r),r.attr("transform",(function(e){return"translate("+t.scale(e.x0)+","+s.scale(e.y)+")"})),r.select(".rect").style("fill",((e,t)=>this.get_colors(e.index))).on("click",(function(e,t){return i.event_dispatcher("element_clicked",{data:e,index:t})})).attr("id",(function(e,t){return"rect"+t})).transition("draw").duration(this.parent.model.get("animation_duration")).attr("width",a).attr("height",(function(e){return s.scale(0)-s.scale(e.y)})),this.bin_pixels=this.model.x_bins.map((function(e){return t.scale(e)+t.offset})),this.pixel_coords=this.model.mark_data.map((function(e){const i=t.scale(e.x0);return[[i,i+a],[0,e.y].map(s.scale)]})),this.update_stroke_and_opacities()}bar_click_handler(e){const t=e.index,s=this,i=this.selected_indices;let a=i?d.deepCopy(i):[];const r=a.indexOf(t),c=o().ctrlKey||o().metaKey;if(r>-1&&c)a.splice(r,1);else if(o().shiftKey){if(r>-1)return;const e=0!==a.length?l.min(a):-1,i=0!==a.length?l.max(a):s.model.mark_data.length;t>i?n.range(i+1,t+1).forEach((function(e){a.push(e)})):t<e&&n.range(t,e).forEach((function(e){a.push(e)}))}else c||(a=[]),a.push(t);this.selected_indices=a,this.model.set("selected",0===a.length?null:this.calc_data_indices(a),{updated_view:this}),this.touch();let h=o();void 0!==h.cancelBubble&&(h.cancelBubble=!0),h.stopPropagation&&h.stopPropagation(),h.preventDefault()}draw_legend(e,t,s,i,a){this.legend_el=e.selectAll(".legend"+this.uuid).data([this.model.mark_data[0]]);const r=this,o=.8*a,d=this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",(function(e,t){return"translate(0, "+(t*a+s)+")"})).on("mouseover",n.bind((function(){this.event_dispatcher("legend_mouse_over")}),this)).on("mouseout",n.bind((function(){this.event_dispatcher("legend_mouse_out")}),this)).on("click",n.bind((function(){this.event_dispatcher("legend_clicked")}),this));d.append("rect").style("fill",(function(e,t){return r.get_colors(t)})).attr("x",0).attr("y",0).attr("width",o).attr("height",o),d.append("text").attr("class","legendtext").attr("x",1.2*o).attr("y",o/2).attr("dy","0.35em").text((function(e,t){return r.model.get("labels")[t]})).style("fill",(function(e,t){return r.get_colors(t)})),this.legend_el=d.merge(this.legend_el);const c=l.max(this.model.get("labels"),(function(e){return e.length}));return this.legend_el.exit().remove(),[1,c]}update_selected(e,t){this.selected_indices=this.calc_bar_indices_from_data_idx(t),this.apply_styles()}clear_style(e,t){let s=this.d3el.selectAll(".bargroup");t&&(s=s.filter((function(e,s){return-1!==t.indexOf(s)})));const i={};for(const t in e)i[t]=null;s.selectAll(".bar").styles(i)}set_default_style(e,t){this.update_colors(),this.update_stroke_and_opacities()}set_style_on_elements(e,t){if(null==t||0===t.length)return;if(0===Object.keys(e).length)return;let s=this.d3el.selectAll(".bargroup");s=s.filter((function(e,s){return-1!==t.indexOf(s)})),s.selectAll(".rect").styles(e)}invert_point(e){if(void 0===e)return this.model.set("selected",null),void this.touch();const t=this.calculate_bar_width(),s=this.bin_pixels.map((function(s){return Math.abs(s+t/2-e)})),i=s.indexOf(l.min(s));this.model.set("selected",this.calc_data_indices([i])),this.touch()}selector_changed(e,t){if(void 0===e)return this.model.set("selected",null),this.touch(),[];const s=this.pixel_coords,i=new Uint32Array(n.range(s.length)).filter((e=>t(s[e])));this.model.set("selected",this.calc_data_indices(i)),this.touch()}calc_data_indices(e){const t=this.reduce_intervals(e);if(0===t.length)return[];const s=this.model.get("sample"),i=t.length;return new Uint32Array(n.range(s.length)).filter((e=>{const a=s[e];for(let e=0;e<i;e++)if(a<=t[e][1]&&a>=t[e][0])return!0;return!1}))}reduce_intervals(e){const t=[];if(0!==e.length){e.sort();let s=e[0],i=e[0];for(let a=1;a<e.length;a++)e[a]===i+1?i++:(t.push([this.model.x_bins[s],this.model.x_bins[i+1]]),s=i=e[a]);t.push([this.model.x_bins[s],this.model.x_bins[i+1]])}return t}calc_data_indices_from_data_range(e,t){const s=l.max([0,l.bisectLeft(this.bin_pixels,e)-1]),i=l.min([this.model.num_bins,l.bisectRight(this.bin_pixels,t)]),a=this.model.get("sample"),r=this;return n.filter(n.range(a.length),(function(e){return a[e]>=r.model.x_bins[s]&&a[e]<=r.model.x_bins[i]}))}calc_bar_indices_from_data_idx(e){if(null===e)return null;const t=this.model.get("sample"),s=Array.from(e).map((function(e){return t[e]}));let i=[];for(let e=0;e<s.length;e++){let t=Math.min(n.indexOf(this.model.x_bins,s[e],!0),this.model.x_bins.length-2);-1===t&&(t=n.sortedIndex(this.model.x_bins,s[e])-1),i.push(t)}return i.sort(),i=n.uniq(i,!0),i}reset_selection(){this.selected_indices=[],this.model.set("selected",null),this.touch()}compute_view_padding(){}}t.Hist=h},3612:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HistModel=void 0;const n=r(s(8944)),l=s(9250),o=r(s(1961));class d extends l.MarkModel{defaults(){return Object.assign(Object.assign({},l.MarkModel.prototype.defaults()),{_model_name:"HistModel",_view_name:"Hist",sample:[],count:[],scales_metadata:{sample:{orientation:"horizontal",dimension:"x"},count:{orientation:"vertical",dimension:"y"}},bins:10,midpoints:[],colors:["steelblue"],stroke:null,opacities:[],normalized:!1})}initialize(e,t){super.initialize(e,t),this.mark_data=[],this.on_some_change(["bins","sample","preserve_domain"],this.update_data,this),this.update_data(),this.on("change:normalized",(function(){this.normalize_data(!0)}),this),this.normalize_data(!0)}update_data(){let e=this.get("sample");const t=this.get("scales").sample;if(this.num_bins=this.get("bins"),0==e.length)this.mark_data=[],this.x_mid=[],this.count=[],this.x_bins=[];else{this.get("preserve_domain").sample?t.del_domain([],this.model_id+"_sample"):t.compute_and_set_domain(e,this.model_id+"_sample"),this.min_x=t.domain[0],this.max_x=t.domain[1];const s=this;e=e.filter((function(e){return e<=s.max_x&&e>=s.min_x}));const i=Array.prototype.map.call(e,(function(e,t){return{index:t,value:e}}));this.x_bins=n.range(this.min_x,this.max_x,(this.max_x-this.min_x)/this.num_bins),this.x_mid=this.x_bins.map((function(e,t){return.5*(e+s.x_bins[t-1])})).slice(1),this.mark_data=n.histogram().thresholds(this.x_bins).value((function(e){return e.value}))(i),this.mark_data.forEach((function(e,t){e.index=t}))}this.normalize_data(!1),this.set("midpoints",this.x_mid),this.set("count",new Float64Array(this.count)),this.update_domains(),this.save_changes(),this.trigger("data_updated")}normalize_data(e){if(this.count=this.mark_data.map((function(e){return e.length})),this.get("normalized")){let e=1;this.mark_data.length>0&&(e=this.mark_data[0].x1-this.mark_data[0].x0);const t=this.count.reduce((function(e,t){return e+t}),0);0!=t&&(this.count=this.count.map((function(s){return s/(t*e)})))}const t=this;this.mark_data.forEach((function(e,s){e.y=t.count[s]})),e&&(this.set("count",new Float64Array(this.count)),this.update_domains(),this.save_changes(),this.trigger("data_updated"))}get_data_dict(e,t){const s={};return s.midpoint=this.x_mid[t],s.bin_start=this.x_bins[t],s.bin_end=this.x_bins[t+1],s.index=t,s.count=this.count[t],s}update_domains(){if(!this.mark_data)return;const e=this.get("scales").count;this.get("preserve_domain").count||e.set_domain([0,1.05*n.max(this.mark_data,(function(e){return e.y}))],this.model_id+"_count")}}t.HistModel=d,d.serializers=Object.assign(Object.assign({},l.MarkModel.serializers),{sample:o.array_or_json,count:o.array_or_json})},6566:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Image=void 0;const n=r(s(8944)),l=s(3332),o=r(s(8731));class d extends l.Mark{render(){const e=super.render(),t=this.d3el||this.el;this.im=t.append("image").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("preserveAspectRatio","none").classed("image_pixelated",this.model.get("pixelated")),this.update_image(),this.event_metadata={mouse_over:{msg_name:"hover",lookup_data:!1,hit_test:!0},legend_clicked:{msg_name:"legend_click",hit_test:!0},element_clicked:{msg_name:"element_click",lookup_data:!1,hit_test:!1},parent_clicked:{msg_name:"background_click",hit_test:!1}};const s=this;return e.then((function(){s.event_listeners={},s.reset_click(),s.create_listeners(),s.listenTo(s.parent,"margin_updated",(function(){s.draw(!1)}))}))}set_positional_scales(){const e=this.scales.x,t=this.scales.y;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.draw()})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw()}))}set_ranges(){const e=this.scales.x,t=this.scales.y;e&&e.set_range(this.parent.padded_range("x",e.model)),t&&t.set_range(this.parent.padded_range("y",t.model))}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:image",this.update_image),this.listenTo(this.model,"data_updated",(function(){this.draw(!0)})),this.listenTo(this.model,"change:pixelated",(()=>{this.im.classed("image_pixelated",this.model.get("pixelated"))}))}update_image(){this.im.attr("href")&&URL.revokeObjectURL(this.im.attr("href"));const e=this.model.get("image");if("url"===e.get("format")){const t=new TextDecoder("utf-8").decode(e.get("value"));this.im.attr("href",t)}else{const t=new Blob([e.get("value")],{type:"image/"+e.get("format")}),s=URL.createObjectURL(t);this.im.attr("href",s)}}remove(){URL.revokeObjectURL(this.im.attr("href")),super.remove()}relayout(){this.draw(!0)}img_send_message(e,t){const s=this.event_metadata[e],i={click_x:this.scales.x.invert(n.mouse(this.el)[0]),click_y:this.scales.y.invert(n.mouse(this.el)[1])};this.send({event:s.msg_name,data:i})}draw(e){this.set_ranges();const t=this.scales.x?this.scales.x:this.parent.scale_x,s=this.scales.y?this.scales.y:this.parent.scale_y,i=e?this.parent.model.get("animation_duration"):0,a=this.d3el||this.el,r=this.model.mark_data.x.map(t.scale),l=this.model.mark_data.y.map(s.scale);a.selectAll("image").transition().duration(i).attr("transform",(function(e){return"translate("+(r[0]+t.offset)+","+(l[1]+s.offset)+") scale("+(r[1]-r[0])+", "+(l[0]-l[1])+")"})),a.on("click",o.bind((function(e,t){this.img_send_message("element_clicked",{data:n.event,index:t})}),this))}clear_style(e,t,s){}compute_view_padding(){}set_default_style(e,t){}set_style_on_elements(e,t,s){}}t.Image=d},8137:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ImageModel=void 0;const n=r(s(5335)),l=s(9250),o=r(s(1961));class d extends l.MarkModel{defaults(){return Object.assign(Object.assign({},l.MarkModel.prototype.defaults()),{_model_name:"ImageModel",_view_name:"Image",pixelated:!1,x:[0,1],y:[0,1],scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"}}})}initialize(e,t){super.initialize(e,t),this.on_some_change(["x","y"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data()}update_data(){this.mark_data={x:this.get("x"),y:this.get("y")},this.update_domains(),this.trigger("data_updated")}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.x,s=e.y;t&&(this.get("preserve_domain").x?t.del_domain([],this.model_id+"_x"):t.compute_and_set_domain(this.mark_data.x,this.model_id+"_x")),s&&(this.get("preserve_domain").y?s.del_domain([],this.model_id+"_y"):s.compute_and_set_domain(this.mark_data.y,this.model_id+"_y"))}}t.ImageModel=d,d.serializers=Object.assign(Object.assign({},l.MarkModel.serializers),{image:{deserialize:n.unpack_models},x:o.array_or_json,y:o.array_or_json})},7829:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.IndexSelector=void 0;const n=r(s(8944)),l=r(s(8731)),o=s(3248);class d extends o.BaseXSelector{render(){super.render(),this.active=!1,this.dirty=!1;const e=this,t=this.create_scales();Promise.all([this.mark_views_promise,t]).then((function(){e.line=e.d3el.append("line").attr("class","selector indsel").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",e.height).attr("stroke-width",e.model.get("line_width")).attr("pointer-events","none").attr("visibility","hidden"),e.color_change(),e.background=e.d3el.append("rect").attr("x",0).attr("y",0).attr("width",e.width).attr("height",e.height).attr("class","selector selectormouse").attr("pointer-events","all").attr("visibility","hidden"),e.background.on("mousemove",l.bind(e.mousemove,e)).on("click",l.bind(e.initial_click,e)),e.create_listeners(),e.selected_changed()}))}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:color",this.color_change)}color_change(){null!==this.model.get("color")&&this.line.style("stroke",this.model.get("color"))}initial_click(){this.line.attr("visibility","visible"),this.click(),this.background.on("click",l.bind(this.click,this))}click(){this.active=!this.active}mousemove(){if(!this.active)return;this.dirty=!0;const e=n.mouse(this.background.node())[0];this.line.attr("x1",e).attr("x2",e),this.set_selected("selected",[this.invert_pixel(e)]),l.each(this.mark_views,(function(t){t.invert_point(e)})),this.touch(),this.dirty=!1}invert_pixel(e){return this.scale.invert(e)}reset(){this.active=!1,void 0!==this.line&&null!==this.line&&this.line.attr("x1",0).attr("x2",0).attr("visibility","hidden"),void 0!==this.background&&null!==this.background&&this.background.on("click",l.bind(this.initial_click,this)),this.model.set("selected",null),l.each(this.mark_views,(function(e){e.invert_point()})),this.touch()}update_scale_domain(e){super.update_scale_domain(),!0!==e&&this.selected_changed()}selected_changed(){if(this.dirty)return;const e=this.model.get("selected")||[];if(0===e.length)this.reset();else{if(1!=e.length)return;{const t=this.scale.scale(e[0]);void 0!==this.line&&null!==this.line&&this.line.attr("x1",0).attr("x2",0).attr("visibility","visible"),this.background.on("click",l.bind(this.click,this)),l.each(this.mark_views,(function(e){e.invert_point(t)}))}}}relayout(){super.relayout(),this.line.attr("y1",0).attr("y2",this.height),this.background.attr("width",this.width).attr("height",this.height),this.set_range([this.scale])}set_range(e){for(let t=0;t<e.length;t++)e[t].set_range([0,this.width])}}t.IndexSelector=d},5237:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Interaction=void 0;const n=r(s(5335)),l=r(s(8944)),o=r(s(8731));class d extends n.WidgetView{initialize(e){this.setElement(document.createElementNS(l.namespaces.svg,"rect")),this.d3el=l.select(this.el),super.initialize.call(this,e)}render(){this.parent=this.options.parent,this.d3el.attr("x",0).attr("y",0).attr("width",this.parent.width-this.parent.margin.left-this.parent.margin.right).attr("height",this.parent.height-this.parent.margin.top-this.parent.margin.bottom).attr("pointer-events","all").attr("visibility","hidden"),this.listenTo(this.parent,"margin_updated",this.relayout)}relayout(){this.d3el.attr("width",this.parent.width-this.parent.margin.left-this.parent.margin.right).attr("height",this.parent.height-this.parent.margin.top-this.parent.margin.bottom)}remove(){o.each(this.mark_views,(function(e){e.invert_range()})),this.d3el.remove(),super.remove.apply(this)}}t.Interaction=d},3239:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0;const n=r(s(8944)),l=s(461);class o extends l.ScatterBase{create_listeners(){super.create_listeners(),this.model.on_some_change(["font_weight","default_size","colors","align","font_unit"],this.update_style,this),this.model.on_some_change(["x","y","x_offset","y_offset","rotate_angle"],this.update_position,this)}update_opacities(e){if(!this.model.dirty){const t=!0===e?this.parent.model.get("animation_duration"):0,s=this;this.d3el.selectAll(".label").transition("update_opacities").duration(t).style("opacity",(function(e,t){return s.get_element_opacity(e,t)}))}}update_default_size(e){if(this.compute_view_padding(),!this.model.dirty){const t=!0===e?this.parent.model.get("animation_duration"):0,s=this;this.d3el.selectAll(".label").transition("update_default_size").duration(t).style("font-size",(function(e,t){return s.get_element_size(e)}))}}relayout(){this.set_ranges(),this.update_position()}draw_elements(e,t){t.append("text").classed("label element",!0),this.update_text(),this.update_style(),this.update_opacities(!0)}update_text(){this.d3el.selectAll(".object_grp").select(".label").text((function(e){return e.text}))}get_element_size(e){const t=this.scales.size,s=this.model.get("font_unit");return t&&void 0!==e.size?t.scale(e.size)+s:this.model.get("default_size")+s}get_element_rotation(e){const t=this.scales.rotation;return t&&e.rotation?"rotate("+t.scale(e.rotation)+")":"rotate("+this.model.get("rotate_angle")+")"}update_position(){const e=this,t=this.x_scale,s=this.y_scale,i=this.model.get("x_offset"),a=this.model.get("y_offset");this.d3el.selectAll(".object_grp").attr("transform",(function(r){return"translate("+(t.scale(r.x)+t.offset+i)+","+(s.scale(r.y)+s.offset+a)+")"+e.get_element_rotation(r)}))}update_style(){const e=this;this.d3el.selectAll(".object_grp").select("text").attr("dominant-baseline","central").style("font-size",(function(t,s){return e.get_element_size(t)})).style("font-weight",this.model.get("font_weight")).style("text-anchor",this.model.get("align")),this.d3el.selectAll(".label").style("fill",this.get_mark_color.bind(this))}color_scale_updated(e){const t=!0===e?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").select("text").transition("color_scale_updated").duration(t).style("fill",this.get_mark_color.bind(this))}set_default_style(e){if(!e||0===e.length)return;const t=this.d3el.selectAll(".element").filter((function(t,s){return-1!==e.indexOf(s)})),s=this;t.style("font-size",(function(e,t){return s.get_element_size(e)})).style("font-weight",this.model.get("font_weight")).style("text-anchor",this.model.get("align")).style("fill",this.get_mark_color.bind(this))}set_drag_style(e,t,s){const i=this.model.get("drag_size")*this.model.get("default_size")+this.model.get("font_unit");n.select(s).select("text").classed("drag_label",!0).transition("set_drag_style").style("font-size",i)}reset_drag_style(e,t,s){n.select(s).select("text").classed("drag_label",!1).transition("reset_drag_style").style("font-size",this.get_element_size(e))}update_default_skew(){}}t.Label=o},9461:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelModel=void 0;const n=r(s(8944)),l=s(6850),o=r(s(1961));class d extends l.ScatterBaseModel{defaults(){return Object.assign(Object.assign({},l.ScatterBaseModel.prototype.defaults()),{_model_name:"LabelModel",_view_name:"Label",x_offset:0,y_offset:0,colors:n.scaleOrdinal(n.schemeCategory10).range(),rotate_angle:0,text:null,default_size:16,drag_size:1,font_unit:"px",font_weight:"bold",align:"start"})}initialize(e,t){super.initialize(e,t),this.on("change:text",this.update_data,this)}update_mark_data(){super.update_mark_data();const e=this.get("text");this.mark_data.forEach((function(t,s){t.text=e[s]}))}update_unique_ids(){this.mark_data.forEach((function(e,t){e.unique_id="Label"+t}))}}t.LabelModel=d,d.serializers=Object.assign(Object.assign({},l.ScatterBaseModel.serializers),{text:o.array_or_json})},1389:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LassoSelector=void 0;const n=r(s(8944)),l=function(){return s(8556).B}.bind(this),o=r(s(8731)),d=s(3248),c=r(s(8882));class h extends d.BaseXYSelector{render(){super.render();const e=this.create_scales();this.line=n.line(),this.all_vertices={},this.lasso_counter=0;const t=this;Promise.all([this.mark_views_promise,e]).then((()=>{const e=n.drag().on("start",(function(){t.drag_start()})).on("drag",(function(){t.drag_move()})).on("end",(function(){t.drag_end()}));n.select(window).on("keydown",(()=>{this.keydown()})),t.d3el.attr("class","lassoselector"),t.background=t.d3el.append("rect").attr("x",0).attr("y",0).attr("width",t.width).attr("height",t.height).attr("visibility","hidden").attr("pointer-events","all").style("cursor","crosshair").call(e),t.create_listeners()}))}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:color",this.change_color)}change_color(e,t){t&&this.d3el.selectAll("path").style("stroke",t)}create_new_lasso(){const e=this.d3el.append("path").attr("id","l"+ ++this.lasso_counter).on("click",(function(){const e=n.select(this);e.classed("selected",!e.classed("selected"))})),t=this.model.get("color");t&&e.style("stroke",t)}drag_start(){this.current_vertices=[],this.create_new_lasso()}drag_move(){this.current_vertices.push(n.mouse(this.background.node())),this.d3el.select("#l"+this.lasso_counter).attr("d",this.line(this.current_vertices))}drag_end(){const e="l"+this.lasso_counter;this.d3el.select("#"+e).attr("d",this.line(this.current_vertices)+"Z"),this.all_vertices[e]=this.current_vertices,this.update_mark_selected(this.all_vertices)}update_mark_selected(e){void 0!==e&&0!==e.length||o.each(this.mark_views,(function(e){return e.selector_changed()}));const t=function(t){for(let s in e)if(c.point_in_lasso(t,e[s]))return!0;return!1},s=function(t){for(let s in e)if(c.lasso_inter_rect(t[0],t[1],e[s]))return!0;return!1};o.each(this.mark_views,(function(e){e.selector_changed(t,s)}),this)}relayout(){super.relayout(),this.background.attr("width",this.width).attr("height",this.height)}keydown(){if(46===l().keyCode){const e=this.d3el.selectAll(".selected"),t=this.all_vertices;e.each((function(){const e=n.select(this).attr("id");delete t[e]})),e.remove(),this.update_mark_selected(this.all_vertices)}}reset(){this.lasso_counter=0,this.all_vertices={},this.d3el.selectAll("path").remove(),this.update_mark_selected()}selected_changed(){}}t.LassoSelector=h},2205:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LinearScale=void 0;const n=r(s(8463)),l=s(8980);class o extends l.Scale{render(){this.scale=n.scaleLinear(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()}expand_domain(e,t){const s=this.scale.copy();s.clamp(!1),this.model.domain.length?s.domain(this.model.domain):console.error("No domain exists for scale, is that any data associated with this scale?"),s.range(e),this.scale.domain(t.map((function(e){return s.invert(e)})))}invert(e){return this.scale.invert(e)}invert_range(e){return e.map((e=>this.invert(e)))}}t.LinearScale=o},4060:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LinearScaleModel=void 0;const n=r(s(8731)),l=r(s(8944)),o=s(6370);class d extends o.ScaleModel{defaults(){return Object.assign(Object.assign({},o.ScaleModel.prototype.defaults()),{_model_name:"LinearScaleModel",_view_name:"LinearScale",min:null,max:null,min_range:.6,mid_range:.8})}typedRange(e){return new Float64Array(e.map(Number))}set_init_state(){this.type="linear",this.global_min=Number.NEGATIVE_INFINITY,this.global_max=Number.POSITIVE_INFINITY}set_listeners(){this.on("change:reverse",this.reverse_changed,this),this.reverse_changed(void 0,void 0,void 0),this.on_some_change(["min","max"],this.min_max_changed,this),this.min_max_changed(),this.on_some_change(["min_range","mid_range","stabilized"],this.update_domain,this)}min_max_changed(){this.min=this.get("min"),this.max=this.get("max"),this.min_from_data=null===this.min,this.max_from_data=null===this.max,this.update_domain()}reverse_changed(e,t,s){const i=void 0!==e&&e.previous("reverse");this.reverse=this.get("reverse");const a=(i+this.reverse)%2;this.domain.length>0&&1===a&&(this.domain.reverse(),this.trigger("domain_changed",this.domain))}update_domain(){const e=this,t=this.min_from_data?l.min(n.map(this.domains,(function(t){return t.length>0?t[0]:e.global_max}))):this.min,s=this.max_from_data?l.max(n.map(this.domains,(function(t){return t.length>1?t[1]:e.global_min}))):this.max,i=.5*(t+s),a=.5*(s-t)/this.get("mid_range"),r=this.domain,o=this.reverse?1:0,d=r[o],c=r[1-o],h=.5*(c+d),_=.5*(c-d)*this.get("min_range"),u=this.get("stabilized");if(u?!(t>=d&&t<=h-_&&s<=c&&s>=h+_):t!==d||s!==c){const e=u?i-a:t,r=u?i+a:s;this.domain=this.reverse?[r,e]:[e,r],this.trigger("domain_changed",this.domain)}}compute_and_set_domain(e,t){if(!e||0===e.length)return void this.set_domain([],t);const s=e[0]instanceof Array?e:[e],i=l.min(s.map((function(e){return l.min(e)}))),a=l.max(s.map((function(e){return l.max(e)})));this.set_domain([i,a],t)}}t.LinearScaleModel=d},9233:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Lines=void 0;const n=r(s(8731)),l=r(s(8944)),o=s(3332),d=r(s(3731)).symbol;class c extends o.Mark{render(){const e=super.render();return this.dot=d().size(this.model.get("marker_size")),this.model.get("marker")&&this.dot.type(this.model.get("marker")),this.displayed.then((()=>{this.parent.tooltip_div.node().appendChild(this.tooltip_div.node()),this.create_tooltip()})),this.display_el_classes=["line","legendtext","dot"],e.then((()=>{this.event_listeners={},this.process_interactions(),this.create_listeners(),this.compute_view_padding(),this.draw(!1)}))}set_ranges(){const e=this.scales.x;e&&e.set_range(this.parent.padded_range("x",e.model));const t=this.scales.y;t&&t.set_range(this.parent.padded_range("y",t.model))}set_positional_scales(){const e=this.scales.x,t=this.scales.y;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.update_line_xy()})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.update_line_xy()}))}initialize_additional_scales(){const e=this.scales.color;e&&(this.listenTo(e,"domain_changed",(function(){this.update_style()})),e.on("color_scale_range_changed",this.update_style,this))}create_listeners(){super.create_listeners(),this.d3el.on("mouseover",n.bind((function(){this.event_dispatcher("mouse_over")}),this)).on("mousemove",n.bind((function(){this.event_dispatcher("mouse_move")}),this)).on("mouseout",n.bind((function(){this.event_dispatcher("mouse_out")}),this)),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.listenTo(this.model,"change:interpolation",this.update_path_style),this.listenTo(this.model,"change:close_path",this.update_path_style),this.listenTo(this.model,"change:colors",this.update_style),this.listenTo(this.model,"change:opacities",this.update_style),this.listenTo(this.model,"change:fill_opacities",this.update_style),this.listenTo(this.model,"change:fill_colors",this.update_style),this.listenTo(this.model,"change:fill",this.update_fill),this.listenTo(this.model,"data_updated",(function(){this.draw(!0)})),this.listenTo(this.model,"labels_updated",this.update_labels),this.listenTo(this.model,"change:stroke_width",this.update_stroke_width),this.listenTo(this.model,"change:labels_visibility",this.update_legend_labels),this.listenTo(this.model,"change:curves_subset",this.update_curves_subset),this.listenTo(this.model,"change:line_style",this.update_line_style),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")})),this.listenTo(this.model,"change:marker",this.update_marker),this.listenTo(this.model,"change:marker_size",this.update_marker_size)}update_legend_labels(){"none"===this.model.get("labels_visibility")?(this.d3el.selectAll(".legend").attr("display","none"),this.d3el.selectAll(".curve_label").attr("display","none")):"label"===this.model.get("labels_visibility")?(this.d3el.selectAll(".legend").attr("display","none"),this.d3el.selectAll(".curve_label").attr("display","inline")):(this.d3el.selectAll(".legend").attr("display","inline"),this.d3el.selectAll(".curve_label").attr("display","none"))}update_labels(){this.d3el.selectAll(".curve").data(this.model.mark_data).select(".curve_label").text((function(e){return e.name}))}get_line_style(){switch(this.model.get("line_style")){case"solid":return"none";case"dashed":return"10,10";case"dotted":return"2,10";case"dash_dotted":return"10,5,2,5"}}update_line_style(){this.d3el.selectAll(".curve").select(".line").style("stroke-dasharray",n.bind(this.get_line_style,this)),this.legend_el&&this.legend_el.select("path").style("stroke-dasharray",n.bind(this.get_line_style,this))}update_stroke_width(e,t){this.compute_view_padding(),this.d3el.selectAll(".curve").select(".line").style("stroke-width",t),this.legend_el&&this.legend_el.select("path").style("stroke-width",t)}update_style(){const e=this,t=this.model.get("fill"),s=this.model.get("fill_colors"),i=this.model.get("fill_opacities"),a=this.d3el.selectAll(".curve");a.select(".line").style("opacity",this.get_mark_opacity.bind(this)).style("stroke",(function(t,i){return e.get_mark_color(t,i)||s[i]})).style("fill",(function(s,i){return"inside"===t?e.get_fill_color(s,i):""})).style("fill-opacity",(function(e,s){return"inside"===t?i[s]:""})),a.select(".area").style("fill",(function(t,s){return e.get_fill_color(t,s)})).style("opacity",(function(e,t){return i[t]})),this.update_marker_style(),this.legend_el&&(this.legend_el.select(".line").style("stroke",(function(t,i){return e.get_mark_color(t,i)||s[i]})).style("opacity",this.get_mark_opacity.bind(this)).style("fill",(function(t,s){return"none"===e.model.get("fill")?"":e.get_fill_color(t,s)})),this.legend_el.select(".dot").style("stroke",(function(t,i){return e.get_mark_color(t,i)||s[i]})).style("opacity",this.get_mark_opacity.bind(this)).style("fill",(function(t,i){return e.get_mark_color(t,i)||s[i]})),this.legend_el.select("text").style("fill",(function(t,i){return e.get_mark_color(t,i)||s[i]})).style("opacity",this.get_mark_opacity.bind(this))),this.update_stroke_width(this.model,this.model.get("stroke_width")),this.update_line_style()}path_closure(){return this.model.get("close_path")?"Z":""}update_path_style(){const e=this.get_interpolation();this.line.curve(e),this.area.curve(e);const t=this;this.d3el.selectAll(".curve").select(".line").attr("d",(function(e){return t.line(e.values)+t.path_closure()})),this.d3el.selectAll(".curve").select(".area").transition("update_path_style").duration(0).attr("d",(function(e){return t.area(e.values)})),this.legend_el&&(this.legend_line.curve(e),this.legend_el.selectAll("path").attr("d",this.legend_line(this.legend_path_data)+this.path_closure()))}relayout(){this.set_ranges(),this.update_line_xy(!1)}selector_changed(e,t){if(void 0===e)return this.model.set("selected",null),this.touch(),[];const s=this.pixel_coords,i=new Uint32Array(n.range(s.length)).filter((t=>e(s[t])));this.model.set("selected",i),this.touch()}invert_point(e){if(void 0===e)return this.model.set("selected",null),void this.touch();const t=Math.min(this.bisect(this.x_pixels,e),Math.max(this.x_pixels.length-1,0));this.model.set("selected",new Uint32Array([t])),this.touch()}update_multi_range(e){const t=e[0],s=e[1],i=this.model.x_data[0]instanceof Array?this.model.x_data[0]:this.model.x_data,a=this.bisect(i,t),r=Math.min(this.bisect(i,s),Math.max(i.length-1,0));this.selector_model.set("selected",[a,r]),this.selector.touch()}draw_legend(e,t,s,i,a){const r=this.model.get_labels(),o=this.model.mark_data.map((function(e){return{index:e.index,name:e.name,color:e.color}}));this.legend_el=e.selectAll(".legend"+this.uuid).data(o);const d=this,c=.8*a,h=this.model.get("fill_colors");this.legend_line=l.line().curve(this.get_interpolation()).x((function(e){return e[0]})).y((function(e){return e[1]})),this.legend_path_data=[[0,c],[c/2,0],[c,c/2]];const _=this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",(function(e,t){return"translate(0, "+(t*a+s)+")"})).on("mouseover",n.bind((function(){this.event_dispatcher("legend_mouse_over")}),this)).on("mouseout",n.bind((function(){this.event_dispatcher("legend_mouse_out")}),this)).on("click",n.bind((function(){this.event_dispatcher("legend_clicked")}),this));_.append("path").attr("class","line").attr("fill","none").attr("d",this.legend_line(this.legend_path_data)+this.path_closure()).style("stroke",(function(e,t){return d.get_mark_color(e,t)||h[t]})).style("fill",(function(e,t){return"none"===d.model.get("fill")?"":d.get_fill_color(e,t)})).style("opacity",this.get_mark_opacity.bind(this)).style("stroke-width",this.model.get("stroke_width")).style("stroke-dasharray",n.bind(this.get_line_style,this)),this.model.get("marker")&&_.append("path").attr("class","dot").attr("transform","translate("+c/2+",0)").attr("d",d.dot.size(25)).style("fill",(function(e,t){return d.get_mark_color(e,t)})),_.append("text").attr("class","legendtext").attr("x",1.2*c).attr("y",c/2).attr("dy","0.35em").text((function(e,t){return r[t]})).style("fill",(function(e,t){return d.get_mark_color(e,t)||h[t]})).style("opacity",this.get_mark_opacity.bind(this)),this.legend_el=_.merge(this.legend_el);const u=l.max(r,(function(e){return e.length}));return this.legend_el.exit().remove(),[this.model.mark_data.length,u]}update_curves_subset(){const e="label"===this.model.get("labels_visibility"),t=this.model.get("curves_subset");t.length>0?(this.d3el.selectAll(".curve").attr("display",(function(e,s){return-1!==t.indexOf(s)?"inline":"none"})).select(".curve_label").attr("display",(function(s,i){return-1!==t.indexOf(i)&&e?"inline":"none"})),this.legend_el&&this.legend_el.attr("display",(function(e,s){return-1!==t.indexOf(s)?"inline":"none"})),this.d3el.selectAll(".curve")):(this.d3el.selectAll(".curve").attr("display","inline").select(".curve_label").attr("display",(function(t){return e?"inline":"none"})),this.legend_el&&this.legend_el.attr("display","inline"))}update_fill(){const e=this.model.get("fill"),t="top"===e||"bottom"===e||"between"===e,s=this.scales.y;this.area.defined((function(e){return t&&null!==e.y&&isFinite(s.scale(e.y))})),"bottom"==e?this.area.y0(this.parent.plotarea_height):"top"==e?this.area.y0(0):"between"==e&&this.area.y0((function(e){return s.scale(e.y0)+s.offset}));const i=this;this.d3el.selectAll(".curve").select(".area").attr("d",(function(e){return i.area(e.values)})),this.d3el.selectAll(".curve").select(".line").style("fill",(function(t,s){return"inside"===e?i.get_fill_color(t,s):""})),this.legend_el&&this.legend_el.select("path").style("fill",(function(t,s){return"none"===e?"":i.get_fill_color(t,s)}))}get_fill_color(e,t){const s=this.model.get("fill_colors");return 0===s.length?this.get_mark_color(e,t):s[t]}update_line_xy(e){const t=this.scales.x,s=this.scales.y,i=!0===e?this.parent.model.get("animation_duration"):0;this.line.x((function(e){return t.scale(e.x)+t.offset})).y((function(e){return s.scale(e.y)+s.offset}));const a=this.model.get("fill");this.area.x((function(e){return t.scale(e.x)+t.offset})).y1((function(e){return s.scale(e.y)+s.offset})),"bottom"==a?this.area.y0(this.parent.plotarea_height):"top"==a?this.area.y0(0):"between"==a&&this.area.y0((function(e){return s.scale(e.y0)+s.offset}));const r=this,n=this.d3el.selectAll(".curve");n.select(".line").transition("update_line_xy").attr("d",(function(e){return r.line(e.values)+r.path_closure()})).duration(i),n.select(".area").transition("update_line_xy").attr("d",(function(e,t){return r.area(e.values)})).duration(i),n.select(".curve_label").transition("update_line_xy").attr("transform",(function(e){const i=e.values[e.values.length-1];return"translate("+t.scale(i.x)+","+s.scale(i.y)+")"})).duration(i),this.update_dots_xy(e),this.x_pixels=this.model.mark_data.length>0?this.model.mark_data[0].values.map((function(e){return t.scale(e.x)+t.offset})):[],this.y_pixels=this.model.mark_data.length>0?this.model.mark_data[0].values.map((function(e){return s.scale(e.y)+s.offset})):[],this.pixel_coords=this.model.mark_data.length>0?this.model.mark_data[0].values.map((function(e){return[t.scale(e.x)+t.offset,s.scale(e.y)+s.offset]})):[]}get_interpolation(){return{linear:l.curveLinear,basis:l.curveBasis,cardinal:l.curveCardinal,monotone:l.curveMonotoneY}[this.model.get("interpolation")]}draw(e){this.set_ranges();const t=this.d3el.selectAll(".curve").data(this.model.mark_data),s=this.scales.y,i=t.enter().append("g").attr("class","curve");i.append("path").attr("class","line").attr("fill","none").attr("id",((e,t)=>"curve"+(t+1))).on("click",(()=>{this.event_dispatcher("element_clicked")})),i.append("path").attr("class","area"),i.append("text").attr("class","curve_label").attr("x",3).attr("dy",".35em").attr("display","label"!==this.model.get("labels_visibility")?"none":"inline").text((e=>e.name));const a=this.model.get("fill"),r="top"===a||"bottom"===a||"between"===a;this.draw_dots(),this.line=l.line().curve(this.get_interpolation()).defined((function(e){return null!==e.y&&isFinite(s.scale(e.y))})),this.area=l.area().curve(this.get_interpolation()).defined((function(e){return r&&null!==e.y&&isFinite(s.scale(e.y))})),t.exit().remove(),this.update_line_xy(e),this.update_style(),this.update_curves_subset()}draw_dots(){if(this.model.get("marker")){const e=this.d3el.selectAll(".curve").selectAll(".dot").data((function(e,t){return e.values.map((function(e){return{x:e.x,y:e.y,sub_index:e.sub_index}}))}));e.enter().append("path").attr("class","dot"),e.exit().remove()}}update_dots_xy(e){if(this.model.get("marker")){const t=this.scales.x,s=this.scales.y,i=!0===e?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".curve").selectAll(".dot").transition("update_dots_xy").duration(i).attr("transform",(function(e){return"translate("+(t.scale(e.x)+t.offset)+","+(s.scale(e.y)+s.offset)+")"})).attr("d",this.dot.size(this.model.get("marker_size")).type(this.model.get("marker")))}}compute_view_padding(){let e;if(this.model.get("marker")){const t=Math.sqrt(this.model.get("marker_size"))/2+1,s=this.model.get("stroke_width")/2;e=Math.max(t,s)}else e=this.model.get("stroke_width")/2;const t=e;e===this.x_padding&&t===this.y_padding||(this.x_padding=e,this.y_padding=t,this.trigger("mark_padding_updated"))}update_marker_style(){const e=this,t=this.model.get("fill_colors"),s=this.model.get("opacities");this.d3el.selectAll(".curve").each((function(i,a){l.select(this).selectAll(".dot").style("opacity",s[a]).style("fill",e.get_mark_color(i,a)||t[a])}))}update_marker(e,t){t?(this.draw_dots(),this.update_dots_xy(!1),this.update_marker_style(),this.legend_el&&this.legend_el.select(".dot").attr("d",this.dot.type(t).size(25))):(this.d3el.selectAll(".dot").remove(),this.legend_el&&this.legend_el.select(".dot").attr("d",this.dot.size(0)))}update_marker_size(e,t){this.compute_view_padding(),this.d3el.selectAll(".dot").attr("d",this.dot.size(t))}clear_style(e,t){}set_default_style(e){}set_style_on_elements(e,t){}}t.Lines=c},8294:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FlexLineModel=t.LinesModel=void 0;const n=r(s(8944)),l=r(s(8731)),o=s(9250),d=r(s(1961)),c=r(s(6988));class h extends o.MarkModel{defaults(){return Object.assign(Object.assign({},o.MarkModel.prototype.defaults()),{_model_name:"LinesModel",_view_name:"Lines",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},colors:n.scaleOrdinal(n.schemeCategory10).range(),fill_colors:n.scaleOrdinal(n.schemeCategory10).range(),stroke_width:2,labels_visibility:"none",curves_subset:[],line_style:"solid",interpolation:"linear",close_path:!1,fill:"none",marker:null,marker_size:64,opacities:[],fill_opacities:[]})}initialize(e,t){super.initialize(e,t),this.on_some_change(["x","y","color"],this.update_data,this),this.on("change:labels",this.update_labels,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_domains()}update_data(){this.dirty=!0;const e=this;this.x_data=this.get("x"),this.y_data=this.get("y"),this.color_data=this.get("color")||[];let t=this.get("labels");if(0===this.x_data.length||0===this.y_data.length)this.mark_data=[];else{this.x_data=c.is_array(this.x_data[0])?this.x_data:[this.x_data],this.y_data=c.is_array(this.y_data[0])?this.y_data:[this.y_data],t=this.get_labels();const s=this.y_data.length;1==this.x_data.length&&s>1?this.mark_data=t.map((function(t,i){return{name:t,values:Array.prototype.map.call(e.y_data[i],(function(t,a){return{x:e.x_data[0][a],y:t,y0:e.y_data[Math.min(i+1,s-1)][a],sub_index:a}})),color:e.color_data[i],index:i}})):this.mark_data=t.map((function(t,i){return{name:t,values:n.zip(e.x_data[i],e.y_data[i]).map((function(t,a){return{x:t[0],y:t[1],y0:e.y_data[Math.min(i+1,s-1)][a],sub_index:a}})),color:e.color_data[i],index:i}}))}this.update_domains(),this.dirty=!1,this.trigger("data_updated")}update_labels(){const e=this.get_labels();this.mark_data.forEach((function(t,s){t.name=e[s]})),this.trigger("labels_updated")}get_labels(){let e=this.get("labels");const t=1==this.x_data.length?this.y_data.length:Math.min(this.x_data.length,this.y_data.length);return e.length>t?e=e.slice(0,t):e.length<t&&l.range(e.length,t).forEach((function(t){e[t]="C"+(t+1)})),e}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.x,s=e.y,i=e.color;this.get("preserve_domain").x?t.del_domain([],this.model_id+"_x"):t.compute_and_set_domain(this.mark_data.map((function(e){return e.values.map((function(e){return e.x}))})),this.model_id+"_x"),this.get("preserve_domain").y?s.del_domain([],this.model_id+"_y"):s.compute_and_set_domain(this.mark_data.map((function(e){return e.values.map((function(e){return e.y}))})),this.model_id+"_y"),null!=i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(this.mark_data.map((function(e){return e.color})),this.model_id+"_color"))}get_data_dict(e,t){return e}}t.LinesModel=h,h.serializers=Object.assign(Object.assign({},o.MarkModel.serializers),{x:d.array_or_json,y:d.array_or_json,color:d.array_or_json});class _ extends h{defaults(){return Object.assign(Object.assign({},h.prototype.defaults()),{_model_name:"FlexLineModel",_view_name:"FlexLine",x:[],y:[],color:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"}},colors:n.scaleOrdinal(n.schemeCategory10).range(),fill_colors:n.scaleOrdinal(n.schemeCategory10).range(),stroke_width:2,labels_visibility:"none",curves_subset:[],line_style:"solid",interpolation:"linear",close_path:!1,fill:"none",marker:null,marker_size:64,opacities:[],fill_opacities:[]})}update_data(){this.dirty=!0;const e=this;this.x_data=this.get("x"),this.y_data=this.get("y");let t=this.get("labels");if(0===this.x_data.length||0===this.y_data.length)this.mark_data=[],this.data_len=0;else{this.x_data=l.isNumber(this.x_data[0])?[this.x_data]:this.x_data,this.y_data=l.isNumber(this.y_data[0])?[this.y_data]:this.y_data,t=this.get_labels();const s=this.get("color")||[],i=[this.get("width")||[]];this.data_len=Math.min(this.x_data[0].length,this.y_data[0].length),this.mark_data=[{name:t[0],values:l.range(this.data_len-1).map((function(t,a){return{x1:e.x_data[0][a],y1:e.y_data[0][a],x2:e.x_data[0][a+1],y2:e.y_data[0][a+1],color:s[a],size:i[0][a]}}))}]}this.update_domains(),this.dirty=!1,this.trigger("data_updated")}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.x,s=e.y,i=e.color,a=e.width;this.get("preserve_domain").x?t.del_domain([],this.model_id+"_x"):t.compute_and_set_domain(this.x_data[0].slice(0,this.data_len),this.model_id+"_x"),this.get("preserve_domain").y?s.del_domain([],this.model_id+"_y"):s.compute_and_set_domain(this.y_data[0].slice(0,this.data_len),this.model_id+"_y"),null!=i&&(this.get("preserve_domain").color?i.del_domain([],this.model_id+"_color"):i.compute_and_set_domain(this.mark_data.map((function(e){return e.values.map((function(e){return e.color}))})),this.model_id+"_color")),null!=a&&(this.get("preserve_domain").width?a.del_domain([],this.model_id+"_width"):a.compute_and_set_domain(this.mark_data.map((function(e){return e.values.map((function(e){return e.size}))})),this.model_id+"_width"))}}t.FlexLineModel=_,_.serializers=Object.assign(Object.assign({},h.serializers),{width:d.array_or_json})},7676:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LogScale=void 0;const n=r(s(8944)),l=s(2205);class o extends l.LinearScale{render(){this.scale=n.scaleLog(),this.model.domain.length>0&&this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()}}t.LogScale=o},9761:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogScaleModel=void 0;const i=s(4060);class a extends i.LinearScaleModel{defaults(){return Object.assign(Object.assign({},i.LinearScaleModel.prototype.defaults()),{_model_name:"LogScaleModel",_view_name:"LogScale",domain:[]})}set_init_state(){this.type="log",this.global_min=Number.MIN_VALUE,this.global_max=Number.POSITIVE_INFINITY}}t.LogScaleModel=a},6489:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Map=void 0;const n=r(s(5335)),l=r(s(8944)),o=()=>s(8556).B,d=s(3332);class c extends d.Mark{render(){const e=super.render();return this.map=this.d3el.append("svg").attr("viewBox","0 0 1200 980"),this.width=this.parent.plotarea_width,this.height=this.parent.plotarea_height,this.map_id=n.uuid(),this.enable_hover=this.model.get("enable_hover"),this.display_el_classes=["event_layer"],this.displayed.then((()=>{this.parent.tooltip_div.node().appendChild(this.tooltip_div.node()),this.create_tooltip()})),e.then((()=>{this.event_listeners={},this.process_interactions(),this.create_listeners(),this.draw()}))}set_ranges(){}relayout(){}set_positional_scales(){const e=this.scales.projection;this.listenTo(e,"domain_changed",(()=>{this.model.dirty||this.draw()}))}initialize_additional_scales(){const e=this.scales.color;e&&(this.listenTo(e,"domain_changed",(()=>{this.update_style()})),e.on("color_scale_range_changed",this.update_style,this))}remove_map(){l.selectAll(".world_map.map"+this.map_id).remove()}draw(){this.set_ranges(),this.remove_map(),this.transformed_g=this.map.append("g").attr("class","world_map map"+this.map_id),this.fill_g=this.transformed_g.append("g"),this.highlight_g=this.transformed_g.append("g"),this.stroke_g=this.transformed_g.append("g");const e=this.scales.projection;this.fill_g.selectAll("path").data(this.model.geodata).enter().append("path").attr("d",e.path).style("fill",((e,t)=>this.fill_g_colorfill(e,t))),this.stroke_g.selectAll("path").data(this.model.geodata).enter().append("path").attr("class","event_layer").attr("d",e.path).style("fill-opacity",0).on("click",((e,t)=>this.event_dispatcher("element_clicked",{data:e,index:t}))),this.validate_color(this.model.get("stroke_color"))&&this.stroke_g.selectAll("path").style("stroke",this.model.get("stroke_color")),this.zoom=l.zoom().scaleExtent([1,8]).on("zoom",(()=>{this.zoomed(this)})),this.parent.bg_events.call(this.zoom),this.parent.bg_events.on("dblclick.zoom",null),this.parent.bg_events.on("dblclick",(()=>{this.reset_zoom(this)}))}validate_color(e){return""!==e}mouseover_handler(){if(!this.model.get("hover_highlight"))return;const e=l.select(o().target);if(this.is_hover_element(e)){const t=e.data()[0],s=this.model.get("selected")||[],i=Array.from(s),a=this.highlight_g.append((()=>e.node().cloneNode(!0)));a.classed("hovered",!0),a.classed("event_layer",!1),this.validate_color(this.model.get("hovered_styles").hovered_stroke)&&-1===i.indexOf(t.id)&&a.style("stroke",this.model.get("hovered_styles").hovered_stroke).style("stroke-width",this.model.get("hovered_styles").hovered_stroke_width),this.validate_color(this.model.get("hovered_styles").hovered_fill)&&-1===i.indexOf(t.id)&&a.style("fill-opacity",1).style("fill",(()=>this.model.get("hovered_styles").hovered_fill))}}mouseout_handler(){if(!this.model.get("hover_highlight"))return;const e=l.select(o().target);this.is_hover_element(e)&&(e.transition("mouseout_handler").style("fill",((e,t)=>this.fill_g_colorfill(e,t))).style("stroke",((e,t)=>this.hoverfill(e,t))),this.highlight_g.selectAll(".hovered").remove())}click_handler(){const e=l.select(o().target);if(this.is_hover_element(e)){const t=e.data()[0],s=this.model.get("selected")||[],i=Array.from(s),a=i.indexOf(t.id);if(a>-1){i.splice(a,1),e.transition("click_handler").style("fill-opacity",0),this.highlight_g.selectAll(".hovered").remove();const s="#c".concat(t.id.toString());l.select(s).remove()}else this.highlight_g.selectAll(".hovered").remove(),this.highlight_g.append((()=>e.node().cloneNode(!0))).attr("id","c"+t.id).classed("selected",!0).classed("event_layer",!1),this.validate_color(this.model.get("selected_styles").selected_fill)&&this.highlight_g.selectAll(".selected").style("fill-opacity",1).style("fill",this.model.get("selected_styles").selected_fill),this.validate_color(this.model.get("selected_styles").selected_stroke)&&this.highlight_g.selectAll(".selected").style("stroke",this.model.get("selected_styles").selected_stroke).style("stroke-width",this.model.get("selected_styles").selected_stroke_width),i.push(t.id),this.model.set("selected",i),this.touch();this.model.set("selected",0===i.length?null:i,{updated_view:this}),this.touch()}}reset_zoom(e){e.zoom.transform(e.parent.bg,l.zoomIdentity)}zoomed(e){const t=o().transform,s=e.height/3,i=2*e.width;t.x=Math.min(e.width/2*(t.k-1),Math.max(i/2*(1-t.k),t.x)),t.y=Math.min(e.height/2*(t.k-1)+this.height*t.k,Math.max(s/2*(1-t.k)-e.width*t.k,t.y)),e.transformed_g.style("stroke-width",1/t.k).attr("transform",t)}create_listeners(){this.d3el.on("mouseover",(()=>{this.event_dispatcher("mouse_over")})).on("mousemove",(()=>{this.event_dispatcher("mouse_move")})).on("mouseout",(()=>{this.event_dispatcher("mouse_out")})),this.listenTo(this.model,"data_updated",this.draw),this.listenTo(this.model,"change:color",this.update_style),this.listenTo(this.model,"change:stroke_color",this.change_stroke_color),this.listenTo(this.model,"change:colors",this.change_map_color),this.listenTo(this.model,"change:selected",this.change_selected),this.listenTo(this.model,"change:selected_styles",(()=>{this.change_selected_fill(),this.change_selected_stroke()})),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",(()=>{this.event_dispatcher("parent_clicked")}))}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler)}process_hover(e){super.process_hover(e),"tooltip"===e&&(this.event_listeners.mouse_over=()=>(this.mouseover_handler(),this.refresh_tooltip()),this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=()=>(this.mouseout_handler(),this.hide_tooltip()))}change_selected_fill(){this.validate_color(this.model.get("selected_styles").selected_fill)?this.highlight_g.selectAll(".selected").style("fill-opacity",1).style("fill",this.model.get("selected_styles").selected_fill):this.highlight_g.selectAll(".selected").style("fill-opacity",0)}change_selected_stroke(){this.validate_color(this.model.get("selected_styles").selected_stroke)?this.highlight_g.selectAll(".selected").style("stroke-width",this.model.get("selected_styles").selected_stroke_width).style("stroke",this.model.get("selected_styles").selected_stroke):this.highlight_g.selectAll(".selected").style("stroke-width",0)}change_selected(){this.highlight_g.selectAll("path").remove();const e=this.model.get("selected")||[],t=this.stroke_g.selectAll("path").data();this.stroke_g.selectAll("path").style("stroke",((e,t)=>this.hoverfill(e,t)));const s=this.stroke_g.selectAll("path");for(let i=0;i<t.length;i++)e.indexOf(t[i].id)>-1&&this.highlight_g.append((()=>s.nodes()[i].cloneNode(!0))).attr("id",t[i].id).style("fill-opacity",(()=>this.validate_color(this.model.get("selected_styles").selected_fill)?1:0)).style("fill",this.model.get("selected_styles").selected_fill).style("stroke-opacity",(()=>this.validate_color(this.model.get("selected_styles").selected_stroke)?1:0)).style("stroke",this.model.get("selected_styles").selected_stroke).style("stroke-width",this.model.get("selected_styles").selected_stroke_width).classed("selected",!0)}reset_selection(){this.model.set("selected",[]),this.touch(),this.highlight_g.selectAll(".selected").remove(),l.select(this.d3el.parentNode).selectAll("path").classed("selected",!1),l.select(this.d3el.parentNode).selectAll("path").classed("hovered",!1),this.stroke_g.selectAll("path").style("stroke",((e,t)=>this.hoverfill(e,t))),this.fill_g.selectAll("path").classed("selected",!1).style("fill",((e,t)=>this.fill_g_colorfill(e,t)))}change_stroke_color(){this.stroke_g.selectAll("path").style("stroke",this.model.get("stroke_color"))}change_map_color(){this.is_object_empty(this.model.get("color"))&&this.fill_g.selectAll("path").style("fill",((e,t)=>this.fill_g_colorfill(e,t)))}update_style(){const e=this.model.get("color");this.is_object_empty(e)||this.fill_g.selectAll("path").style("fill",((e,t)=>this.fill_g_colorfill(e,t)))}is_object_empty(e){return 0===Object.keys(e).length&&e.constructor===Object}hoverfill(e,t){return(this.model.get("selected")||[]).indexOf(e.id)>-1&&this.validate_color(this.model.get("selected_styles").selected_stroke)?this.model.get("selected_styles").selected_stroke:this.model.get("stroke_color")}fill_g_colorfill(e,t){const s=this.scales.color,i=this.model.get("selected")||[],a=this.model.get("color"),r=this.model.get("colors");return i.indexOf(e.id)>-1?this.model.get("selected_styles").selected_fill:this.is_object_empty(a)?r[e.id]||r.default_color:void 0===a[e.id]||null===a[e.id]||"nan"===a[e.id]||void 0===s?r.default_color:s.scale(a[e.id])}clear_style(){}compute_view_padding(){}set_default_style(){}set_style_on_elements(){}}t.Map=c},657:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MapModel=void 0;const n=s(9250),l=r(s(9363));class o extends n.MarkModel{defaults(){return Object.assign(Object.assign({},n.MarkModel.prototype.defaults()),{_model_name:"MapModel",_view_name:"Map",color:{},hover_highlight:!0,hovered_styles:{hovered_fill:"Orange",hovered_stroke:null,hovered_stroke_width:2},stroke_color:null,default_color:null,scales_metadata:{color:{dimension:"color"},projection:{dimension:"geo"}},selected_styles:{selected_fill:"Red",selected_stroke:null,selected_stroke_width:2},map_data:void 0})}initialize(e,t){super.initialize(e,t),this.on("change:map_data",this.update_data,this),this.on("change:color",this.color_data_updated,this),this.update_data(),this.update_domains()}update_data(){this.dirty=!0;const e=this.get("map_data");"Topology"==e.type?this.geodata=l.feature(e,e.objects.subunits).features:this.geodata=e.features,this.color_data_updated(),this.dirty=!1,this.trigger("data_updated")}update_properties(e){e.properties?e.properties.color=this.color_data[e.id]:e.properties={color:this.color_data[e.id]}}color_data_updated(){this.update_domains(),this.geodata.map((e=>this.update_properties(e)))}update_domains(){const e=this.get("scales").color;this.color_data=this.get("color"),null!=e&&(this.get("preserve_domain").color?e.del_domain([],this.model_id+"_color"):e.compute_and_set_domain(Object.keys(this.color_data).map((e=>this.color_data[e])),this.model_id+"_color"))}get_data_dict(e,t){return Object.assign(Object.assign({},e.properties),{id:e.id})}}t.MapModel=o},3332:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Mark=void 0;const n=r(s(5335)),l=r(s(8944));s(2802);const o=s(3211),d=s(6510),c=function(){return s(8556).B}.bind(this),h=r(s(8731));function _(e){return null!=e}class u extends n.WidgetView{initialize(){this.display_el_classes=["mark"],this.setElement(document.createElementNS(l.namespaces.svg,"g")),this.d3el=l.select(this.el),super.initialize.apply(this,arguments)}render(){this.x_padding=0,this.y_padding=0,this.parent=this.options.parent,this.uuid=n.uuid();const e=this.set_scale_views();return this.listenTo(this.model,"scales_updated",(()=>{this.set_scale_views().then(h.bind(this.draw,this))})),this.options.clip_id&&this.model.get("apply_clip")&&this.d3el.attr("clip-path","url(#"+this.options.clip_id+")"),this.tooltip_div=l.select(document.createElement("div")).attr("class","mark_tooltip").attr("id","tooltip_"+this.uuid).style("display","none").style("opacity",0),this.bisect=l.bisector((function(e){return e})).left,this.d3el.style("display",this.model.get("visible")?"inline":"none"),this.display_el_classes=[],this.event_metadata={mouse_over:{msg_name:"hover",lookup_data:!0,hit_test:!0},legend_clicked:{msg_name:"legend_click",hit_test:!0},element_clicked:{msg_name:"element_click",lookup_data:!0,hit_test:!0},parent_clicked:{msg_name:"background_click",hit_test:!1},legend_mouse_over:{msg_name:"legend_hover",hit_test:!0}},e}set_scale_views(){for(var e in this.scales)this.stopListening(this.scales[e]);const t=this.model.get("scales"),s=this,i={};return h.each(t,(function(e,t){i[t]=s.create_child_view(e)})),n.resolvePromisesDict(i).then((function(e){s.scales=e,s.set_positional_scales(),s.initialize_additional_scales(),s.set_ranges(),s.trigger("mark_scales_updated")}))}set_positional_scales(){}initialize_additional_scales(){}set_internal_scales(){}create_listeners(){this.listenTo(this.model,"change:visible",this.update_visibility),this.listenTo(this.model,"change:selected_style",this.selected_style_updated),this.listenTo(this.model,"change:unselected_style",this.unselected_style_updated),this.listenTo(this.parent,"margin_updated",this.relayout),this.model.on_some_change(["labels","display_legend"],(function(){this.model.trigger("redraw_legend")}),this)}remove(){this.model.off(null,null,this),this.d3el.transition("remove").duration(0).remove(),this.tooltip_div.remove(),super.remove()}draw_legend(e,t,s,i,a){return e.selectAll(".legend"+this.uuid).remove(),e.append("g").attr("transform","translate("+t+", "+s+")").attr("class","legend"+this.uuid).on("mouseover",h.bind(this.highlight_axes,this)).on("mouseout",h.bind(this.unhighlight_axes,this)).append("text").text(this.model.get("labels")[0]),[1,1]}highlight_axes(){h.each(this.model.get("scales"),(function(e){e.trigger("highlight_axis")}))}unhighlight_axes(){h.each(this.model.get("scales"),(function(e){e.trigger("unhighlight_axis")}))}invert_range(e,t){return[e,t]}invert_point(e){}invert_multi_range(e){return e}update_visibility(e,t){this.d3el.style("display",t?"inline":"none")}get_colors(e){const t=this.model.get("colors");return t[e%t.length]}get_mark_color(e,t){const s=this.scales.color;return s&&void 0!==e.color&&null!==e.color?s.scale(e.color):this.get_colors(t)}get_mark_opacity(e,t){const s=this.scales.opacity,i=this.model.get("opacities");return s&&void 0!==e.opacity&&null!==e.opacity?s.scale(e.opacity):i[t%i.length]}selected_style_updated(e,t){this.selected_style=t,this.clear_style(e.previous("selected_style"),this.selected_indices),this.style_updated(t,this.selected_indices)}unselected_style_updated(e,t){this.unselected_style=t;const s=this.selected_indices,i=s?h.range(this.model.mark_data.length).filter((function(e){return-1===s.indexOf(e)})):[];this.clear_style(e.previous("unselected_style"),i),this.style_updated(t,i)}style_updated(e,t,s){this.set_default_style(t),this.set_style_on_elements(e,t)}apply_styles(e){void 0!==e&&null!=e||(e=[this.selected_style,this.unselected_style]);const t=h.range(this.model.mark_data.length);for(var s=0;s<e.length;s++)this.clear_style(e[s]);this.set_default_style(t),this.set_style_on_elements(this.selected_style,Array.from(this.selected_indices||[]));const i=this.selected_indices?h.difference(t,Array.from(this.selected_indices)):[];this.set_style_on_elements(this.unselected_style,i)}show_tooltip(e){this.tooltip_view&&(null!=e&&e?this.tooltip_div.style("pointer-events","all"):this.tooltip_div.style("pointer-events","none"),this.tooltip_div.styles(this.model.get("tooltip_style")).style("display",null),o.MessageLoop.sendMessage(this.tooltip_view.pWidget,d.Widget.Msg.AfterShow),this.parent.popper.enableEventListeners(),this.move_tooltip())}move_tooltip(e){this.tooltip_view&&(this.parent.popper_reference.x=c().clientX,this.parent.popper_reference.y=c().clientY,this.parent.popper.scheduleUpdate())}hide_tooltip(){this.parent.popper.disableEventListeners(),this.tooltip_div.style("pointer-events","none"),this.tooltip_div.style("opacity",0).style("display","none")}refresh_tooltip(e=!1){const t=l.select(c().target);if(this.is_hover_element(t)){const s=t.data()[0],i=this.model.get_data_dict(s,s.index);this.trigger("update_tooltip",i),this.show_tooltip(e)}}create_tooltip(){const e=this.model.get("tooltip");this.tooltip_view&&(this.tooltip_view.remove(),this.tooltip_view=null),e&&this.create_child_view(e).then((e=>{this.tooltip_view=e,o.MessageLoop.sendMessage(e.pWidget,d.Widget.Msg.BeforeAttach),this.tooltip_div.node().appendChild(e.el),o.MessageLoop.sendMessage(e.pWidget,d.Widget.Msg.AfterAttach)}))}event_dispatcher(e,t){void 0!==this.event_listeners[e]&&h.bind(this.event_listeners[e],this,t)(),this.custom_msg_sender(e)}custom_msg_sender(e){const t=this.event_metadata[e];if(void 0!==t){let e=null;if(t.hit_test){const s=l.select(c().target);if(!this.is_hover_element(s))return;e=s.data()[0],t.lookup_data&&(e=this.model.get_data_dict(e,e.index))}this.send({event:t.msg_name,data:e})}}reset_click(){this.event_listeners.element_clicked=function(){},this.event_listeners.parent_clicked=function(){}}reset_hover(){this.event_listeners.mouse_over=function(){},this.event_listeners.mouse_move=function(){},this.event_listeners.mouse_out=function(){}}reset_legend_click(){this.event_listeners.legend_clicked=function(){}}reset_legend_hover(){this.event_listeners.legend_mouse_over=function(){},this.event_listeners.legend_mouse_out=function(){}}process_click(e){const t=this;"tooltip"===e&&(this.event_listeners.element_clicked=function(){return t.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip)}process_hover(e){"tooltip"===e&&(this.event_listeners.mouse_over=this.refresh_tooltip,this.event_listeners.mouse_move=this.move_tooltip,this.event_listeners.mouse_out=this.hide_tooltip)}process_legend_click(e){const t=this;"tooltip"===e&&(this.event_listeners.legend_clicked=function(){return t.refresh_tooltip(!0)},this.event_listeners.parent_clicked=this.hide_tooltip)}process_legend_hover(e){"highlight_axes"===e&&(this.event_listeners.legend_mouse_over=h.bind(this.highlight_axes,this),this.event_listeners.legend_mouse_out=h.bind(this.unhighlight_axes,this))}process_interactions(){const e=this.model.get("interactions");_(e.click)?this.process_click(e.click):this.reset_click(),_(e.hover)?this.process_hover(e.hover):this.reset_hover(),_(e.legend_click)?this.process_legend_click(e.legend_click):this.reset_legend_click(),_(e.legend_hover)?this.process_legend_hover(e.legend_hover):this.reset_legend_hover()}mouse_over(){if(this.model.get("enable_hover")){const e=l.select(c().target);if(this.is_hover_element(e)){const t=e.data()[0],s=this.model.get_data_dict(t,t.index);this.trigger("update_tooltip",s),this.show_tooltip(),this.send({event:"hover",point:s})}}}mouse_out(){if(this.model.get("enable_hover")){const e=l.select(c().target);if(this.is_hover_element(e)){const t=e.data()[0],s=this.model.get_data_dict(t,t.index);this.hide_tooltip(),this.send({event:"hover",point:s})}}}mouse_move(){this.model.get("enable_hover")&&this.is_hover_element(l.select(c().target))&&this.move_tooltip()}is_hover_element(e){const t=this.display_el_classes.map((function(t){return e.classed(t)}));return h.compact(t).length>0}}t.Mark=u},9250:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MarkModel=void 0;const n=r(s(5335)),l=s(8657),o=r(s(1961));class d extends n.WidgetModel{defaults(){return Object.assign(Object.assign({},n.WidgetModel.prototype.defaults()),{_model_name:"MarkModel",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:l.semver_range,_view_module_version:l.semver_range,scales:{},scales_metadata:{},preserve_domain:{},display_legend:!1,labels:[],apply_clip:!0,visible:!0,selected_style:{},unselected_style:{},selected:null,enable_hover:!0,tooltip:null,tooltip_style:{opacity:.9},interactions:{hover:"tooltip"},tooltip_location:"mouse"})}initialize(e,t){super.initialize(e,t),this.on("change:scales",this.update_scales,this),this.once("destroy",this.handle_destroy,this),this.dirty=!1,this.update_scales()}update_data(){this.update_domains(),this.trigger("data_updated")}update_domains(){}update_scales(){this.unregister_all_scales(this.previous("scales")),this.trigger("scales_updated"),this.update_domains()}unregister_all_scales(e){this.dirty=!0;for(let t in e)e[t].del_domain([],this.model_id+"_"+t);this.dirty=!1}handle_destroy(){this.unregister_all_scales(this.get("scales"))}get_key_for_dimension(e){const t=this.get("scales_metadata");for(let s in t)if(t[s].dimension===e)return s;return null}get_key_for_orientation(e){const t=this.get("scales_metadata");for(let s in t)if(t[s].orientation===e)return s;return null}get_data_dict(e,t){return e}}t.MarkModel=d,d.serializers=Object.assign(Object.assign({},n.WidgetModel.serializers),{scales:{deserialize:n.unpack_models},tooltip:{deserialize:n.unpack_models},selected:o.array_or_json})},3731:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.symbol=t.types=void 0;const n=r(s(8944)),l=Math.PI,o=l/180,d=Math.sqrt(3),c=Math.tan(l/6),h=function(e){const t=Math.sqrt(e/l);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"},_=n.map({circle:h,cross:function(e,t){const s=Math.sqrt(e/5)/2;return"M"+-3*s+","+-s+"H"+-s+"V"+-3*s+"H"+s+"V"+-s+"H"+3*s+"V"+s+"H"+s+"V"+3*s+"H"+-s+"V"+s+"H"+-3*s+"Z"},diamond:function(e,t){const s=Math.sqrt(e/(2*c)),i=s*c;return"M0,"+-s+"L"+i+",0 0,"+s+" "+-i+",0Z"},square:function(e,t){const s=Math.sqrt(e)/2;return"M"+-s+","+-s+"L"+s+","+-s+" "+s+","+s+" "+-s+","+s+"Z"},"triangle-down":function(e,t){const s=Math.sqrt(e/d),i=s*d/2;return"M0,"+i+"L"+s+","+-i+" "+-s+","+-i+"Z"},"triangle-up":function(e,t){const s=Math.sqrt(e/d),i=s*d/2;return"M0,"+-i+"L"+s+","+i+" "+-s+","+i+"Z"},arrow:function(e,t){const s=60+-55*t,i=Math.tan(s*o),a=Math.sqrt(e/i),r=a*i/2;return"M0,"+-a+"L"+r+","+a+" "+-r+","+a+"Z"},ellipse:function(e,t){const s=Math.pow(10,t),i=Math.sqrt(e/(l*s)),a=i*s;return"M0,"+a+"A"+i+","+a+" 0 1,1 0,"+-a+"A"+i+","+a+" 0 1,1 0,"+a+"Z"},rectangle:function(e,t){const s=Math.pow(10,t),i=Math.sqrt(e/s)/2,a=i*s;return"M"+-i+","+-a+"L"+i+","+-a+" "+i+","+a+" "+-i+","+a+"Z"}});function u(){return 64}function g(){return"circle"}function m(){return.5}function p(e){return"function"==typeof e?e:function(e){return function(){return e}}(e)}t.symbol=function(){let e=g,t=u,s=m;function i(i,a){return(_.get(e.call(this,i,a))||h)(t.call(this,i,a),s.call(this,i,a))}return i.type=function(t){return arguments.length?(e=p(t),i):e},i.size=function(e){return arguments.length?(t=p(e),i):t},i.skew=function(e){return arguments.length?(s=p(e),i):s},i},t.types=_.keys()},833:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MarketMap=void 0;const l=r(s(5335)),o=r(s(8731)),d=s(3211),c=s(6510),h=r(s(8944));s(2802);const _=s(7105),u=r(s(2298)),g=n(s(7398));class m extends _.Figure{renderImpl(){const e=this.getFigureSize();this.width=e.width,this.height=e.height,this.id=l.uuid(),this.scales={},this.set_top_el_style(),this.margin=this.model.get("map_margin"),this.num_rows=this.model.get("rows"),this.num_cols=this.model.get("cols"),this.row_groups=this.model.get("row_groups"),this.enable_select=this.model.get("enable_select"),this.update_data(),this.set_area_dimensions(this.data.length),this.model.get("theme")&&this.svg.classed(this.model.get("theme"),!0),this.fig=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.fig_map=this.fig.append("g"),this.fig_axes=this.fig.append("g"),this.fig_click=this.fig.append("g"),this.fig_hover=this.fig.append("g"),this.fig_names=this.fig.append("g").style("display",this.model.get("show_groups")?"inline":"none"),this.fig_map.classed("g-map",!0),this.fig_axes.classed("g-axes",!0),this.fig_click.classed("g-click",!0),this.fig_hover.classed("g-hover",!0),this.fig_names.classed("g-names",!0),this.axis=[],this.tooltip_div=h.select(document.createElement("div")).attr("class","mark_tooltip"),this.tooltip_div.styles({opacity:0,"pointer-events":"none"});const t=this.model.get("freeze_tooltip_location");return this.popper_reference=t?new u.ElementReference(this.svg.node()):new u.PositionReference({x:0,y:0,width:20,height:20}),this.popper=new g.default(this.popper_reference,this.tooltip_div.node(),{placement:"auto"}),this.update_default_tooltip(),this.selected_stroke=this.model.get("selected_stroke"),this.hovered_stroke=this.model.get("hovered_stroke"),this.update_plotarea_dimensions(),this.title=this.fig.append("text").attr("class","mainheading").attrs({x:.5*this.plotarea_width,y:-this.margin.top/2,dy:"1em"}).text(this.model.get("title")),this.title.styles(this.model.get("title_style")),this.create_scale_views().then((()=>{this.create_listeners(),this.axis_views=new l.ViewList(this.add_axis,null,this);const e=this.axis_views.update(this.model.get("axes"));return this.model.on("change:axes",((e,t,s)=>{this.axis_views.update(t)})),this.draw_map(),document.body.appendChild(this.tooltip_div.node()),this.create_tooltip_widget(),window.addEventListener("resize",this.debouncedRelayout),this.once("remove",(()=>{window.removeEventListener("resize",this.debouncedRelayout)})),Promise.all([Promise.resolve(),e])}))}set_top_el_style(){this.el.style["user-select"]="none",this.el.style["ms-user-select"]="none",this.el.style["moz-user-select"]="none",this.el.style["khtml-user-select"]="none",this.el.style["webkit-user-select"]="none"}update_plotarea_dimensions(){this.plotarea_width=this.width-this.margin.left-this.margin.right,this.plotarea_height=this.height-this.margin.top-this.margin.bottom,this.column_width=parseFloat((this.plotarea_width/this.num_cols).toFixed(2)),this.row_height=parseFloat((this.plotarea_height/this.num_rows).toFixed(2))}reset_drawing_controls(){this.prev_x=0,this.prev_y=-1,this.y_direction=1,this.x_direction=1,this.group_iter=1}create_listeners(){this.listenTo(this.model,"change:scales",this.create_scale_views),this.listenTo(this.model,"change:color",this.recolor_chart),this.listenTo(this.model,"change:colors",this.colors_updated),this.listenTo(this.model,"change:show_groups",this.show_groups),this.listenTo(this.model,"change:selected_stroke",this.update_selected_stroke),this.listenTo(this.model,"change:hovered_stroke",this.update_hovered_stroke),this.listenTo(this.model,"change:font_style",this.update_font_style),this.model.on_some_change(["title","title_style"],this.update_title,this),this.listenTo(this.model,"change:selected",(function(){this.clear_selected(),this.apply_selected()})),this.model.on_some_change(["names","groups","ref_data"],(function(){this.update_data(),this.compute_dimensions_and_draw()}),this),this.listenTo(this.model,"change:rows",(function(e,t){this.num_rows=t,this.compute_dimensions_and_draw()})),this.listenTo(this.model,"change:cols",(function(e,t){this.num_cols=t,this.compute_dimensions_and_draw()})),this.listenTo(this.model,"change:row_groups",(function(e,t){this.row_groups=t,this.compute_dimensions_and_draw()})),this.listenTo(this.model,"change:tooltip_widget",this.create_tooltip_widget),this.listenTo(this.model,"change:tooltip_fields",this.update_default_tooltip),this.listenTo(this.model,"change:tooltip_formats",this.update_default_tooltip)}update_title(e,t){this.title.text(this.model.get("title")).styles(this.model.get("title_style"))}relayout(){const e=this,t=this.getFigureSize();this.width=t.width,this.height=t.height,window.requestAnimationFrame((function(){e.margin=e.model.get("map_margin"),e.update_plotarea_dimensions(),e.fig.attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.title.attrs({x:.5*e.plotarea_width,y:-e.margin.top/2,dy:"1em"}),e.draw_map(),e.clear_selected(),e.apply_selected(),e.fig_hover.selectAll("rect").remove(),e.hide_tooltip(),e.trigger("margin_updated")}))}update_data(){const e=this;this.data=this.model.get("names")||[],this.ref_data=this.model.get("ref_data"),this.group_data=this.model.get("groups"),this.groups=o.uniq(this.group_data,!0);let t=this.model.get("display_text");t=null===t||0===t.length?this.data:t,this.colors=this.model.get("colors");const s=this.colors.length;this.colors_map=function(t){return e.get_color(t,s)};const i=this.model.get("color"),a=o.map(this.data,((e,s)=>({display:t[s],name:e,color:Number.isNaN(i[s])?void 0:i[s],group:this.group_data[s],ref_data:null===this.ref_data||void 0===this.ref_data?null:this.ref_data[s]})));this.update_domains(),this.grouped_data=o.groupBy(a,(function(t,s){return e.group_data[s]})),this.groups=[],this.running_sums=[],this.running_sums[0]=0;let r=0;for(let e in this.grouped_data)this.groups.push(e),r+=this.grouped_data[e].length,this.running_sums.push(r);this.running_sums.pop()}update_domains(){const e=this.model.get("scales").color,t=this.model.get("color");e&&t.length>0&&e.compute_and_set_domain(t,this.model.model_id)}set_area_dimensions(e){this.num_rows=this.model.get("rows"),this.num_cols=this.model.get("cols"),this.row_groups=this.model.get("row_groups"),void 0!==this.num_cols&&null!==this.num_cols&&0!==this.num_cols?(this.row_groups>1&&this.num_cols%2==0&&this.num_cols++,this.num_rows=Math.floor(e/this.num_cols),this.num_rows=e%this.num_cols==0?this.num_rows:this.num_rows+1):void 0!==this.num_rows&&null!==this.num_rows&&0!==this.num_rows?(this.num_cols=Math.floor(e/this.num_rows),this.num_cols=e%this.num_rows==0?this.num_cols:this.num_cols+1,this.row_groups>1&&this.num_cols%2==0&&this.num_cols++):(this.num_cols=Math.floor(Math.sqrt(e)),this.row_groups>1&&this.num_cols%2==0&&this.num_cols++,this.num_rows=Math.floor(e/this.num_cols),this.num_rows=e%this.num_cols==0?this.num_rows:this.num_rows+1),this.row_groups=Math.min(this.row_groups,this.num_rows),1==this.row_groups&&(this.num_cols=Math.floor(e/this.num_rows),this.num_cols=e%this.num_rows==0?this.num_cols:this.num_cols+1),this.set_row_limits()}compute_dimensions_and_draw(){this.set_area_dimensions(this.data.length),this.update_plotarea_dimensions(),this.draw_map(),this.clear_selected(),this.apply_selected(),this.fig_hover.selectAll("rect").remove(),this.hide_tooltip()}update_default_tooltip(){this.tooltip_fields=this.model.get("tooltip_fields");const e=this.model.get("tooltip_formats");this.tooltip_formats=this.tooltip_fields.map((function(t,s){const i=e[s];return void 0===i||""===i?function(e){return e}:h.format(i)}))}create_scale_views(){for(let e in this.scales)this.stopListening(this.scales[e]);const e=this.model.get("scales"),t=this,s={};return o.each(e,(function(e,i){s[i]=t.create_child_view(e)})),l.resolvePromisesDict(s).then((function(e){t.scales=e,t.set_scales()}))}set_scales(){const e=this,t=this.scales.color;t&&(t.set_range(),t.on("color_scale_range_changed",e.update_map_colors,e),this.update_domains(),this.listenTo(t,"domain_changed",(function(){e.update_map_colors()})),this.update_map_colors())}show_groups(e,t){this.fig_names.style("display",t?"inline":"none"),this.fig_map.selectAll(".market_map_text").style("opacity",t?.2:1),this.fig_map.selectAll(".market_map_rect").style("stroke-opacity",t?.2:1)}draw_map(){this.reset_drawing_controls(),this.fig_map.selectAll(".element_group").remove(),this.fig_names.selectAll(".names_object").remove(),this.rect_groups=this.fig_map.selectAll(".element_group").data(this.groups);const e=this.scales.color,t=this;this.rect_groups=this.rect_groups.enter().append("g").attr("class","element_group").attr("transform",(function(e,s){return t.get_group_transform(s)})).merge(this.rect_groups),this.rect_groups.exit().remove(),this.end_points=[],this.rect_groups.nodes().forEach((function(s,i){const a=t.grouped_data[t.groups[i]],r=t.get_new_cords(),n=t.get_end_points(r[2],a.length,r[0],r[1],r[3],r[4]);n.forEach((function(e){t.end_points.push(e)}));const l=t.running_sums[i];let o=h.select(s).selectAll(".rect_element").data(a);const d=o.enter().append("g").classed("rect_element",!0);d.append("rect").attr("x",0).attr("y",0).classed("market_map_rect",!0),d.append("text").classed("market_map_text",!0).style("text-anchor","middle").style("pointer-events","none").style("dominant-baseline","central"),o=d.merge(o),o.attr("transform",(function(e,s){return t.get_cell_transform(s)})).on("click",(function(e,s){t.cell_click_handler(e,l+s,this)})).on("mouseover",(function(e,s){t.mouseover_handler(e,l+s,this)})).on("mousemove",(function(e){t.mousemove_handler()})).on("mouseout",(function(e,s){t.mouseout_handler(e,l+s,this)})).attr("class",(function(e,t){return h.select(this).attr("class")+" rect_"+(l+t)})),o.selectAll(".market_map_rect").attr("width",t.column_width).attr("height",t.row_height).style("stroke-opacity",t.model.get("show_groups")?.2:1).style("stroke",t.model.get("stroke")).style("fill",(function(s,a){return e&&void 0!==s.color&&null!==s.color?e.scale(s.color):t.colors_map(i)})),o.selectAll(".market_map_text").attr("x",t.column_width/2).attr("y",t.row_height/2).text((function(e,t){return e.display})).style("opacity",t.model.get("show_groups")?.2:1),o.exit().remove(),t.create_bounding_path(s,n);const c=h.min(n,(function(e){return e.x})),_=h.min(n,(function(e){return e.y}));t.fig_names.append("foreignObject").attr("class","names_object").attr("x",c).attr("y",_).append("xhtml:div").attr("class","names_div").styles({display:"flex","flex-direction":"row","align-content":"center","align-items":"center",width:"100%",height:"100%","justify-content":"center","word-wrap":"break-word",font:"24px sans-serif",color:"black"}).text(t.groups[i])})),this.update_font_style(),this.draw_group_names()}draw_group_names(){const e=this.svg.selectAll(".bounding_path").nodes().map((function(e){return e.getBoundingClientRect()}));this.fig_names.selectAll(".names_object").data(e).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height}))}recolor_chart(){const e=this;this.update_data(),this.rect_groups=this.fig.selectAll(".element_group").data(this.groups);const t=this.scales.color;this.rect_groups.nodes().forEach((function(s,i){const a=e.grouped_data[e.groups[i]];h.select(s).selectAll(".rect_element").data(a).select("rect").style("stroke",e.model.get("stroke")).style("fill",(function(s,a){return t&&void 0!==s.color&&null!==s.color?t.scale(s.color):e.colors_map(i)}))}))}update_font_style(){this.svg.selectAll(".market_map_text").styles(this.model.get("font_style"))}update_map_colors(){void 0!==this.rect_groups&&null!==this.rect_groups&&this.recolor_chart()}cell_click_handler(e,t,s){if(this.model.get("enable_select")){const t=Object.assign(this.model.get("selected").slice(),this.model.get("selected")),s=t.indexOf(e.name);-1==s?t.push(e.name):t.splice(s,1),this.model.set("selected",t),this.touch()}}apply_selected(){const e=this.model.get("selected"),t=this;null==e||0===e.length?this.clear_selected():e.forEach((function(e){const s=t.fig_map.selectAll(".rect_element").filter((function(t,s){return t.name===e}));t.fig_click.append("rect").data(s.data()).attr("transform",s.attr("transform")).attr("x",0).attr("y",0).attr("width",t.column_width).attr("height",t.row_height).styles({stroke:t.selected_stroke,"stroke-width":"3px",fill:"none"})}))}clear_selected(){this.fig_click.selectAll("rect").remove()}mouseover_handler(e,t,s){const i=h.select(s).attr("transform");this.model.get("enable_hover")&&(this.fig_hover.append("rect").attr("class","hover_"+t).attr("transform",i).attr("x",0).attr("y",0).attr("width",this.column_width).attr("height",this.row_height).styles({stroke:this.hovered_stroke,"stroke-width":"3px",fill:"none","pointer-events":"none"}),this.show_tooltip(h.event,e),this.send({event:"hover",data:e.name,ref_data:e.ref_data}))}update_selected_stroke(e,t){this.selected_stroke=t,this.fig_click.selectAll("rect").style("stroke",t)}update_hovered_stroke(e,t){this.hovered_stroke=t}mouseout_handler(e,t,s){this.fig_hover.select(".hover_"+t).remove(),this.hide_tooltip()}show_tooltip(e,t){const s=this;if(this.tooltip_view||this.tooltip_fields&&0!=this.tooltip_fields.length){const e=this.tooltip_div;e.transition().styles({opacity:.9,display:null}),this.move_tooltip(),e.select("table").remove();const i=t.ref_data;if(!this.tooltip_view){const t=e.append("table").selectAll("tr").data(this.tooltip_fields);t.exit().remove();const a=t.enter().append("tr");a.append("td").attr("class","tooltiptext").text((function(e){return e})),a.append("td").attr("class","tooltiptext").text((function(e,t){return null==i?null:s.tooltip_formats[t](i[e])}))}this.popper.enableEventListeners(),this.move_tooltip()}}mousemove_handler(){this.move_tooltip()}move_tooltip(){this.popper_reference.x=h.event.clientX,this.popper_reference.y=h.event.clientY,this.popper.scheduleUpdate()}hide_tooltip(){this.tooltip_div.style("pointer-events","none"),this.tooltip_div.transition().styles({opacity:0,display:"none"}),this.popper.disableEventListeners()}create_tooltip_widget(){const e=this.model.get("tooltip_widget");null!==this.tooltip_view&&void 0!==this.tooltip_view&&(this.tooltip_view.remove(),this.tooltip_view=null);const t=this;e&&this.create_child_view(e).then((function(e){t.tooltip_view=e,d.MessageLoop.sendMessage(e.pWidget,c.Widget.Msg.BeforeAttach),t.tooltip_div.node().appendChild(e.el),d.MessageLoop.sendMessage(e.pWidget,c.Widget.Msg.AfterAttach)}))}get_group_transform(e){return"translate(0, 0)"}get_cell_transform(e){return this.past_border_y()?this.prev_y+=this.y_direction:this.past_border_x()?(this.y_direction=-1*this.y_direction,this.prev_x+=this.x_direction):(this.x_direction=-1*this.x_direction,this.prev_y+=this.y_direction,this.group_iter+=1),"translate("+this.prev_x*this.column_width+", "+this.prev_y*this.row_height+")"}get_new_cords(){let e=this.prev_x,t=this.prev_y,s=this.y_direction,i=this.x_direction,a=this.group_iter;return this.past_border_y()?t+=this.y_direction:this.past_border_x()?(s=-1*this.y_direction,e+=this.x_direction):(i=-1*this.x_direction,t+=this.y_direction,a+=1),[e,t,a,i,s,e*this.column_width,t*this.row_height]}past_border_y(){return 1==this.y_direction?this.prev_y+1<this.row_limits[this.group_iter]:this.prev_y-1>this.row_limits[this.group_iter-1]-1}past_border_x(){return 1==this.x_direction?this.prev_x+1<this.num_cols:this.prev_x-1>-1}colors_updated(){this.colors=this.model.get("colors"),this.recolor_chart()}get_color(e,t){return this.colors[e%t]}set_row_limits(){const e=Math.floor(this.num_rows/this.row_groups);this.row_limits=[];for(let t=this.row_groups-1;t>-1;t--)this.row_limits.unshift(t*e);this.row_limits[this.row_groups]=this.num_rows}get_end_points(e,t,s,i,a,r){let n=this.row_limits[e-1],l=this.row_limits[e],o=!1,d=a,c=r;const h=[];let _,u=1==c?l-i:i-n+1,g=1==d?this.num_cols-1-s:s,m=t,p=l-n;if(0!==m){this.calc_end_point_source(s,i,d,c).forEach((function(e){h.push(e)}));const e=Math.min(u,m);if(e===m)return this.calc_end_point_source(s,i,-1*d,c).forEach((function(e){h.push(e)})),_=i+(m-1)*c,this.calc_end_point_dest(s,_,-1*d,c).forEach((function(e){h.push(e)})),this.calc_end_point_dest(s,_,d,c).forEach((function(e){h.push(e)})),h;if(m-=e,0===g?this.calc_end_point_source(s,i,-1*d,c).forEach((function(e){h.push(e)})):u!==l-n?(this.calc_end_point_source(s,i,-1*d,c).forEach((function(e){h.push(e)})),m>p&&this.calc_end_point_dest(s+d,1==c?n:l-1,-1*d,-1*c).forEach((function(e){h.push(e)}))):m<p&&this.calc_end_point_source(s,i,-1*d,c).forEach((function(e){h.push(e)})),i+=c*(e-1),this.calc_end_point_dest(s,i,-1*d,c).forEach((function(e){h.push(e)})),0===m)return this.calc_end_point_dest(s,i,d,c).forEach((function(e){h.push(e)})),h;0!==g&&m>p&&(s+=d)}for(;m>p;){let t;if(p*g<m){t=g;const s=m-t*p;t+=Math.floor(s/(this.row_limits[e+1]-this.row_limits[e]))}else t=Math.floor(m/p);t>g?(s=1===d?this.num_cols-1:0,0!==g&&this.calc_end_point_dest(s,n,d,-1).forEach((function(e){h.push(e)})),t=g,g=this.num_cols,e+=1,n=l,l=this.row_limits[e],i=n,d*=-1,c=Math.pow(-1,t)*c*-1,this.calc_end_point_dest(s,l-1,-1*d,1).forEach((function(e){h.push(e)}))):t===g?(s=1===d?this.num_cols-1:0,0!==g&&this.calc_end_point_dest(s,n,d,-1).forEach((function(e){h.push(e)})),t=g,g=this.num_cols,(e+=1)<this.row_limits.length?(n=l,l=this.row_limits[e],i=n,d*=-1,c=Math.pow(-1,t)*c*-1,o=!0):(c=1,d=1)):(c=Math.pow(-1,t)*c,i=1===c?n:l-1,s+=d*(t-1),this.calc_end_point_source(s,i,-1*d,c).forEach((function(e){h.push(e)}))),m-=t*p,p=l-n}return 0===m?(i=1===c?l-1:n,d=o?-1*d:d,this.calc_end_point_dest(s,i,d,c).forEach((function(e){h.push(e)}))):(c*=-1,i=1===c?n:l-1,s=o?s:s+d,this.calc_end_point_source(s,i,-1*d,c).forEach((function(e){h.push(e)})),_=i+(m-1)*c,this.calc_end_point_dest(s,_,d,c).forEach((function(e){h.push(e)})),this.calc_end_point_dest(s,_,-1*d,c).forEach((function(e){h.push(e)}))),h}create_bounding_path(e,t){const s=[],i=t.slice();s.push(t[0]),i.splice(0,1);const a=["x","y"];let r=0,n=a[r%2],l=a[(r+1)%2];const o=s[0];let d=o[n],c=o[l],_=2*i.length,u=0;for(;i.length>1&&_>0;){const e=i.filter((function(e){return e[n]==d}));if(e.length>0){r++;const t=h.min(e,(function(e){return e[l]})),a=h.max(e,(function(e){return e[l]}));if(t<c&&a>c)if("y"==n)u=1==this.x_direction?a:t;else{const s=e.filter((function(e){return e[l]<c})),i=e.filter((function(e){return e[l]>c}));u=1==s.length?t:1==i.length?a:h.max(s,(function(e){return e[l]}))}else u=t>c?t:a;i.filter((function(e){return e[n]==d&&e[l]==u})).forEach((function(e){i.splice(i.indexOf(e),1)}));const o={};o[n]=d,o[l]=u,s.push(o)}else u=c;const t=n;n=l,l=t,c=d,d=u,_--}i.length>0&&s.push(i[0]),s.push(t[0]);const g=h.line().curve(h.curveLinear).x((function(e){return e.x})).y((function(e){return e.y}));return h.select(e).append("path").attr("class","bounding_path").attr("d",(function(){return g(s)})).attr("fill","none").style("stroke",this.model.get("group_stroke")).style("stroke-width",3)}calc_end_point_source(e,t,s,i){return t=1==i?t:t+1,[{x:(e=1==s?e:e+1)*this.column_width,y:t*this.row_height}]}calc_end_point_dest(e,t,s,i){return t=-1==i?t:t+1,[{x:(e=-1==s?e:e+1)*this.column_width,y:t*this.row_height}]}}t.MarketMap=m},7552:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MarketMapModel=void 0;const n=r(s(5335)),l=r(s(8944)),o=r(s(1961)),d=s(8657);class c extends n.WidgetModel{defaults(){return Object.assign(Object.assign({},n.WidgetModel.prototype.defaults()),{_model_name:"MarketMapModel",_view_name:"MarketMap",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:d.semver_range,_view_module_version:d.semver_range,map_width:1080,map_height:800,names:[],groups:[],display_text:[],ref_data:void 0,title:"",tooltip_fields:[],tooltip_formats:[],show_groups:!1,cols:0,rows:0,row_groups:1,colors:l.scaleOrdinal(l.schemeCategory10).range(),scales:{},axes:[],color:[],map_margin:{top:50,right:50,left:50,bottom:50},preserve_aspect:!1,stroke:"white",group_stroke:"black",selected_stroke:"dodgerblue",hovered_stroke:"orangered",font_style:{},title_style:{},selected:[],enable_hover:!0,enable_select:!0,tooltip_widget:null})}}t.MarketMapModel=c,c.serializers=Object.assign(Object.assign({},n.WidgetModel.serializers),{scales:{deserialize:n.unpack_models},axes:{deserialize:n.unpack_models},tooltip_widget:{deserialize:n.unpack_models},style:{deserialize:n.unpack_models},layout:{deserialize:n.unpack_models},names:o.array_or_json,groups:o.array_or_json,display_text:o.array_or_json,color:o.array_or_json})},958:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OHLC=void 0;const n=r(s(8944)),l=r(s(8731)),o=s(3332),d=function(){return s(8556).B}.bind(this);class c extends o.Mark{render(){this.display_el_classes=["stick_body"];const e=super.render();this.selected_indices=this.model.get("selected"),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.display_el_classes=["stick_body","stick_tail","stick_head"];const t=this;return this.displayed.then((function(){t.parent.tooltip_div.node().appendChild(t.tooltip_div.node()),t.create_tooltip()})),e.then((function(){t.event_listeners={},t.process_interactions(),t.create_listeners(),t.draw()}))}set_ranges(){const e=this.scales.x;e&&e.set_range(this.parent.padded_range("x",e.model));const t=this.scales.y;t&&t.set_range(this.parent.padded_range("y",t.model))}set_positional_scales(){const e=this.scales.x,t=this.scales.y;this.listenTo(e,"domain_changed",(function(){this.model.dirty||this.draw()})),this.listenTo(t,"domain_changed",(function(){this.model.dirty||this.draw()}))}create_listeners(){super.create_listeners.apply(this),this.d3el.on("mouseover",l.bind((function(){this.event_dispatcher("mouse_over")}),this)).on("mousemove",l.bind((function(){this.event_dispatcher("mouse_move")}),this)).on("mouseout",l.bind((function(){this.event_dispatcher("mouse_out")}),this)),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:stroke",this.update_stroke),this.listenTo(this.model,"change:stroke_width",this.update_stroke_width),this.listenTo(this.model,"change:colors",this.update_colors),this.listenTo(this.model,"change:opacities",this.update_opacities),this.listenTo(this.model,"change:marker",this.update_marker),this.listenTo(this.model,"format_updated",this.draw),this.listenTo(this.model,"data_updated",this.draw),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")}))}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.ohlc_click_handler)}reset_selection(){this.model.set("selected",null),this.selected_indices=null,this.touch()}update_selected(e,t){this.selected_indices=t,this.apply_styles()}ohlc_click_handler(e){const t=e.index,s=this,i=this.model.get("selected")||[];let a=Array.from(i);const r=a.indexOf(t),o=d().ctrlKey||d().metaKey;if(r>-1&&o)a.splice(r,1);else if(d().shiftKey){if(r>-1)return;const e=0!==a.length?n.min(a):-1,i=0!==a.length?n.max(a):s.model.mark_data.length;t>i?l.range(i+1,t+1).forEach((function(e){a.push(e)})):t<e&&l.range(t,e).forEach((function(e){a.push(e)}))}else o||(a=[]),a.push(t);this.model.set("selected",0===a.length?null:a,{updated_view:this}),this.touch();const c=d();void 0!==c.cancelBubble&&(c.cancelBubble=!0),c.stopPropagation&&c.stopPropagation(),c.preventDefault()}update_stroke(){const e=this.model.get("stroke");this.d3el.selectAll(".stick").style("stroke",e),this.legend_el&&(this.legend_el.selectAll("path").style("stroke",e),this.legend_el.selectAll("text").style("fill",e))}update_stroke_width(){const e=this.model.get("stroke_width");this.d3el.selectAll(".stick").attr("stroke-width",e)}update_colors(){const e=this,t=this.model.get("colors"),s=t[0]?t[0]:"none",i=t[1]?t[1]:"none";this.d3el.selectAll(".stick").style("fill",(function(t){return t.y[e.model.px.o]>t.y[e.model.px.c]?i:s})),this.legend_el&&this.legend_el.selectAll("path").style("fill",s)}update_opacities(){const e=this.model.get("opacities");this.d3el.selectAll(".stick").style("opacity",(function(t,s){return e[s]})),this.legend_el&&this.legend_el.selectAll("path").attr("opacity",(function(t,s){return e[s]}))}update_marker(){const e=this.model.get("marker");this.legend_el&&this.rect_dim&&this.draw_legend_icon(this.rect_dim,this.legend_el),this.draw_mark_paths(e,this.d3el,this.model.mark_data.map((function(e,t){return e[1]})))}update_selected_colors(e,t){let s=l.range(e,t+1);s.length==this.model.mark_data.length&&(s=[]);const i=this,a=this.model.get("stroke"),r=this.model.get("colors"),n=r[0]?r[0]:a,o=r[1]?r[1]:a,d=this.model.px;l.range(0,this.model.mark_data.length).forEach((function(e){i.d3el.selectAll("#stick"+e).style("stroke",a)})),s.forEach((function(e){i.d3el.selectAll("#stick"+e).style("stroke",(function(e){return e[d.o]>e[d.c]?o:n}))}))}invert_range(e,t){if(void 0===e||void 0===t||0===this.model.mark_data.length)return this.update_selected_colors(-1,-1),[];const s=new Uint32Array(l.range(this.model.mark_data.length)),i=this,a=s.filter((s=>{const a=i.x_pixels[s];return a>=e&&a<=t})),r=this.scales.x;let n=-1,o=-1;return a.length>0&&(e!==r.scale.range()[0]||t!==r.scale.range()[1])&&(n=a[0],o=a[a.length-1]),this.update_selected_colors(n,o),this.model.set("selected",a),this.touch(),super.invert_range(e,t)}invert_point(e){const t=this.x_pixels.map((function(t){return Math.abs(t-e)})),s=t.indexOf(n.min(t));this.update_selected_colors(s,s),this.model.set("selected",[s]),this.touch()}draw(){const e=this.scales.x,t=this.scales.y;this.set_ranges();const s=this.model.get("colors"),i=this.model.get("opacities"),a=s[0]?s[0]:"none",r=s[1]?s[1]:"none",l=this.model.px,o=this.d3el.selectAll(".stick").data(this.model.mark_data.map((function(e,t){return{x:e[0],y:e[1],index:t}}))),d=o.enter().append("g").attr("class","stick").attr("id",(function(e,t){return"stick"+t})).style("stroke",this.model.get("stroke")).style("opacity",(function(e,t){return i[t]}));d.append("path").attr("class","stick_head"),d.append("path").attr("class","stick_tail"),d.append("path").attr("class","stick_body"),o.exit().remove();const c=this;let h=l.h;if(-1===l.h&&(h=l.o),this.d3el.selectAll(".stick").style("fill",(function(e,t){return e.y[l.o]>e.y[l.c]?r:a})).attr("stroke-width",this.model.get("stroke_width")),"ordinal"===e.model.type){const s=n.max(this.parent.range("x"));this.d3el.selectAll(".stick").attr("transform",(function(i,a){return"translate("+((void 0!==e.scale(c.model.mark_data[a][0])?e.scale(c.model.mark_data[a][0]):s)+e.scale.bandwidth()/2)+","+(t.scale(i.y[h])+t.offset)+")"}))}else this.d3el.selectAll(".stick").attr("transform",(function(s,i){return"translate("+(e.scale(c.model.mark_data[i][0])+e.offset)+","+(t.scale(s.y[h])+t.offset)+")"}));this.d3el.selectAll(".stick").on("click",((e,t)=>c.event_dispatcher("element_clicked",{data:e,index:t}))),this.draw_mark_paths(this.model.get("marker"),this.d3el,this.model.mark_data.map((function(e){return e[1]}))),this.x_pixels=this.model.mark_data.map((function(t){return e.scale(t[0])+e.offset}))}draw_mark_paths(e,t,s){const i=this.model.px,a=this,r=[],n=[],l=[],o=[],d=[],c=[],h=[],_=[];let u=this.calculate_mark_width();const g=this.scales.x,m=this.scales.y;let p,f;for(var b=0;b<s.length;b++)-1===i.o?r[b]=void 0:r[b]=m.scale(s[b][i.o]),-1===i.c?o[b]=void 0:o[b]=m.scale(s[b][i.c]),-1!==i.o&&-1!==i.c&&(d[b]=s[b][i.o]>s[b][i.c]?r[b]:o[b],c[b]=s[b][i.o]<s[b][i.c]?r[b]:o[b]),-1===i.h||-1===i.l?(n[b]=r[b],l[b]=o[b]):(n[b]=m.scale(s[b][i.h]),l[b]=m.scale(s[b][i.l])),f=a.model.mark_data[b][0],u instanceof Date&&(u=u.getTime()),f instanceof Date&&(f=f.getTime()),p=f+u,"ordinal"===g.model.type?_[b]=.75*g.scale.bandwidth():_[b]=.75*(g.scale(p)-g.scale(f)),h[b]=-1*_[b]/2;"candle"==e&&-1!==i.o&&-1!==i.c?(-1!==i.h||-1!==i.l?(t.selectAll(".stick_head").attr("d",(function(e,t){return a.head_path_candle(d[t]-n[t])})),t.selectAll(".stick_tail").attr("d",(function(e,t){return a.tail_path_candle(c[t]-n[t],l[t]-c[t])}))):(t.selectAll(".stick_head").attr("d",""),t.selectAll(".stick_tail").attr("d","")),t.selectAll(".stick_body").attr("d",(function(e,t){return a.body_path_candle(h[t],r[t]-n[t],_[t],o[t]-r[t])}))):(-1!==i.o?t.selectAll(".stick_head").attr("d",(function(e,t){return a.head_path_bar(h[t],r[t]-n[t],-1*h[t])})):t.selectAll(".stick_head").attr("d",""),-1!==i.c?t.selectAll(".stick_tail").attr("d",(function(e,t){return a.tail_path_bar(o[t]-n[t],-1*h[t])})):t.selectAll(".stick_tail").attr("d",""),t.selectAll(".stick_body").attr("d",(function(e,t){return a.body_path_bar(l[t]-n[t])})))}head_path_candle(e){return"m0,0 l0,"+e}tail_path_candle(e,t){return"m0,"+e+" l0,"+t}body_path_candle(e,t,s,i){return"m"+e+","+t+" l"+s+",0 l0,"+i+" l"+-1*s+",0 z"}head_path_bar(e,t,s){return"m"+e+","+t+" l"+s+",0"}tail_path_bar(e,t){return"m0,"+e+" l"+t+",0"}body_path_bar(e){return"m0,0 l0,"+e}calculate_mark_width(){const e=this;let t=Number.POSITIVE_INFINITY;const s=this.model.get("scales").x;for(var i=1;i<e.model.mark_data.length;i++){const s=e.model.mark_data[i][0]-e.model.mark_data[i-1][0];s<t&&(t=s)}return t===Number.POSITIVE_INFINITY&&(t=(s.domain[1]-s.domain[0])/2),t<0&&(t*=-1),t}relayout(){this.set_ranges(),this.d3el.select(".intselmouse").attr("width",this.width).attr("height",this.height),this.draw()}draw_legend(e,t,s,i,a){const r=this.model.get("stroke"),o=this.model.get("colors"),d=o[0]?o[0]:"none";this.rect_dim=.8*a;const c=this;this.legend_el=e.selectAll("#legend"+this.uuid).data([this.model.mark_data]);const h=this.legend_el.enter().append("g").attr("transform",(function(e,t){return"translate(0, "+(t*a+s)+")"})).attr("class","legend").attr("id","legend"+this.uuid).style("fill",d).on("mouseover",l.bind(this.highlight_axes,this)).on("mouseout",l.bind(this.unhighlight_axes,this));h.append("path").attr("class","stick_head stick"),h.append("path").attr("class","stick_tail stick"),h.append("path").attr("class","stick_body stick").style("fill",d),h.selectAll("path").style("stroke",r).attr("transform","translate("+c.rect_dim/2+",0)"),this.draw_legend_icon(c.rect_dim,h),this.legend_el.append("text").attr("class","legendtext sticktext").attr("x",1.2*c.rect_dim).attr("y",c.rect_dim/2).attr("dy","0.35em").text((function(e,t){return c.model.get("labels")[t]})).style("fill",r);const _=n.max(this.model.get("labels"),(function(e){return Number(e.length)}));return this.legend_el.exit().remove(),[1,_]}draw_legend_icon(e,t){const s=e,i=e/2,a=3*e/4,r=e/4;"candle"===this.model.get("marker")?(t.selectAll(".stick_head").attr("d",this.head_path_candle(i/2)),t.selectAll(".stick_tail").attr("d",this.tail_path_candle(a,i/2)),t.selectAll(".stick_body").attr("d",this.body_path_candle(-1*i/2,r,i,s/2))):(t.selectAll(".stick_head").attr("d",this.head_path_bar(-1*i/2,a,i/2)),t.selectAll(".stick_tail").attr("d",this.tail_path_bar(r,i/2)),t.selectAll(".stick_body").attr("d",this.body_path_bar(s)))}clear_style(){}compute_view_padding(){}set_default_style(){}set_style_on_elements(){}}t.OHLC=c},9401:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OHLCModel=void 0;const n=r(s(8944)),l=r(s(8731)),o=s(9250),d=r(s(1961));class c extends o.MarkModel{defaults(){return Object.assign(Object.assign({},o.MarkModel.prototype.defaults()),{_model_name:"OHLCModel",_view_name:"OHLC",x:[],y:[],scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"}},marker:"candle",stroke:null,stroke_width:1,colors:["green","red"],opacities:[],format:"ohlc"})}initialize(e,t){super.initialize(e,t),this.on_some_change(["x","y"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.on("change:format",this.update_format,this),this.px={o:-1,h:-1,l:-1,c:-1},this.mark_data=[],this.update_data(),this.update_domains(),this.update_format()}update_format(){this.update_data(),this.trigger("format_updated")}update_data(){let e=this.get("x"),t=this.get("y");const s=this.get("format");function i(e){console&&console.error("Invalid OHLC format: '"+e+"'")}if(this.px=s.toLowerCase().split("").reduce((function(a,r,n){return-1!==a[r]&&(i(s),e=[],t=[]),a[r]=n,a}),{o:-1,h:-1,l:-1,c:-1}),-1!==this.px.h&&-1===this.px.l||-1===this.px.h&&-1!==this.px.l||s.length<2||s.length>4)i(s),e=[],t=[];else{const i=this.px;(-1===this.px.h||t.every((function(e){return e[i.h]===n.max(e)&&e[i.l]===n.min(e)})))&&t.every((function(e){return e.length===s.length}))||(e=[],t=[],console&&console.error("Invalid OHLC data"))}e.length>t.length?e=e.slice(0,t.length):e.length<t.length&&(t=t.slice(0,e.length)),this.mark_data=l.zip(e,t),this.mark_data.forEach((function(e,t){e.index=t})),this.update_domains(),this.trigger("data_updated")}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.x,s=e.y;let i,a,r=Number.POSITIVE_INFINITY,l=0,o=0,d=0;for(let e=0;e<this.mark_data.length;e++)e>0&&(o=this.mark_data[e][0]-this.mark_data[e-1][0],o<r&&(r=o)),d=this.mark_data[e][this.px.h]-this.mark_data[e][this.px.l],d>l&&(l=d);if(this.mark_data.length<2&&(r=0),this.get("preserve_domain").x||0===this.mark_data.length?t.del_domain([],this.model_id+"_x"):"ordinal"===t.type?t.compute_and_set_domain(this.mark_data.map((function(e){return e[0]}))):(i=n.min(this.mark_data.map((function(e){return e[0]}))),a=n.max(this.mark_data.map((function(e){return e[0]}))),a instanceof Date&&(a=a.getTime()),t.set_domain([i-r/2,a+r/2],this.model_id+"_x")),this.get("preserve_domain").y||0===this.mark_data.length)s.del_domain([],this.model_id+"_y");else{let e=this.px.h,t=this.px.l;-1!==e&&-1!==t||(e=this.px.o,t=this.px.c),i=n.min(this.mark_data.map((function(s){return s[1][t]<s[1][e]?s[1][t]:s[1][e]}))),a=n.max(this.mark_data.map((function(s){return s[1][e]>s[1][t]?s[1][e]:s[1][t]}))),a instanceof Date&&(a=a.getTime()),s.set_domain([i-l,a+l],this.model_id+"_y")}}get_data_dict(e,t){const s=this,i={index:t,x:e.x};return["open","low","high","close"].forEach((function(t){i[t]=e.y[s.px[t.substr(0,1)]]})),i}}t.OHLCModel=c,c.serializers=Object.assign(Object.assign({},o.MarkModel.serializers),{x:d.array_or_json,y:d.array_or_json})},4439:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OrdinalColorScale=void 0;const n=r(s(8944)),l=s(8980),o=r(s(8393));class d extends l.Scale{render(){this.scale=n.scaleOrdinal(),this.scale.domain(this.model.domain),this.create_event_listeners(),this.listenTo(this.model,"domain_changed",this.model_domain_changed),this.model.on_some_change(["colors","scheme"],this.colors_changed,this),this.set_range()}set_range(){this.model.get("colors").length>0?this.scale.range(o.cycle_colors(this.model.get("colors"),this.scale.domain().length)):this.scale.range(o.get_ordinal_scale_range(this.model.get("scheme"),this.scale.domain().length)),this.trigger("color_scale_range_changed")}model_domain_changed(){super.model_domain_changed(),this.set_range()}colors_changed(){this.set_range()}}t.OrdinalColorScale=d},386:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrdinalColorScaleModel=void 0;const i=s(5775);class a extends i.OrdinalScaleModel{defaults(){return Object.assign(Object.assign({},i.OrdinalScaleModel.prototype.defaults()),{_model_name:"OrdinalColorScaleModel",_view_name:"OrdinalColorScale",domain:[]})}}t.OrdinalColorScaleModel=a},7384:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OrdinalScale=void 0;const n=r(s(8944)),l=s(8980),o=r(s(8731));class d extends l.Scale{render(){this.scale=n.scaleBand(),this.scale.domain(this.model.domain),this.offset=0,this.create_event_listeners()}set_range(e,t){t=void 0===t?0:t,this.scale.range(e),this.scale.paddingInner(t),this.scale.paddingOuter(t/2),this.offset=0===this.scale.domain().length?0:this.scale.bandwidth()/2}expand_domain(e,t){const s=this.scale.copy();s.range(e).paddingInner(0).paddingOuter(0);const i=s.range().length>0?Math.abs((t[1]-e[1])/s.bandwidth()):0;this.scale.range(t),this.scale.paddingInner(0),this.scale.paddingOuter(i)}invert(e){const t=this,s=this.scale.domain(),i=s.map((function(e){return t.scale(e)+t.scale.bandwidth()/2})).map((function(t){return Math.abs(e-t)}));return s[i.indexOf(n.min(i))]}invert_range(e){const t=this,s=this.scale.domain(),i=s.map((function(e){return t.scale(e)+t.scale.bandwidth()/2}));return o.range(i.length).filter((function(t){return i[t]>=e[0]&&i[t]<=e[1]})).map((function(e){return s[e]}))}}t.OrdinalScale=d},5775:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OrdinalScaleModel=void 0;const n=s(6370),l=r(s(8731));class o extends n.ScaleModel{defaults(){return Object.assign(Object.assign({},n.ScaleModel.prototype.defaults()),{_model_name:"OrdinalScaleModel",_view_name:"OrdinalScale",domain:[]})}typedRange(e){return new Int32Array(e.map(Number))}initialize(e,t){super.initialize(e,t)}set_init_state(){this.type="ordinal",this.min_from_data=!0,this.max_from_data=!0}set_listeners(){this.on("change:domain",this.domain_changed,this),this.domain_changed(),this.on("change:reverse",this.reverse_changed,this),this.reverse_changed()}domain_changed(){this.ord_domain=this.get("domain"),null!==this.ord_domain&&0!==this.ord_domain.length?(this.max_from_data=!1,this.min_from_data=!1,this.domain=this.ord_domain.map((function(e){return e})),this.trigger("domain_changed")):(this.max_from_data=!0,this.min_from_data=!0,this.domain=[],this.update_domain())}reverse_changed(e){const t=void 0!==e&&e.previous("reverse");this.reverse=this.get("reverse");const s=(t+this.reverse)%2;this.domain.length>0&&1===s&&(this.domain.reverse(),this.trigger("domain_changed",this.domain))}update_domain(){let e=[];for(let t in this.domains)e=l.union(e,this.domains[t]);this.domain.length===e.length&&l.intersection(this.domain,e).length===e.length||(this.domain=e,this.trigger("domain_changed",e))}compute_and_set_domain(e,t){if(!this.min_from_data&&!this.max_from_data)return;if(0===e.length)return void this.set_domain([],t);const s=l.flatten(e);this.get("reverse")&&s.reverse(),this.set_domain(s,t)}}t.OrdinalScaleModel=o},752:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PanZoom=void 0;const n=r(s(5335)),l=r(s(8944)),o=function(){return s(8556).B}.bind(this),d=r(s(5237)),c=r(s(8731));class h extends d.Interaction{render(){super.render();const e=this;this.d3el.style("cursor","move").on("mousedown",(function(){e.mousedown()})).on("mousemove",(function(){e.mousemove()})).on("mouseup",(function(){e.mouseup()})).on("mousewheel",(function(){e.mousewheel()})).on("DOMMouseScroll.zoom",(function(){e.mousewheel()})).on("mousewheel.zoom",null).on("wheel.zoom",null),this.active=!1,this.update_scales(),this.listenTo(this.model,"change:scales",this.update_scales),this.set_ranges(),this.listenTo(this.parent,"margin_updated",this.set_ranges)}update_scales(){const e=this.model.get("scales"),t=this;this.scale_promises=n.resolvePromisesDict({x:Promise.all((e.x||[]).map((function(e){return t.create_child_view(e)}))),y:Promise.all((e.y||[]).map((function(e){return t.create_child_view(e)})))}),n.resolvePromisesDict(this.scale_promises).then(c.bind(this.set_ranges,this))}set_ranges(){const e=this;let t;this.scale_promises.then((function(s){const i=s.x;for(t=0;t<i.length;t++)i[t].set_range(e.parent.padded_range("x",i[t].model));const a=s.y;for(t=0;t<a.length;t++)a[t].set_range(e.parent.padded_range("y",a[t].model))}))}mousedown(){this._mousedown(l.mouse(this.el))}_mousedown(e){const t=this.model.get("scales");this.active=!0,this.d3el.style("cursor","move"),this.previous_pos=e.slice(),this.domains_in_order={x:(t.x||[]).map((function(e){return e.get_domain_slice_in_order()})),y:(t.y||[]).map((function(e){return e.get_domain_slice_in_order()}))}}mouseup(){this.active=!1}mousemove(){this._mousemove(l.mouse(this.el))}_mousemove(e){if(this.active&&this.model.get("allow_pan")){void 0===this.previous_pos&&(this.previous_pos=e);const t={x:e[0]-this.previous_pos[0],y:e[1]-this.previous_pos[1]};return this.scale_promises.then((e=>{["x","y"].forEach((s=>{e[s].forEach(((e,i)=>{if(e.scale.invert){const a=e.scale.copy().domain(this.domains_in_order[s][i]),r=a(this.domains_in_order[s][i][0]),n=a(this.domains_in_order[s][i][1]),l=a.invert(r-t[s]),o=a.invert(n-t[s]);e.model.set("min",l),e.model.set("max",o),e.touch()}}))}))}))}}mousewheel(){if(this.model.get("allow_zoom")){o().preventDefault();const e=o().wheelDelta||-40*o().detail,t=l.mouse(this.el);this._zoom(t,e)}}_zoom(e,t){if(t){t>0?this.d3el.style("cursor","zoom-in"):this.d3el.style("cursor","zoom-out");const s={x:e[0],y:e[1]},i=Math.exp(.001*-t);return this.scale_promises.then((e=>{["x","y"].forEach((t=>{e[t].forEach(((e,a)=>{if(e.scale.invert){const a=e.scale;let[r,n]=e.model.get_domain_slice_in_order();const l=a(r),o=a(n);r=a.invert((1-i)*s[t]+i*l),n=a.invert((1-i)*s[t]+i*o),e.model.set("min",r),e.model.set("max",n),e.touch()}}))}))}))}}}t.PanZoom=h},5252:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PanZoomModel=void 0;const n=r(s(5335)),l=s(8657),o=r(s(8731));class d extends n.WidgetModel{defaults(){return Object.assign(Object.assign({},n.WidgetModel.prototype.defaults()),{_model_name:"PanZoomModel",_view_name:"PanZoom",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:l.semver_range,_view_module_version:l.semver_range,scales:{},allow_pan:!0,allow_zoom:!0})}initialize(e,t){super.initialize(e,t),this.on("change:scales",this.snapshot_scales,this),this.snapshot_scales()}reset_scales(){n.resolvePromisesDict(this.get("scales")).then((e=>{o.each(Object.keys(e),(t=>{o.each(e[t],((e,s)=>{e.set_state(this.scales_states[t][s])}),this)}),this)}))}snapshot_scales(){n.resolvePromisesDict(this.get("scales")).then((e=>{this.scales_states=Object.keys(e).reduce(((t,s)=>(t[s]=e[s].map((e=>e.get_state())),t)),{})}))}}t.PanZoomModel=d,d.serializers=Object.assign(Object.assign({},n.WidgetModel.serializers),{scales:{deserialize:n.unpack_models}})},5687:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Pie=void 0;const n=r(s(8944));s(2802);const l=function(){return s(8556).B}.bind(this),o=r(s(8731)),d=s(3332),c=s(6988);class h extends d.Mark{render(){const e=super.render();this.selected_indices=this.model.get("selected"),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.display_el_classes=["slice","text"],this.pie_g=this.d3el.append("g").attr("class","pie"),this.pie_g.append("g").attr("class","slices"),this.pie_g.append("g").attr("class","labels"),this.pie_g.append("g").attr("class","lines");const t=this.model.get("radius"),s=this.model.get("inner_radius");return"outside"===this.model.get("display_labels")?(this.arc=n.arc().outerRadius(.8*t).innerRadius(.8*s),this.outer_arc=n.arc().innerRadius(.9*t).outerRadius(.9*t)):this.arc=n.arc().outerRadius(t).innerRadius(s),this.displayed.then((()=>{this.parent.tooltip_div.node().appendChild(this.tooltip_div.node()),this.create_tooltip()})),e.then((()=>{this.event_listeners={},this.process_interactions(),this.create_listeners(),this.compute_view_padding(),this.draw()}),null)}set_ranges(){const e=this.scales.x;e&&(e.set_range(this.parent.padded_range("x",e.model)),this.x_offset=e.offset);const t=this.scales.y;t&&(t.set_range(this.parent.padded_range("y",t.model)),this.y_offset=t.offset)}set_positional_scales(){const e=this.scales.x?this.scales.x:this.parent.scale_x,t=this.scales.y?this.scales.y:this.parent.scale_y,s=this;this.listenTo(e,"domain_changed",(function(){s.model.dirty||s.draw()})),this.listenTo(t,"domain_changed",(function(){s.model.dirty||s.draw()}))}create_listeners(){super.create_listeners(),this.d3el.on("mouseover",o.bind((function(){this.event_dispatcher("mouse_over")}),this)).on("mousemove",o.bind((function(){this.event_dispatcher("mouse_move")}),this)).on("mouseout",o.bind((function(){this.event_dispatcher("mouse_out")}),this)),this.listenTo(this.model,"data_updated",(function(){this.draw(!0)})),this.listenTo(this.model,"colors_updated",this.updateSlices),this.model.on_some_change(["inner_radius","radius"],(function(){this.compute_view_padding(),this.update_radius(!0)}),this),this.model.on_some_change(["colors","stroke","opacities"],this.updateSlices,this),this.model.on_some_change(["x","y"],(function(){this.position_center(!0)}),this),this.model.on_some_change(["display_labels","label_color","font_size","font_weight","display_values","values_format"],(function(){this.updateLabels(!0)}),this),this.model.on_some_change(["start_angle","end_angle","sort"],(function(){this.draw(!0)}),this),this.listenTo(this.model,"labels_updated",(function(){this.updateLabels(!0),this.updatePolylines(!0)})),this.listenTo(this.model,"change:selected",(function(){this.selected_indices=this.model.get("selected"),this.apply_styles()})),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.parent,"bg_clicked",(function(){this.event_dispatcher("parent_clicked")}))}process_click(e){super.process_click(e),"select"===e&&(this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.click_handler)}relayout(){this.set_ranges(),this.position_center(),this.update_radius()}position_center(e){const t=!0===e?this.parent.model.get("animation_duration"):0,s=this.scales.x?this.scales.x:this.parent.scale_x,i=this.scales.y?this.scales.y:this.parent.scale_y,a="date"===s.model.type?c.getDate(this.model.get("x")):this.model.get("x"),r="date"===i.model.type?c.getDate(this.model.get("y")):this.model.get("y"),n="translate("+(s.scale(a)+s.offset)+", "+(i.scale(r)+i.offset)+")";this.pie_g.transition("position_center").duration(t).attr("transform",n)}update_radius(e){const t=!0===e?this.parent.model.get("animation_duration"):0,s=this.model.get("radius"),i=this.model.get("inner_radius"),a=this.model.get("display_labels");"inside"===a?this.arc.outerRadius(s).innerRadius(i):"outside"===a&&(this.arc.outerRadius(.8*s).innerRadius(.8*i),this.outer_arc.innerRadius(.9*s).outerRadius(.9*s));const r=this.pie_g.select(".slices"),n=this.pie_g.select(".labels"),l=this.pie_g.select(".lines"),o=this;r.selectAll(".slice").transition("update_radius").duration(t).attr("d",this.arc),"inside"===a?n.selectAll("text").transition("update_radius").duration(t).attr("transform",(function(e){return"translate("+o.arc.centroid(e)+")"})):"outside"===a&&(n.selectAll("text").transition("update_radius").duration(t).attr("transform",(function(e){const t=o.outer_arc.centroid(e);return t[0]=s*("left"===o.mid_angle_location(e)?-1:1),"translate("+t+")"})),l.selectAll("polyline").transition("update_radius").duration(t).attr("points",(function(e){const t=o.outer_arc.centroid(e);return t[0]=.95*s*("left"===o.mid_angle_location(e)?-1:1),[o.arc.centroid(e),o.outer_arc.centroid(e),t]})))}mid_angle_location(e){const t=(e.startAngle+e.endAngle)/2;return t>Math.PI||t<0&&t>-Math.PI?"left":"right"}draw(e){this.set_ranges(),this.position_center(e),this.d3Pie=n.pie().startAngle(2*this.model.get("start_angle")*Math.PI/360).endAngle(2*this.model.get("end_angle")*Math.PI/360).value((function(e){return e.size})),this.model.get("sort")||this.d3Pie.sort(null),this.updateSlices(e),this.updateLabels(e),this.updatePolylines(e)}updateSlices(e){const t=this,s=!0===e?this.parent.model.get("animation_duration"):0,i=this.pie_g.select(".slices").selectAll(".slice").data(this.d3Pie(this.model.mark_data)),a=this.model.get("stroke"),r=this.model.get("opacities"),l=this.scales.color;i.enter().append("path").attr("class","slice").each((function(e){this._current=e})).on("click",(function(e,s){return t.event_dispatcher("element_clicked",{data:e,index:s})})).merge(i).transition("draw").duration(s).style("fill",(function(e,s){return void 0!==e.data.color&&void 0!==l?l.scale(e.data.color):t.get_colors(e.data.index)})).style("stroke",a).style("opacity",((e,t)=>r[t])).attrTween("d",(function(e){const s=n.interpolate(this._current,e);return this._current=e,function(e){return t.arc(s(e))}})),i.exit().transition("remove").duration(s).style("opacity",0).remove(),this.apply_styles()}updateLabels(e){const t=this,s=!0===e?this.parent.model.get("animation_duration"):0,i=this.model.get("display_labels"),a=this.model.get("display_values"),r=n.format(this.model.get("values_format")),l=this.pie_g.select(".labels").selectAll("text").data(this.d3Pie(this.model.mark_data)),o=l.enter().append("text").attr("dy",".35em").style("opacity",0).each((function(e){this._current=e})).merge(l).transition("draw").duration(s).text((e=>""===e.data.label?"":a?e.data.label+": "+r(e.data.size):e.data.label)).style("font-weight",this.model.get("font_weight")).style("font-size",this.model.get("font_size")).style("opacity",(e=>"none"===i||0==e.value?0:1)),d=this.model.get("label_color");void 0!==d&&o.style("fill",d),"inside"===i?o.attr("transform",(e=>"translate("+this.arc.centroid(e)+")")).style("text-anchor","middle"):"outside"===i&&o.attrTween("transform",(function(e){const s=n.interpolate(this._current,e),i=this;return function(a){const r=s(a);i._current=r;const n=t.outer_arc.centroid(r);return n[0]=t.model.get("radius")*("left"===t.mid_angle_location(e)?-1:1),"translate("+n+")"}})).styleTween("text-anchor",(function(e){const s=n.interpolate(this._current,e);return function(e){const i=s(e);return"left"===t.mid_angle_location(i)?"end":"start"}})),l.exit().remove()}updatePolylines(e){const t=this,s=!0===e?this.parent.model.get("animation_duration"):0,i=this.model.get("display_labels"),a=this.pie_g.select(".lines").selectAll("polyline").data(this.d3Pie(this.model.mark_data)),r=a.enter().append("polyline").each((function(e){this._current=e})).merge(a).transition("draw").duration(s).style("opacity",(e=>"outside"!==i||0==e.value||""===e.data.label?0:1));"outside"===i&&r.attrTween("points",(function(e){this._current=this._current;const s=n.interpolate(this._current,e),i=this;return function(e){const a=s(e);i._current=a;const r=t.outer_arc.centroid(a);return r[0]=.95*t.model.get("radius")*("left"===t.mid_angle_location(a)?-1:1),[t.arc.centroid(a),t.outer_arc.centroid(a),r]}})),a.exit().remove()}clear_style(e,t){let s=this.pie_g.selectAll(".slice");t&&(s=s.filter((function(e,s){return-1!==t.indexOf(s)})));const i={};for(let t in e)i[t]=null;s.styles(i)}set_style_on_elements(e,t){if(null==t||0===t.length)return;let s=this.pie_g.selectAll(".slice");s=s.filter((function(e,s){return-1!==t.indexOf(s)})),s.styles(e)}set_default_style(e){const t=this,s=this.model.get("stroke"),i=this.model.get("opacities"),a=this.scales.color;this.pie_g.select(".slices").selectAll(".slice").style("fill",(function(e,s){return void 0!==e.data.color&&void 0!==a?a.scale(e.data.color):t.get_colors(e.data.index)})).style("stroke",s).style("opacity",((e,t)=>i[t]))}click_handler(e){const t=e.index,s=this,i=this.model.get("selected")||[];let a=Array.from(i);const r=a.indexOf(t),d=l().ctrlKey||l().metaKey;if(r>-1&&d)a.splice(r,1);else{if(l().shiftKey){if(r>-1)return;const e=0!==a.length?n.min(a):-1,i=0!==a.length?n.max(a):s.model.mark_data.length;t>i?o.range(i+1,t).forEach((function(e){a.push(e)})):t<e&&o.range(t+1,e).forEach((function(e){a.push(e)}))}else d||(a=[]);a.push(t)}this.model.set("selected",0===a.length?null:new Uint32Array(a),{updated_view:this}),this.touch();const c=l();void 0!==c.cancelBubble&&(c.cancelBubble=!0),c.stopPropagation&&c.stopPropagation(),c.preventDefault(),this.selected_indices=a,this.apply_styles()}reset_selection(){this.model.set("selected",null),this.touch(),this.selected_indices=null,this.clear_style(this.selected_style),this.clear_style(this.unselected_style),this.set_default_style()}compute_view_padding(){const e=this.model.get("scales"),t=n.max([this.model.get("radius"),this.model.get("inner_radius")]),s=e.x?t+1:0,i=e.y?t+1:0;s===this.x_padding&&i===this.y_padding||(this.x_padding=s,this.y_padding=i,this.trigger("mark_padding_updated"))}}t.Pie=h},9498:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PieModel=void 0;const n=r(s(8944)),l=s(9250),o=s(6988),d=r(s(1961));class c extends l.MarkModel{defaults(){return Object.assign(Object.assign({},l.MarkModel.prototype.defaults()),{_model_name:"PieModel",_view_name:"Pie",sizes:[],labels:[],color:null,x:.5,y:.5,scales_metadata:{color:{dimension:"color"}},sort:!1,colors:n.scaleOrdinal(n.schemeCategory10).range(),stroke:null,opacities:[],radius:180,inner_radius:.1,start_angle:0,end_angle:360,display_labels:"inside",display_values:!1,values_format:".1f",label_color:null,font_size:"12px",font_weight:"normal"})}initialize(e,t){super.initialize(e,t),this.on("change:sizes",this.update_data,this),this.on("change:color",(function(){this.update_color(),this.trigger("colors_updated")}),this),this.on("change:labels",this.update_labels,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data(),this.update_color(),this.update_labels(),this.update_domains()}update_data(){const e=this.get("sizes"),t=this.get("color")||[],s=this.get("labels");this.mark_data=Array.prototype.map.call(e,(function(e,i){return{size:e,color:t[i],label:null==s[i]?"":s[i],index:i}})),this.update_color(),this.update_domains(),this.trigger("data_updated")}update_labels(){if(!this.mark_data)return;const e=this.get("labels");this.mark_data.forEach((function(t,s){t.label=null==e[s]?"":e[s]})),this.trigger("labels_updated")}update_color(){if(!this.mark_data)return;const e=this.get("color"),t=this.get("scales").color;t&&(this.get("preserve_domain").color?t.del_domain([],this.model_id+"_color"):t.compute_and_set_domain(e,this.model_id+"_color"))}update_domains(){if(!this.mark_data)return;const e=this.get("scales"),t=e.x,s=e.y;if(t){const e="date"===t.type?o.getDate(this.get("x")):this.get("x");this.get("preserve_domain").x?t.del_domain([],this.model_id+"_x"):t.compute_and_set_domain([e],this.model_id+"_x")}s&&(this.get("preserve_domain").y?s.del_domain([],this.model_id+"_y"):s.compute_and_set_domain([this.get("y")],this.model_id+"_y"))}get_data_dict(e,t){return e.data}}t.PieModel=c,c.serializers=Object.assign(Object.assign({},l.MarkModel.serializers),{sizes:d.array_or_json,color:d.array_or_json})},2298:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PositionReference=t.ElementReference=void 0,t.ElementReference=function(){function e(e){this.elt=e}return e.prototype.getBoundingClientRect=function(){return this.elt.getBoundingClientRect()},Object.defineProperty(e.prototype,"clientWidth",{get:function(){return this.elt.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clientHeight",{get:function(){return this.elt.clientHeight},enumerable:!0,configurable:!0}),e}(),t.PositionReference=function(){function e(e){const t=e.x,s=e.y,i=e.width,a=e.height;this.x=t,this.y=s,this.width=i,this.height=a}return e.prototype.getBoundingClientRect=function(){const e=this.width/2,t=this.height/2;return{left:this.x-e,right:this.x+e,top:this.y-t,bottom:this.y+t,width:this.width,height:this.height}},Object.defineProperty(e.prototype,"clientWidth",{get:function(){return this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clientHeight",{get:function(){return this.height},enumerable:!0,configurable:!0}),e}()},8980:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Scale=void 0;const n=r(s(5335));class l extends n.WidgetView{render(){this.offset=0}create_event_listeners(){this.listenTo(this.model,"domain_changed",this.model_domain_changed),this.listenTo(this.model,"highlight_axis",this.highlight_axis),this.listenTo(this.model,"unhighlight_axis",this.unhighlight_axis)}set_range(e,t){this.scale.range(e)}compute_and_set_domain(e,t){this.model.compute_and_set_domain(e,t)}set_domain(e,t){this.model.set_domain(e,t)}model_domain_changed(){this.scale.domain(this.model.domain),this.trigger("domain_changed")}highlight_axis(){this.trigger("highlight_axis")}unhighlight_axis(){this.trigger("unhighlight_axis")}expand_domain(e,t){}}t.Scale=l},6370:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScaleModel=void 0;const i=s(5335),a=s(8657);class r extends i.WidgetModel{defaults(){return Object.assign(Object.assign({},i.WidgetModel.prototype.defaults()),{_model_name:"ScaleModel",_view_name:"Scale",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a.semver_range,_view_module_version:a.semver_range,reverse:!1,allow_padding:!0})}initialize(e,t){super.initialize(e,t),this.domains={},this.domain=[],this.set_init_state(),this.set_listeners()}set_init_state(){this.type="base"}set_listeners(){}set_domain(e,t){this.domains[t]=e,this.update_domain()}del_domain(e,t){void 0!==this.domains[t]&&(delete this.domains[t],this.update_domain())}get_domain_slice_in_order(){return this.reverse?this.domain.slice().reverse():this.domain.slice()}}t.ScaleModel=r},328:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Scatter=void 0;const n=s(461),l=r(s(3731)),o=r(s(8944)),d=l.symbol;class c extends n.ScatterBase{render(){return this.dot=d().type(this.model.get("marker")).size(this.model.get("default_size")).skew(this.model.get("default_skew")),super.render()}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:colors",this.update_colors),this.listenTo(this.model,"change:stroke",this.update_stroke),this.listenTo(this.model,"change:stroke_width",this.update_stroke_width),this.listenTo(this.model,"change:opacities",this.update_opacities),this.listenTo(this.model,"change:default_skew",this.update_default_skew),this.listenTo(this.model,"change:marker",this.update_marker),this.listenTo(this.model,"change:default_size",this.update_default_size),this.listenTo(this.model,"change:fill",this.update_fill),this.listenTo(this.model,"change:display_names",this.update_names),this.listenTo(this.model,"change:label_display_horizontal_offset change:label_display_vertical_offset",this.update_names)}update_colors(e,t){if(!this.model.dirty){const e=this.model.get("stroke"),s=t.length;this.d3el.selectAll(".dot").style("fill",this.model.get("fill")?this.get_mark_color.bind(this):"none").style("stroke",e||this.get_mark_color.bind(this)),this.legend_el&&(this.legend_el.select("path").style("fill",(function(e,i){return t[i%s]})).style("stroke",e||function(e,i){return t[i%s]}),this.legend_el.select("text").style("fill",this.model.get("fill")?function(e,i){return t[i%s]}:"none"))}this.apply_styles()}update_fill(e,t){const s=this.model.get("colors"),i=s.length;this.d3el.selectAll(".dot").style("fill",t?this.get_mark_color.bind(this):"none"),this.legend_el&&this.legend_el.selectAll("path").style("fill",t?function(e,t){return s[t%i]}:"none")}update_stroke_width(){const e=this.model.get("stroke_width");this.d3el.selectAll(".dot").style("stroke-width",e),this.legend_el&&this.legend_el.selectAll("path").style("stroke-width",e)}update_stroke(e,t){const s=this.model.get("stroke");this.d3el.selectAll(".dot").style("stroke",s||this.get_mark_color.bind(this)),this.legend_el&&this.legend_el.selectAll("path").style("stroke",s)}update_opacities(e){if(!this.model.dirty){const t=this.model.get("opacities"),s=this.model.get("colors"),i=s.length,a=t.length,r=!0===e?this.parent.model.get("animation_duration"):0,n=this;this.d3el.selectAll(".dot").transition("update_opacities").duration(r).style("opacity",(function(e,t){return n.get_element_opacity(e,t)})),this.legend_el&&this.legend_el.select("path").style("opacity",(function(e,s){return t[s%a]})).style("fill",(function(e,t){return s[t%i]}))}}update_marker(e,t){this.model.dirty||(this.d3el.selectAll(".dot").transition("update_marker").duration(this.parent.model.get("animation_duration")).attr("d",this.dot.type(t)),this.legend_el&&this.legend_el.select("path").attr("d",this.dot.type(t)))}update_default_skew(e){if(!this.model.dirty){const t=!0===e?this.parent.model.get("animation_duration"):0,s=this;this.d3el.selectAll(".dot").transition("update_default_skew").duration(t).attr("d",this.dot.skew((function(e){return s.get_element_skew(e)})))}}update_default_size(e){if(this.compute_view_padding(),!this.model.dirty){const t=!0===e?this.parent.model.get("animation_duration"):0,s=this;this.d3el.selectAll(".dot").transition("update_default_size").duration(t).attr("d",this.dot.size((function(e){return s.get_element_size(e)}))),this.update_names(e)}}update_names(e){const t=this,s=this.model.get("names")||[],i=this.model.get("display_names")&&0!==s.length,a=e?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").select("text").text((function(e){return e.name})).transition("update_names").duration(a).attr("transform",(function(e){const s=t.model.get("label_display_horizontal_offset"),i=t.model.get("label_display_vertical_offset"),a=Math.sqrt(t.get_element_size(e))/2;return"translate("+(s||a)+","+(i?-i:-a)+")"})).attr("display",(function(e){return i?"inline":"none"}))}color_scale_updated(e){const t=this.model.get("fill"),s=this.model.get("stroke"),i=!0===e?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").select("path").transition("color_scale_updated").duration(i).style("fill",t?this.get_mark_color.bind(this):"none").style("stroke",s||this.get_mark_color.bind(this))}draw_elements(e,t){const s=this,i=!0===e?this.parent.model.get("animation_duration"):0,a=this.d3el.selectAll(".object_grp");t.append("path").attr("class","dot element"),t.append("text").attr("class","dot_text"),a.select("path").transition("draw_elements").duration(i).attr("d",this.dot.size((function(e){return s.get_element_size(e)})).skew((function(e){return s.get_element_skew(e)}))),this.update_names(e),this.apply_styles()}draw_legend_elements(e,t){const s=this.model.get("colors"),i=s.length,a=this.model.get("stroke");e.append("path").attr("transform",(function(e,s){return"translate( "+t/2+", "+t/2+")"})).attr("d",this.dot.size(64)).style("fill",this.model.get("fill")?function(e,t){return s[t%i]}:"none").style("stroke",a||function(e,t){return s[t%i]})}set_default_style(e){if(!e||0===e.length)return;const t=this.d3el.selectAll(".element").filter((function(t,s){return-1!==e.indexOf(s)})),s=this.model.get("fill"),i=this.model.get("stroke"),a=this.model.get("stroke_width"),r=this;t.style("fill",s?this.get_mark_color.bind(this):"none").style("stroke",i||this.get_mark_color.bind(this)).style("opacity",(function(e,t){return r.get_element_opacity(e,t)})).style("stroke-width",a)}set_drag_style(e,t,s){o.select(s).select("path").classed("drag_scatter",!0).transition("set_drag_style").attr("d",this.dot.size(5*this.model.get("default_size")));const i=this.model.get("drag_color");i&&o.select(s).select("path").style("fill",i).style("stroke",i)}reset_drag_style(e,t,s){const i=this.model.get("stroke"),a=this.get_mark_color(e,t);o.select(s).select("path").classed("drag_scatter",!1).transition("reset_drag_style").attr("d",this.dot.size(this.get_element_size(e))),this.model.get("drag_color")&&o.select(s).select("path").style("fill",a).style("stroke",i||a)}}t.Scatter=c},461:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScatterBase=void 0;const n=r(s(8944));s(2802);const l=function(){return s(8556).B}.bind(this),o=s(3332),d=r(s(8731));class c extends o.Mark{render(){const e=super.render(),t=this;return this.drag_listener=n.drag().subject((function(e){return{x:t.x_scale.scale(e.x),y:t.y_scale.scale(e.y)}})).on("start",(function(e,s){return t.drag_start(e,s,this)})).on("drag",(function(e,s){return t.on_drag(e,s,this)})).on("end",(function(e,s){return t.drag_ended(e,s,this)})),this.selected_style=this.model.get("selected_style"),this.unselected_style=this.model.get("unselected_style"),this.selected_indices=this.model.get("selected"),this.hovered_style=this.model.get("hovered_style"),this.unhovered_style=this.model.get("unhovered_style"),this.hovered_index=this.model.get("hovered_point")?[this.model.get("hovered_point")]:null,this.display_el_classes=["dot","legendtext"],this.event_metadata={mouse_over:{msg_name:"hover",lookup_data:!1,hit_test:!0},legend_clicked:{msg_name:"legend_click",hit_test:!0},element_clicked:{msg_name:"element_click",lookup_data:!1,hit_test:!0},parent_clicked:{msg_name:"background_click",hit_test:!1}},this.displayed.then((()=>{this.parent.tooltip_div.node().appendChild(this.tooltip_div.node()),this.create_tooltip()})),e.then((()=>{this.event_listeners={},this.process_interactions(),this.create_listeners(),this.compute_view_padding(),this.draw()}))}set_ranges(){const e=this.scales.x,t=this.scales.y,s=this.scales.size,i=this.scales.opacity,a=this.scales.skew,r=this.scales.rotation;e&&e.set_range(this.parent.padded_range("x",e.model)),t&&t.set_range(this.parent.padded_range("y",t.model)),s&&s.set_range([0,this.model.get("default_size")]),i&&i.set_range([.2,1]),a&&a.set_range([0,1]),r&&r.set_range([0,180])}set_positional_scales(){this.x_scale=this.scales.x,this.y_scale=this.scales.y,this.x_scale||(this.x_scale=this.parent.scale_x),this.y_scale||(this.y_scale=this.parent.scale_y),this.listenTo(this.x_scale,"domain_changed",(()=>{if(!this.model.dirty){const e=!0;this.update_position(e)}})),this.listenTo(this.y_scale,"domain_changed",(()=>{if(!this.model.dirty){const e=!0;this.update_position(e)}}))}initialize_additional_scales(){const e=this.scales.color,t=this.scales.size,s=this.scales.opacity,i=this.scales.skew,a=this.scales.rotation;e&&(this.listenTo(e,"domain_changed",(()=>{this.model.dirty||this.color_scale_updated(!0)})),e.on("color_scale_range_changed",this.color_scale_updated,this)),t&&this.listenTo(t,"domain_changed",(()=>{this.update_default_size(!0)})),s&&this.listenTo(s,"domain_changed",(()=>{this.update_opacities(!0)})),i&&this.listenTo(i,"domain_changed",(()=>{this.update_default_skew(!0)})),a&&this.listenTo(a,"domain_changed",(()=>{this.update_position(!0)}))}create_listeners(){super.create_listeners(),this.d3el.on("mouseover",(()=>{this.event_dispatcher("mouse_over")})).on("mousemove",(()=>{this.event_dispatcher("mouse_move")})).on("mouseout",(()=>{this.event_dispatcher("mouse_out")})),this.listenTo(this.model,"data_updated",(()=>{this.draw(!0)})),this.listenTo(this.model,"change:tooltip",this.create_tooltip),this.listenTo(this.model,"change:enable_hover",(()=>{this.hide_tooltip()})),this.listenTo(this.model,"change:interactions",this.process_interactions),this.listenTo(this.model,"change:enable_move",this.set_drag_behavior),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:hovered_point",this.update_hovered),this.listenTo(this.model,"change:hovered_style",this.hovered_style_updated),this.listenTo(this.model,"change:unhovered_style",this.unhovered_style_updated),this.listenTo(this.parent,"bg_clicked",(()=>{this.event_dispatcher("parent_clicked")}))}get_element_size(e){const t=this.scales.size;return t&&void 0!==e.size?t.scale(e.size):this.model.get("default_size")}get_element_opacity(e,t){const s=this.scales.opacity,i=this.model.get("opacities"),a=i.length;return s&&void 0!==e.opacity?s.scale(e.opacity):i[t%a]}get_element_skew(e){const t=this.scales.skew;return t&&void 0!==e.skew?t.scale(e.skew):this.model.get("default_skew")}get_element_rotation(e){const t=this.scales.rotation;return t&&e.rotation?"rotate("+t.scale(e.rotation)+")":""}relayout(){this.set_ranges(),this.update_position()}update_position(e){const t=this.scales.x,s=this.scales.y,i=!0===e?this.parent.model.get("animation_duration"):0;this.d3el.selectAll(".object_grp").transition("update_position").duration(i).attr("transform",(e=>"translate("+(t.scale(e.x)+t.offset)+","+(s.scale(e.y)+s.offset)+")"+this.get_element_rotation(e))),this.x_pixels=this.model.mark_data.map((e=>t.scale(e.x)+t.offset)),this.y_pixels=this.model.mark_data.map((e=>s.scale(e.y)+s.offset)),this.pixel_coords=this.model.mark_data.map((e=>[t.scale(e.x)+t.offset,s.scale(e.y)+s.offset]))}draw(e){this.set_ranges();const t=this.d3el.selectAll(".object_grp").data(this.model.mark_data,(e=>e.unique_id)),s=t.enter().append("g").attr("class","object_grp");this.update_position(e),this.set_drag_behavior(),s.on("click",((e,t)=>{this.event_dispatcher("element_clicked",{data:e,index:t})})),s.on("mouseover",((e,t)=>{this.scatter_hover_handler({data:e,index:t})})),s.on("mouseout",(()=>{this.reset_hover_points()})),this.draw_elements(e,s),t.exit().remove()}draw_elements(e,t){}process_click(e){switch(super.process_click(e),e){case"add":this.event_listeners.parent_clicked=this.add_element,this.event_listeners.element_clicked=()=>{};break;case"delete":this.event_listeners.parent_clicked=()=>{},this.event_listeners.element_clicked=this.delete_element;break;case"select":this.event_listeners.parent_clicked=this.reset_selection,this.event_listeners.element_clicked=this.scatter_click_handler}}reset_hover_points(){this.model.set("hovered_point",null),this.hovered_index=null,this.touch()}scatter_hover_handler(e){const t=e.index;this.model.set("hovered_point",t,{updated_view:this}),this.touch()}reset_selection(){this.model.set("selected",null),this.selected_indices=null,this.touch()}scatter_click_handler(e){const t=e.index,s=this.model.get("selected")||[];let i=Array.from(s);const a=i.indexOf(t),r=l().ctrlKey||l().metaKey;a>-1&&r?i.splice(a,1):(r||(i=[]),i.push(t)),this.model.set("selected",0===i.length?null:new Uint32Array(i),{updated_view:this}),this.touch();let n=l();n||(n=window.event),void 0!==n.cancelBubble&&(n.cancelBubble=!0),n.stopPropagation&&n.stopPropagation(),n.preventDefault()}hovered_style_updated(e,t){this.hovered_style=t,this.clear_style(e.previous("hovered_style"),this.hovered_index),this.style_updated(t,this.hovered_index)}unhovered_style_updated(e,t){this.unhovered_style=t;const s=this.hovered_index,i=s?d.range(this.model.mark_data.length).filter((e=>-1===s.indexOf(e))):[];this.clear_style(e.previous("unhovered_style"),i),this.style_updated(t,i)}draw_legend(e,t,s,i,a){this.legend_el=e.selectAll(".legend"+this.uuid).data([this.model.mark_data[0]]);const r=this.model.get("colors"),l=r.length,o=.8*a,d=this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",((e,t)=>"translate(0, "+(t*a+s)+")")).on("mouseover",(()=>{this.event_dispatcher("legend_mouse_over")})).on("mouseout",(()=>{this.event_dispatcher("legend_mouse_out")})).on("click",(()=>{this.event_dispatcher("legend_clicked")}));this.draw_legend_elements(d,o),d.append("text").attr("class","legendtext").attr("x",1.2*o).attr("y",o/2).attr("dy","0.35em").text(((e,t)=>this.model.get("labels")[t])).style("fill",((e,t)=>r[t%l])),this.legend_el=d.merge(this.legend_el);const c=n.max(this.model.get("labels"),(e=>Number(e.length)));return this.legend_el.exit().remove(),[1,c]}draw_legend_elements(e,t){}invert_point(e){if(void 0===e)return this.model.set("selected",null),void this.touch();const t=this.x_pixels.map((t=>Math.abs(t-e))),s=t.indexOf(n.min(t));this.model.set("selected",new Uint32Array([s])),this.touch()}selector_changed(e,t){if(void 0===e)return this.model.set("selected",null),this.touch(),[];const s=this.pixel_coords,i=new Uint32Array(d.range(s.length)).filter((t=>e(s[t])));this.model.set("selected",i),this.touch()}update_selected(e,t){this.selected_indices=t,this.apply_styles()}update_hovered(e,t){this.hovered_index=null===t?t:[t],this.apply_styles()}apply_styles(e){void 0!==e&&null!=e||(e=[this.selected_style,this.unselected_style,this.hovered_style,this.unhovered_style]),super.apply_styles([e]);const t=d.range(this.model.mark_data.length);this.set_style_on_elements(this.hovered_style,this.hovered_index);const s=this.hovered_index?d.difference(t,this.hovered_index):[];this.set_style_on_elements(this.unhovered_style,s)}clear_style(e,t){let s=this.d3el.selectAll(".element");t&&(s=s.filter(((e,s)=>-1!==t.indexOf(s))));const i={};for(let t in e)i[t]=null;s.styles(i)}set_style_on_elements(e,t){if(!t||0===t.length)return;if(0===Object.keys(e).length)return;let s=this.d3el.selectAll(".element");s=s.filter(((e,s)=>-1!==t.indexOf(s))),s.styles(e)}compute_view_padding(){const e=Math.sqrt(this.model.get("default_size"))/2+1;e===this.x_padding&&e===this.y_padding||(this.x_padding=e,this.y_padding=e,this.trigger("mark_padding_updated"))}update_array(e,t){const s=this.scales.x,i=this.scales.y;if(!this.model.get("restrict_y")){const i=Object.assign(this.model.get("x").slice(),this.model.get("x"));i[t]=s.invert(e[0]),this.model.set("x",i)}if(!this.model.get("restrict_x")){const s=Object.assign(this.model.get("y").slice(),this.model.get("y"));s[t]=i.invert(e[1]),this.model.set("y",s)}this.touch()}set_drag_behavior(){const e=this.d3el.selectAll(".object_grp");this.model.get("enable_move")?e.call(this.drag_listener):e.on(".drag",null)}set_drag_style(e,t,s){}reset_drag_style(e,t,s){}drag_start(e,t,s){const i=this.scales.x,a=this.scales.y;e[0]=i.scale(e.x)+i.offset,e[1]=a.scale(e.y)+a.offset,this.set_drag_style(e,t,s),this.send({event:"drag_start",point:{x:e.x,y:e.y},index:t})}on_drag(e,t,s){const i=this.scales.x,a=this.scales.y,r=this.model.get("restrict_x"),o=this.model.get("restrict_y");r&&o||(o||(e[0]=l().x),r||(e[1]=l().y),n.select(s).attr("transform",(()=>"translate("+e[0]+","+e[1]+")")),this.send({event:"drag",origin:{x:e.x,y:e.y},point:{x:i.invert(e[0]),y:a.invert(e[1])},index:t}),this.model.get("update_on_move")&&this.update_array(e,t))}drag_ended(e,t,s){const i=this.scales.x,a=this.scales.y;this.reset_drag_style(e,t,s),this.update_array(e,t),this.send({event:"drag_end",point:{x:i.invert(e[0]),y:a.invert(e[1])},index:t})}selected_deleter(){l().stopPropagation()}add_element(){const e=n.mouse(this.el),t=[e[0],e[1]],s=this.scales.x,i=this.scales.y,a=this.model.get("x"),r=this.model.get("y"),l=new a.constructor(a.length+1),o=new r.constructor(r.length+1);l.set(a),o.set(r),l[a.length]=s.invert(t[0]),o[r.length]=i.invert(t[1]),this.model.set("x",l),this.model.set("y",o),this.touch()}delete_element(e){const t=e.index;let s=Object.assign(this.model.get("x").slice(),this.model.get("x")),i=Object.assign(this.model.get("y").slice(),this.model.get("y"));s.copyWithin(t,t+1,s.length),i.copyWithin(t,t+1,i.length),s=s.slice(0,s.length-1),i=i.slice(0,i.length-1),this.model.set("x",s),this.model.set("y",i),this.touch()}}t.ScatterBase=c},6850:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScatterBaseModel=void 0;const n=s(9250),l=r(s(1961));class o extends n.MarkModel{defaults(){return Object.assign(Object.assign({},n.MarkModel.prototype.defaults()),{_model_name:"ScatterBaseModel",_view_name:"ScatterBase",x:[],y:[],color:null,opacity:null,size:null,rotation:null,hovered_point:null,scales_metadata:{x:{orientation:"horizontal",dimension:"x"},y:{orientation:"vertical",dimension:"y"},color:{dimension:"color"},size:{dimension:"size"},opacity:{dimension:"opacity"},rotation:{dimension:"rotation"}},label_display_horizontal_offset:null,label_display_vertical_offset:null,hovered_style:{},unhovered_style:{},colors:["steelblue"],opacities:[1],enable_move:!1,enable_delete:!1,restrict_x:!1,restrict_y:!1,update_on_move:!1})}initialize(e,t){super.initialize(e,t),this.on_some_change(["x","y","color","opacity","size","rotation"],this.update_data,this),this.on_some_change(["preserve_domain"],this.update_domains,this),this.update_data()}update_mark_data(){let e=this.get("x");const t=this.get("y");if(0===e.length||0===t.length)this.mark_data=[];else{const s=Math.min(e.length,t.length);e=e.slice(0,s);const i=this.get("color")||[],a=this.get("size")||[],r=this.get("opacity")||[],n=this.get("rotation")||[];this.mark_data=Array.prototype.map.call(e,(function(e,s){return{x:e,y:t[s],color:i[s],size:a[s],opacity:r[s],rotation:n[s],index:s}}))}}update_data(){this.dirty=!0,this.update_mark_data(),this.update_unique_ids(),this.update_domains(),this.dirty=!1,this.trigger("data_updated")}update_unique_ids(){}get_data_dict(e,t){return e}update_domains(){if(!this.mark_data)return;const e=this.get("scales");for(let t in e)if(e.hasOwnProperty(t)){const s=e[t];this.get("preserve_domain")[t]?s.del_domain([],this.model_id+t):s.compute_and_set_domain(this.mark_data.map((function(e){return e[t]})),this.model_id+t)}}}t.ScatterBaseModel=o,o.serializers=Object.assign(Object.assign({},n.MarkModel.serializers),{x:l.array_or_json,y:l.array_or_json,color:l.array_or_json,opacity:l.array_or_json,size:l.array_or_json,rotation:l.array_or_json,opacities:l.array_or_json})},9582:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScatterGL=void 0;const n=s(3332),l=r(s(8944)),o=r(s(3731)),d=r(s(8731)),c=s(6988),h=r(s(5384)),_=o.symbol,u=function(e){if(e instanceof Float32Array)return e;if("function"==typeof e[Symbol.iterator]){const t=e.length;let s=new Float32Array(t);for(let i=0;i<t;i++)s[i]=e[i];return s}return new Float32Array(e)},g=function(e,t){const s=e||t||[0,0,0,0];if("none"==s)return[0,0,0,0];{const e=new h.Color(s);return[e.r,e.g,e.b,1]}};class m{constructor(e,t=1,s=1,i=!1){this.array=e,this.item_size=t,this.mesh_per_attribute=s,this.normalized=i}}class p extends m{constructor(e,t=1,s=1,i=!1,a=!0){super(e,t,s,i),this.use_colormap=a}}class f extends m{constructor(e,t=1,s=1,i=!1,a=!0){super(e,t,s,i),this.use_selection=a}}class b extends n.Mark{render(){const e=super.render();this.transitions=[],this.invalidated_pixel_position=!0,this.dot=_().type(this.model.get("marker")),this.instanced_geometry=new h.InstancedBufferGeometry;const t=new Float32Array([-.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0]);this.instanced_geometry.addAttribute("position",new h.Float32BufferAttribute(t,3));const i=new Float32Array([0,1,1,1,0,0,1,0]);this.instanced_geometry.addAttribute("uv",new h.Float32BufferAttribute(i,2));const a=new Uint16Array([0,2,1,2,3,1]);return this.instanced_geometry.index=new h.Uint16BufferAttribute(a,1),this.scatter_material=new h.RawShaderMaterial({uniforms:{domain_x:{type:"2f",value:[0,10]},domain_y:{type:"2f",value:[-12,12]},domain_z:{type:"2f",value:[0,1]},domain_size:{type:"2f",value:[0,1]},domain_color:{type:"2f",value:[0,1]},domain_rotation:{type:"2f",value:[0,180]},domain_opacity:{type:"2f",value:[0,1]},range_x:{type:"2f",value:[0,1]},range_y:{type:"2f",value:[0,1]},range_z:{type:"2f",value:[0,1]},range_size:{type:"2f",value:[0,1]},range_rotation:{type:"2f",value:[0,Math.PI]},range_opacity:{type:"2f",value:[0,1]},animation_time_x:{type:"f",value:1},animation_time_y:{type:"f",value:1},animation_time_z:{type:"f",value:1},animation_time_size:{type:"f",value:1},animation_time_color:{type:"f",value:1},animation_time_rotation:{type:"f",value:1},animation_time_opacity:{type:"f",value:1},has_selection:{type:"b",value:!1},has_hover:{type:"b",value:!1},has_selected_fill:{type:"b",value:!1},has_selected_stroke:{type:"b",value:!1},has_selected_opacity:{type:"b",value:!1},has_unselected_fill:{type:"b",value:!1},has_unselected_stroke:{type:"b",value:!1},has_unselected_opacity:{type:"b",value:!1},has_hovered_fill:{type:"b",value:!1},has_hovered_stroke:{type:"b",value:!1},has_hovered_opacity:{type:"b",value:!1},has_unhovered_fill:{type:"b",value:!1},has_unhovered_stroke:{type:"b",value:!1},has_unhovered_opacity:{type:"b",value:!1},selected_fill:{type:"4f",value:[1,0,0,1]},selected_stroke:{type:"4f",value:[1,0,0,1]},selected_opacity:{value:1},unselected_fill:{type:"4f",value:[1,0,0,1]},unselected_stroke:{type:"4f",value:[1,0,0,1]},unselected_opacity:{value:1},hovered_fill:{type:"4f",value:[0,1,0,1]},hovered_opacity:{value:1},hovered_stroke:{type:"4f",value:[0,1,0,1]},unhovered_fill:{type:"4f",value:[0,1,0,1]},unhovered_stroke:{type:"4f",value:[0,1,0,1]},unhovered_opacity:{value:1},default_stroke_color:{type:"4f",value:[0,0,0,0]},colormap:{type:"t",value:null},fill:{type:"b",value:!0},stroke_width:{type:"f",value:1.5},marker_scale:{type:"f",value:1}},vertexShader:s(2506).Z,fragmentShader:s(5289).Z,transparent:!0,depthTest:!1,depthWrite:!1,blending:h.CustomBlending,blendEquation:h.AddEquation,blendSrc:h.OneFactor,blendDst:h.OneMinusSrcAlphaFactor,blendEquationAlpha:h.AddEquation,blendSrcAlpha:h.OneFactor,blendDstAlpha:h.OneMinusSrcAlphaFactor}),this.mesh=new h.Mesh(this.instanced_geometry,this.scatter_material),e.then((()=>{this.camera=new h.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.camera.position.z=10,this.scene=new h.Scene;const e=new m(u(this.model.get("x")));this.x=this.initialize_attribute("x",e),this.x_previous=this.initialize_attribute("x_previous",e);const t=new m(u(this.model.get("y")));this.y=this.initialize_attribute("y",t),this.y_previous=this.initialize_attribute("y_previous",t),this.markers_number=Math.min(this.x.array.length,this.y.array.length),this.instanced_geometry.maxInstancedCount=this.markers_number;const s=this.get_color_attribute_parameters();this.color=this.initialize_attribute("color",s),this.scatter_material.defines.USE_COLORMAP=s.use_colormap;const i=this.get_opacity_attribute_parameters();this.opacity=this.initialize_attribute("opacity",i),this.opacity_previous=this.initialize_attribute("opacity_previous",i);const a=this.get_size_attribute_parameters();this.size=this.initialize_attribute("size",a),this.size_previous=this.initialize_attribute("size_previous",a);const r=this.get_rotation_attribute_parameters();this.rotation=this.initialize_attribute("rotation",r),this.rotation_previous=this.initialize_attribute("rotation_previous",r);const n=this.get_selected_attribute_parameters();this.selected=this.initialize_attribute("selected",n),this.scatter_material.uniforms.has_selection.value=n.use_selection,this.scatter_material.needsUpdate=!0,this.scene.add(this.mesh),this.create_listeners(),this.compute_view_padding(),this.update_scene(),this.listenTo(this.parent,"margin_updated",(()=>{this.update_scene()}))}))}initialize_attribute(e,t){const s=new h.InstancedBufferAttribute(t.array,t.item_size,t.mesh_per_attribute);return s.normalized=t.normalized,s.dynamic=!0,this.instanced_geometry.addAttribute(e,s),s}get_color_attribute_parameters(){if(this.model.get("color")){const e=this.model.get("color");let t;return e.length<this.markers_number?(t=u(this.markers_number),t.set(e)):t=u(e),new p(t,1,1,!0,!0)}{let e,t,s=this.model.get("colors");if(!s){const e=(this.model.get("unselected_style")||{}).fill||"orange";s=[e]}if(1==s.length){const i=new h.Color(s[0]);e=u([i.r,i.g,i.b]),t=this.markers_number}else e=u(3*this.markers_number),d.each(d.range(this.markers_number),(t=>{const i=new h.Color(s[t%s.length]);e[3*t+0]=i.r,e[3*t+1]=i.g,e[3*t+2]=i.b})),t=1;return new p(e,3,t,!1,!1)}}get_opacity_attribute_parameters(){let e=this.model.get("opacities")||[1];if(0==e.length&&(e=[1]),this.model.get("opacity")){const t=this.model.get("opacity");let s;return t.length<this.markers_number?(s=u(this.markers_number),s.set(t),d.each(d.range(this.markers_number-t.length),(i=>{i+=t.length,s[i]=e[i%e.length]}))):s=u(t),new m(s,1,1)}{let t,s;return 1==e.length?(t=u(e),s=this.markers_number):(t=u(this.markers_number),s=1,d.each(d.range(this.markers_number),(s=>{t[s]=e[s%e.length]}))),new m(t,1,s)}}get_size_attribute_parameters(){if(this.model.get("size")){const e=this.model.get("size");let t;return e.length<this.markers_number?(t=u(this.markers_number),t.fill(this.model.get("default_size")),t.set(e)):t=u(e),new m(t,1,1)}return new m(u([this.model.get("default_size")]),1,this.markers_number)}get_rotation_attribute_parameters(){if(this.model.get("rotation")){const e=this.model.get("rotation");let t;return e.length<this.markers_number?(t=u(this.markers_number),t.set(e)):t=u(e),new m(t,1,1)}return new m(u(1),1,this.markers_number)}get_selected_attribute_parameters(){if(this.model.get("selected")){const e=this.model.get("selected"),t=u(this.markers_number);for(let s=0;s<e.length;s++)e[s]<t.length&&(t[e[s]]=1);return new f(t,1,1,!1,!0)}return new f(u(1),1,this.markers_number,!1,!1)}update_scene(){this.parent.update_gl()}render_gl(){this.set_ranges();const e=this.parent,t=this.scales.x?this.scales.x:this.parent.scale_x,s=this.scales.y?this.scales.y:this.parent.scale_y,i=this.parent.padded_range("x",t.model),a=this.parent.padded_range("y",s.model);if(d.each(["selected","hovered"],(e=>{d.each(["stroke","fill","opacity"],(t=>{this.scatter_material.uniforms[`has_${e}_${t}`].value=Boolean(this.model.get(`${e}_style`)[t]),this.scatter_material.uniforms[`has_un${e}_${t}`].value=Boolean(this.model.get(`un${e}_style`)[t]),d.contains(["opacity"],t)?(this.scatter_material.uniforms[`${e}_${t}`].value=this.model.get(`${e}_style`)[t],this.scatter_material.uniforms[`un${e}_${t}`].value=this.model.get(`un${e}_style`)[t]):(this.scatter_material.uniforms[`${e}_${t}`].value=g(this.model.get(`${e}_style`)[t],"green"),this.scatter_material.uniforms[`un${e}_${t}`].value=g(this.model.get(`un${e}_style`)[t],"green"))}))})),this.camera.left=0,this.camera.right=e.plotarea_width,this.camera.bottom=0,this.camera.top=e.plotarea_height,this.camera.updateProjectionMatrix(),this.scatter_material.uniforms.range_x.value=i,this.scatter_material.uniforms.range_y.value=[a[1],a[0]],this.scatter_material.uniforms.domain_x.value=t.scale.domain(),this.scatter_material.uniforms.domain_y.value=s.scale.domain(),this.scales.size)this.scatter_material.uniforms.range_size.value=this.scales.size.scale.range(),this.scatter_material.uniforms.domain_size.value=this.scales.size.scale.domain();else{const e=this.model.get("default_size");this.scatter_material.uniforms.range_size.value=[0,e],this.scatter_material.uniforms.domain_size.value=[0,e]}this.scales.rotation&&(this.scatter_material.uniforms.range_rotation.value=this.scales.rotation.scale.range(),this.scatter_material.uniforms.domain_rotation.value=this.scales.rotation.scale.domain()),this.scales.opacity&&(this.scatter_material.uniforms.range_opacity.value=this.scales.opacity.scale.range(),this.scatter_material.uniforms.domain_opacity.value=this.scales.opacity.scale.domain()),e.renderer.render(this.scene,this.camera);const r=[];for(let e=0;e<this.transitions.length;e++){const t=this.transitions[e];t.is_done()||r.push(t),t.update()}this.transitions=r,this.transitions.length>0&&this.update_scene()}create_listeners(){super.create_listeners(),this.listenTo(this.model,"change:x",this.update_x),this.listenTo(this.model,"change:y",this.update_y),this.listenTo(this.model,"change:color change:colors change:unselected_style",this.update_color),this.listenTo(this.model,"change:opacity change:opacities",this.update_opacity),this.listenTo(this.model,"change:size change:default_size",this.update_size),this.listenTo(this.model,"change:rotation",this.update_rotation),this.listenTo(this.model,"change:selected",this.update_selected),this.listenTo(this.model,"change:marker",this.update_marker),this.update_marker(),this.listenTo(this.model,"change:stroke",this.update_stroke),this.update_stroke(),this.listenTo(this.model,"change:stroke_width",this.update_stroke_width),this.update_stroke_width();const e=()=>{this.mesh.visible=this.model.get("visible"),this.update_scene()};this.listenTo(this.model,"change:visible",e),e();const t=()=>{this.scatter_material.defines.FILL=this.model.get("fill")?1:0,this.scatter_material.needsUpdate=!0,this.update_scene()};this.listenTo(this.model,"change:fill",t),t(),this.listenTo(this.model,"change",this.update_legend)}update_attribute(e,t,s){return t.meshPerAttribute!=s.mesh_per_attribute||t.array.length<s.array.length?t=this.initialize_attribute(e,s):(t.itemSize=s.item_size,t.setArray(s.array)),t.needsUpdate=!0,t}update_attributes(e,t,s,i,a=!0,r=(()=>{})){if(a){if(t.array.length<i.array.length&&t.meshPerAttribute==i.mesh_per_attribute){const a=c.deepCopy(i.array);a.set(t.array),s=this.update_attribute(e+"_previous",s,new m(a,t.itemSize,t.meshPerAttribute,t.normalized))}else s=t.array.length==i.array.length&&t.meshPerAttribute!=i.mesh_per_attribute?this.update_attribute(e+"_previous",s,new m(t.array,t.itemSize,i.mesh_per_attribute,t.normalized)):this.update_attribute(e+"_previous",s,new m(t.array,t.itemSize,t.meshPerAttribute,t.normalized));t=this.update_attribute(e,t,i),this.animate_attribute(e,r)}else s=this.update_attribute(e+"_previous",s,i),t=this.update_attribute(e,t,i);return[t,s]}animate_attribute(e,t=(()=>{})){this.scatter_material.uniforms["animation_time_"+e].value=0,this.transition((t=>{this.scatter_material.uniforms["animation_time_"+e].value=t}),t,this)}update_x(e=!0){const t=u(this.model.get("x")),s=Math.min(t.length,this.y.array.length);this.markers_number!=s&&this.update_markers_number(s),[this.x,this.x_previous]=this.update_attributes("x",this.x,this.x_previous,new m(t,1,1)),e&&this.update_scene()}update_y(e=!0){const t=u(this.model.get("y")),s=Math.min(this.x.array.length,t.length);this.markers_number!=s&&this.update_markers_number(s),[this.y,this.y_previous]=this.update_attributes("y",this.y,this.y_previous,new m(t,1,1)),e&&this.update_scene()}update_markers_number(e){const t=this.markers_number;this.markers_number=e,this.instanced_geometry.maxInstancedCount=e,this.markers_number>t&&(this.update_color(!1),this.update_opacity(!1),this.update_size(!1),this.update_rotation(!1),this.update_selected(!1))}update_color(e=!0){const t=this.get_color_attribute_parameters();this.color=this.update_attribute("color",this.color,t),this.color.normalized=t.normalized,this.scatter_material.defines.USE_COLORMAP=t.use_colormap,this.scatter_material.needsUpdate=!0,e&&this.update_scene()}update_opacity(e=!0){const t=this.get_opacity_attribute_parameters();[this.opacity,this.opacity_previous]=this.update_attributes("opacity",this.opacity,this.opacity_previous,t),e&&this.update_scene()}update_size(e=!0){const t=this.get_size_attribute_parameters();[this.size,this.size_previous]=this.update_attributes("size",this.size,this.size_previous,t),e&&this.update_scene()}update_rotation(e=!0){const t=this.get_rotation_attribute_parameters();[this.rotation,this.rotation_previous]=this.update_attributes("rotation",this.rotation,this.rotation_previous,t),e&&this.update_scene()}update_selected(e=!0){const t=this.get_selected_attribute_parameters();this.selected=this.update_attribute("selected",this.selected,t),this.scatter_material.uniforms.has_selection.value=t.use_selection,e&&this.update_scene()}update_marker(){const e=this.model.get("marker");this.dot.type(e),"circle"===e&&(this.scatter_material.uniforms.marker_scale.value=1/Math.sqrt(Math.PI),this.scatter_material.defines.FAST_DRAW=1),"square"===e&&(this.scatter_material.uniforms.marker_scale.value=.5,this.scatter_material.defines.FAST_DRAW=2),"arrow"===e&&(this.scatter_material.uniforms.marker_scale.value=2,this.scatter_material.defines.FAST_DRAW=3),"cross"===e&&(this.scatter_material.uniforms.marker_scale.value=3/(2*Math.sqrt(5)),this.scatter_material.defines.FAST_DRAW=4),"triangle-up"===e&&(this.scatter_material.uniforms.marker_scale.value=2,this.scatter_material.defines.FAST_DRAW=5),"triangle-down"===e&&(this.scatter_material.uniforms.marker_scale.value=2,this.scatter_material.defines.FAST_DRAW=6),this.scatter_material.needsUpdate=!0,this.update_scene()}update_stroke(){const e=this.model.get("stroke");e?(this.scatter_material.uniforms.default_stroke_color.value=g(e),this.scatter_material.defines.HAS_DEFAULT_STROKE_COLOR=!0):this.scatter_material.defines.HAS_DEFAULT_STROKE_COLOR=!1,this.scatter_material.needsUpdate=!0,this.update_scene()}update_stroke_width(){this.scatter_material.uniforms.stroke_width.value=this.model.get("stroke_width"),this.update_scene()}update_color_map(){if(this.scatter_material.uniforms.colormap.value=function(e){const t=e?e.model.color_range:["#ff0000","#ff0000"],s=l.scaleLinear().range(t).domain(d.range(t.length).map((e=>e/(t.length-1)))),i=[];d.map(d.range(256),(e=>{const t=e/255,a=l.color(String(s(t))).hex(),r=String(a),n=[parseInt("0x"+r.substring(1,3)),parseInt("0x"+r.substring(3,5)),parseInt("0x"+r.substring(5,7))];i.push(n[0],n[1],n[2])}));const a=new Uint8Array(i),r=new h.DataTexture(a,256,1,h.RGBFormat,h.UnsignedByteType);return r.needsUpdate=!0,r}(this.scales.color),this.scales.color){const e=this.model.get("color");if(e){let t,s;t=null!==this.scales.color.model.min?this.scales.color.model.min:Math.min(...e),s=null!==this.scales.color.model.max?this.scales.color.model.max:Math.max(...e),this.scatter_material.uniforms.domain_color.value=[t,s]}else null!==this.scales.color.model.min&&null!==this.scales.color.model.max?this.scatter_material.uniforms.domain_color.value=[this.scales.color.model.min,this.scales.color.model.max]:console.warn("no color set, and color scale does not have a min or max")}this.update_scene()}update_position(e){this.update_scene(),this.invalidate_pixel_position()}invalidate_pixel_position(){this.invalidated_pixel_position=!0}ensure_pixel_position(){this.invalidated_pixel_position&&this.update_pixel_position()}update_pixel_position(e){const t=this.scales.x,s=this.scales.y,i=this.model.get("x"),a=this.model.get("y"),r=Math.min(i.length,a.length);this.pixel_x=new Float64Array(r),this.pixel_y=new Float64Array(r);for(let e=0;e<r;e++)this.pixel_x[e]=t.scale(i[e])+t.offset,this.pixel_y[e]=s.scale(a[e])+s.offset;this.invalidated_pixel_position=!1}selector_changed(e,t){this.trottled_selector_changed||(this.trottled_selector_changed=d.throttle(this._real_selector_changed,50,{leading:!1})),this.trottled_selector_changed(e,t)}_real_selector_changed(e,t){if(this.ensure_pixel_position(),void 0===e)return this.model.set("selected",null),this.touch(),[];const s=e(this.pixel_x,this.pixel_y);let i=new Uint32Array(s.length),a=0;const r=s.length;for(let e=0;e<r;e++)s[e]&&(i[a++]=e);i=i.slice(0,a),this.model.set("selected",i),this.touch()}set_positional_scales(){this.x_scale=this.scales.x,this.y_scale=this.scales.y,this.x_scale||(this.x_scale=this.parent.scale_x),this.y_scale||(this.y_scale=this.parent.scale_y),this.listenTo(this.x_scale,"domain_changed",(function(){if(!this.model.dirty){const e=!0;this.update_position(e)}})),this.listenTo(this.y_scale,"domain_changed",(function(){if(!this.model.dirty){const e=!0;this.update_position(e)}}))}initialize_additional_scales(){const e=this.scales.color,t=this.scales.size,s=this.scales.opacity,i=this.scales.rotation;e&&(this.listenTo(e,"all",this.update_color_map),this.listenTo(this.model,"change:color",this.update_color_map),this.update_color_map()),t&&this.listenTo(t,"domain_changed",(()=>{this.update_scene()})),s&&this.listenTo(s,"domain_changed",(()=>{this.update_scene()})),i&&this.listenTo(i,"domain_changed",(()=>{this.update_scene()}))}set_ranges(){const e=this.scales.x,t=this.scales.y,s=this.scales.size,i=this.scales.opacity,a=this.scales.skew,r=this.scales.rotation;e&&e.set_range(this.parent.padded_range("x",e.model)),t&&t.set_range(this.parent.padded_range("y",t.model)),s&&s.set_range([0,this.model.get("default_size")]),i&&i.set_range([.2,1]),a&&a.set_range([0,1]),r&&r.set_range([0,Math.PI])}transition(e,t,s){const i=this;return new function(){this.time_start=(new Date).getTime(),this.duration=i.parent.model.get("animation_duration"),this.cancelled=!1,this.called_on_done=!1,this.set=function(e){this.objects.push(e)},this.is_done=function(){return(new Date).getTime()-this.time_start>=this.duration||this.cancelled},this.cancel=function(){this.cancelled=!0},this.update=function(){if(this.cancelled)return;const a=((new Date).getTime()-this.time_start)/this.duration,r=Math.min(1,a);e.apply(s,[r]),a>=1&&!this.called_on_done&&(this.called_on_done=!0,t.apply(s)),i.update_scene()},this.duration?i.transitions.push(this):(e.apply(s,[1]),t.apply(s),i.update_scene())}}draw_legend(e,t,s,i,a){this.legend_el=e.selectAll(".legend"+this.uuid).data([{}]);const r=this.model.get("colors"),n=r.length,o=this,d=.8*a,c=this.legend_el.enter().append("g").attr("class","legend"+this.uuid).attr("transform",(function(e,t){return"translate(0, "+(t*a+s)+")"}));this.draw_legend_elements(c,d),this.legend_el.append("text").attr("class","legendtext").attr("x",1.2*d).attr("y",d/2).attr("dy","0.35em").text((function(e,t){return o.model.get("labels")[t]})).style("fill",(function(e,t){return r[t%n]}));const h=l.max(this.model.get("labels"),(function(e){return e.length}));return this.legend_el.exit().remove(),[1,h]}draw_legend_elements(e,t){const s=this.model.get("colors"),i=this.model.get("stroke"),a=this.model.get("fill");e.append("path").attr("transform",(function(e,s){return"translate( "+t/2+", "+t/2+")"})).attr("d",this.dot.size(64)).style("fill",a?s[0]:"none").style("stroke",i||s[0])}update_legend(){if(this.legend_el){const e=this.model.get("colors"),t=this.model.get("stroke"),s=this.model.get("fill");this.legend_el.select("path").style("fill",s?e[0]:"none").style("stroke",t||e[0]),this.legend_el.select("text").style("fill",s?e[0]:"none"),this.legend_el&&this.legend_el.select("path").attr("d",this.dot.type(this.model.get("marker")))}}relayout(){this.set_ranges(),this.update_position()}compute_view_padding(){const e=Math.sqrt(this.model.get("default_size"))/2+1;e===this.x_padding&&e===this.y_padding||(this.x_padding=e,this.y_padding=e,this.trigger("mark_padding_updated"))}draw(e){}clear_style(e,t,s){}set_default_style(e,t){}set_style_on_elements(e,t,s){}}t.ScatterGL=b},5997:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScatterGLModel=void 0;const n=s(9250),l=r(s(1961));class o extends n.MarkModel{defaults(){return Object.assign(Object.assign({},n.MarkModel.prototype.defaults()),{_model_name:"ScatterGLModel",_view_name:"ScatterGL",x:[],y:[],color:null,skew:null,marker:"circle",stroke:null,stroke_width:1.5,default_skew:.5,default_size:64,names:[],display_names:!0,fill:!0,drag_color:null,drag_size:5,names_unique:!0})}initialize(e,t){super.initialize(e,t),this.update_domains()}update_domains(){var e=this.get("scales");for(var t in e)if(e.hasOwnProperty(t)&&"color"!=t){var s=e[t];this.get("preserve_domain")[t]?s.del_domain([],this.model_id+t):s.compute_and_set_domain(this.get(t),this.model_id+t)}}}t.ScatterGLModel=o,o.serializers=Object.assign(Object.assign({},n.MarkModel.serializers),{x:l.array_or_json,y:l.array_or_json,color:l.array_or_json,size:l.array_or_json,rotation:l.array_or_json,opacity:l.array_or_json,opacities:l.array_or_json})},6589:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScatterModel=void 0;const n=s(6850),l=r(s(1961)),o=r(s(8731));class d extends n.ScatterBaseModel{defaults(){return Object.assign(Object.assign({},n.ScatterBaseModel.prototype.defaults()),{_model_name:"ScatterModel",_view_name:"Scatter",skew:null,marker:"circle",stroke:null,stroke_width:1.5,default_skew:.5,default_size:64,names:[],display_names:!0,fill:!0,drag_color:null,drag_size:5,names_unique:!0})}initialize(e,t){super.initialize(e,t),this.on("change:skew",this.update_data,this),this.on_some_change(["names","names_unique"],(function(){this.update_unique_ids(),this.trigger("data_updated")}),this)}update_mark_data(){super.update_mark_data();const e=this.get("skew")||[];this.mark_data.forEach((function(t,s){t.skew=e[s]}))}update_unique_ids(){let e=this.get("names");const t=null!=e&&0!==e.length;e=t?e:this.mark_data.map((function(e,t){return"Dot"+t}));let s=[];s=this.get("names_unique")?e.slice(0):o.range(this.mark_data.length),this.mark_data.forEach((function(t,i){t.name=e[i],t.unique_id=s[i]}))}}t.ScatterModel=d,d.serializers=Object.assign(Object.assign({},n.ScatterBaseModel.serializers),{skew:l.array_or_json,names:l.array_or_json})},3248:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseXYSelector=t.BaseXSelector=t.BaseSelector=void 0;const n=r(s(8944)),l=s(5237),o=s(6988).convert_dates,d=s(5335);class c extends l.Interaction{initialize(e){this.setElement(document.createElementNS(n.namespaces.svg,"g")),this.d3el=n.select(this.el),d.WidgetView.prototype.initialize.call(this,e)}render(){this.parent=this.options.parent,this.width=this.parent.width-this.parent.margin.left-this.parent.margin.right,this.height=this.parent.height-this.parent.margin.top-this.parent.margin.bottom,this.mark_views_promise=this.populate_mark_views()}create_listeners(){this.listenTo(this.parent,"margin_updated",this.relayout),this.listenTo(this.model,"change:selected",this.selected_changed),this.listenTo(this.model,"change:marks",this.marks_changed),this.listenTo(this.model,"msg:custom",this.handle_custom_messages)}relayout(){this.height=this.parent.height-this.parent.margin.top-this.parent.margin.bottom,this.width=this.parent.width-this.parent.margin.left-this.parent.margin.right}async populate_mark_views(){const e=this.parent,t=this.model.get("marks").map((e=>e.model_id)),s=await Promise.all(e.mark_views.views),i=e.mark_views._models.map((e=>e.model_id)),a=t.map((e=>i.indexOf(e)));this.mark_views=a.map((e=>s[e]))}marks_changed(){this.populate_mark_views().then((()=>this.selected_changed()))}handle_custom_messages(e){"reset"===e.type&&this.reset()}set_selected(e,t){this.model.set(e,o(t))}}t.BaseSelector=c,t.BaseXSelector=class extends c{create_scales(){if(this.scale&&this.scale.remove(),this.model.get("scale")){const e=this;return this.create_child_view(this.model.get("scale")).then((function(t){return e.scale=t,e.update_scale_domain(!0),e.set_range([e.scale]),e.scale.on("domain_changed",e.update_scale_domain,e),t}))}}update_scale_domain(e=!1){const t="vertical"==this.model.get("orientation")?"y":"x",s=this.parent.padded_range(t,this.scale.model),i=this.parent.range(t);this.scale.expand_domain(s,i)}set_range(e){const t="vertical"==this.model.get("orientation")?"y":"x";for(let s=0;s<e.length;s++)e[s].set_range(this.parent.range(t))}},t.BaseXYSelector=class extends c{create_scales(){const e=this;this.x_scale&&this.x_scale.remove(),this.y_scale&&this.y_scale.remove();const t=[];return this.model.get("x_scale")&&t.push(this.create_child_view(this.model.get("x_scale")).then((function(t){return e.x_scale=t,e.update_xscale_domain(),e.set_x_range([e.x_scale]),e.x_scale.on("domain_changed",e.update_xscale_domain,e),t}))),this.model.get("y_scale")&&t.push(this.create_child_view(this.model.get("y_scale")).then((function(t){return e.y_scale=t,e.update_yscale_domain(),e.set_y_range([e.y_scale]),e.y_scale.on("domain_changed",e.update_yscale_domain,e),t}))),Promise.all(t)}set_x_range(e){for(let t=0;t<e.length;t++)e[t].set_range(this.parent.range("x"))}set_y_range(e){for(var t=0;t<e.length;t++)e[t].set_range(this.parent.range("y"))}update_xscale_domain(){const e=this.parent.padded_range("x",this.x_scale.model),t=this.parent.range("x");this.x_scale.expand_domain(e,t)}update_yscale_domain(){const e=this.parent.padded_range("y",this.y_scale.model),t=this.parent.range("y");this.y_scale.expand_domain(e,t)}}},8881:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LassoSelectorModel=t.MultiSelectorModel=t.BrushSelectorModel=t.BrushIntervalSelectorModel=t.IndexSelectorModel=t.FastIntervalSelectorModel=t.TwoDSelectorModel=t.OneDSelectorModel=t.SelectorModel=void 0;const n=s(5335),l=s(8657),o=r(s(1961));class d extends n.WidgetModel{defaults(){return Object.assign(Object.assign({},n.WidgetModel.prototype.defaults()),{_model_name:"SelectorModel",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:l.semver_range,_view_module_version:l.semver_range,marks:[]})}}t.SelectorModel=d,d.serializers=Object.assign(Object.assign({},n.WidgetModel.serializers),{marks:{deserialize:n.unpack_models}});class c extends d{defaults(){return Object.assign(Object.assign({},d.prototype.defaults()),{_model_name:"OneDSelectorModel",scale:null})}}t.OneDSelectorModel=c,c.serializers=Object.assign(Object.assign({},d.serializers),{scale:{deserialize:n.unpack_models}});class h extends d{defaults(){return Object.assign(Object.assign({},d.prototype.defaults()),{_model_name:"TwoDSelectorModel",x_scale:null,y_scale:null})}}t.TwoDSelectorModel=h,h.serializers=Object.assign(Object.assign({},d.serializers),{x_scale:{deserialize:n.unpack_models},y_scale:{deserialize:n.unpack_models}});class _ extends c{defaults(){return Object.assign(Object.assign({},c.prototype.defaults()),{_model_name:"FastIntervalSelectorModel",_view_name:"FastIntervalSelector",selected:null,color:null,size:null})}}t.FastIntervalSelectorModel=_,_.serializers=Object.assign(Object.assign({},c.serializers),{selected:o.array_or_json});class u extends c{defaults(){return Object.assign(Object.assign({},c.prototype.defaults()),{_model_name:"IndexSelectorModel",_view_name:"IndexSelector",selected:null,line_width:2,color:null})}}t.IndexSelectorModel=u,u.serializers=Object.assign(Object.assign({},c.serializers),{selected:o.array_or_json});class g extends c{defaults(){return Object.assign(Object.assign({},c.prototype.defaults()),{_model_name:"BrushIntervalSelectorModel",_view_name:"BrushIntervalSelector",brushing:!1,selected:null,color:null,orientation:"horizontal"})}}t.BrushIntervalSelectorModel=g,g.serializers=Object.assign(Object.assign({},c.serializers),{selected:o.array_or_json});class m extends h{defaults(){return Object.assign(Object.assign({},h.prototype.defaults()),{_model_name:"BrushSelectorModel",_view_name:"BrushSelector",clear:!1,brushing:!1,selected_x:null,selected_y:null,color:null})}}t.BrushSelectorModel=m,m.serializers=Object.assign(Object.assign({},h.serializers),{selected_x:o.array_or_json,selected_y:o.array_or_json}),t.MultiSelectorModel=class extends c{defaults(){return Object.assign(Object.assign({},c.prototype.defaults()),{_model_name:"MultiSelectorModel",_view_name:"MultiSelector",names:[],brushing:!1,selected:{},_selected:{},show_names:!0})}},t.LassoSelectorModel=class extends h{defaults(){return Object.assign(Object.assign({},h.prototype.defaults()),{_model_name:"LassoSelectorModel",_view_name:"LassoSelector",color:null})}}},7408:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Toolbar=t.ToolbarModel=void 0;const n=r(s(5335)),l=s(8657),o=r(s(8731));class d extends n.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},n.DOMWidgetModel.prototype.defaults()),{_model_name:"ToolbarModel",_view_name:"Toolbar",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:l.semver_range,_view_module_version:l.semver_range,figure:void 0,_panning:!1,_panzoom:null})}panzoom(){const e=this.get("figure");if(this.get("_panning"))e&&(e.set("interaction",this.cached_interaction),e.save_changes()),this.set("_panning",!1),this.save_changes();else{if(e){this.cached_interaction=e.get("interaction");const t=this.get("_panzoom");t?(e.set("interaction",t),e.save_changes()):this._create_panzoom_model(e).then((t=>{this.set("_panzoom",t),this.save_changes(),e.set("interaction",t),e.save_changes()}))}this.set("_panning",!0),this.save_changes()}}reset(){const e=this.get("figure");if(e){e.set("interaction",this.cached_interaction),e.save_changes();const t=this.get("_panzoom");t.reset_scales(),t.close(),this.set("_panzoom",null),this.set("_panning",!1),this.save_changes()}}save_png(){const e=this.get("figure");e&&e.save_png()}_create_panzoom_model(e){return this.widget_manager.new_widget({model_name:"PanZoomModel",model_module:"bqplot",model_module_version:e.get("_model_module_version"),view_name:"PanZoom",view_module:"bqplot",view_module_version:e.get("_view_module_version")}).then((function(t){return Promise.all(e.get("marks")).then((function(e){const s=[],i=[];for(let t=0;t<e.length;++t){const a=e[t].get("preserve_domain"),r=e[t].get("scales");o.each(r,(function(n,l){const o=e[t].get("scales_metadata")[l].dimension;"x"!==o||a[l]||s.push(r[l]),"y"!==o||a[l]||i.push(r[l])}))}return t.set("scales",{x:s,y:i}),t.save_changes(),t}))}))}}t.ToolbarModel=d,d.serializers=Object.assign(Object.assign({},n.DOMWidgetModel.serializers),{figure:{deserialize:n.unpack_models},_panzoom:{deserialize:n.unpack_models}});class c extends n.DOMWidgetView{render(){this.el.classList.add("jupyter-widget"),this.el.classList.add("widget-hbox");const e=document.createElement("button");e.classList.add("jupyter-widgets"),e.classList.add("jupyter-button"),e.classList.add("widget-toggle-button"),e.setAttribute("data-toggle","tooltip"),e.setAttribute("title","PanZoom"),e.onclick=e=>{e.preventDefault(),this.model.panzoom()};const t=document.createElement("i");t.className="fa fa-arrows",e.appendChild(t);const s=document.createElement("button");s.classList.add("jupyter-widgets"),s.classList.add("jupyter-button"),s.classList.add("widget-button"),s.setAttribute("data-toggle","tooltip"),s.setAttribute("title","Reset"),s.onclick=e=>{e.preventDefault(),this.model.reset()};const i=document.createElement("i");i.className="fa fa-refresh",s.appendChild(i);const a=document.createElement("button");a.classList.add("jupyter-widgets"),a.classList.add("jupyter-button"),a.classList.add("widget-button"),a.setAttribute("data-toggle","tooltip"),a.setAttribute("title","Save"),a.onclick=e=>{e.preventDefault(),this.model.save_png()};const r=document.createElement("i");r.className="fa fa-save",a.appendChild(r),this.el.appendChild(e),this.el.appendChild(s),this.el.appendChild(a),this._panzoom=e,this.update()}update(){this.model.get("_panning")?this._panzoom.classList.add("mod-active"):this._panzoom.classList.remove("mod-active")}}t.Toolbar=c},9096:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Tooltip=void 0;const n=s(5335),l=r(s(8944)),o=r(s(6988)),d=r(s(8731));class c extends n.DOMWidgetView{initialize(){this.d3el=l.select(this.el),super.initialize.apply(this,arguments)}render(){this.parent=this.options.parent,this.update_formats(),this.create_listeners(),this.create_table()}create_listeners(){this.listenTo(this.parent,"update_tooltip",this.update_tooltip),this.model.on_some_change(["fields","show_labels","labels"],this.create_table,this),this.listenTo(this.model,"change:formats",this.update_formats)}update_formats(){const e=this.model.get("fields"),t=this.model.get("formats");this.tooltip_formats=e.map((function(e,s){const i=t[s];return void 0===i||""===i?function(e){return e}:o.is_valid_time_format(i)?l.utcFormat(i):l.format(i)}))}update_tooltip(e){const t=this;this.d3el.select("table").selectAll("tr").select(".datavalue").text(((s,i)=>t.tooltip_formats[i](e[s])))}create_table(){const e=this.model.get("fields"),t=d.clone(this.model.get("labels"));for(let s=t.length;s<e.length;s++)t[s]=e[s]+":";this.d3el.select("table").remove();const s=this.d3el.append("table").selectAll("tr").data(e);s.exit().remove();const i=s.enter().append("tr").attr("class","datarow");this.model.get("show_labels")&&i.append("td").text(((e,s)=>t[s])).attr("class","tooltiptext datafield"),i.append("td").attr("class","tooltiptext datavalue"),this.update_formats()}}t.Tooltip=c},7648:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipModel=void 0;const i=s(5335),a=s(8657);class r extends i.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},i.DOMWidgetModel.prototype.defaults()),{_model_name:"TooltipModel",_view_name:"Tooltip",_model_module:"bqplot",_view_module:"bqplot",_model_module_version:a.semver_range,_view_module_version:a.semver_range,fields:[],formats:[],show_labels:!0,labels:[]})}}t.TooltipModel=r},7491:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matplotlib=void 0,t.matplotlib={viridis:{256:["#440154","#440256","#450457","#450559","#46075a","#46085c","#460a5d","#460b5e","#470d60","#470e61","#471063","#471164","#471365","#481467","#481668","#481769","#48186a","#481a6c","#481b6d","#481c6e","#481d6f","#481f70","#482071","#482173","#482374","#482475","#482576","#482677","#482878","#482979","#472a7a","#472c7a","#472d7b","#472e7c","#472f7d","#46307e","#46327e","#46337f","#463480","#453581","#453781","#453882","#443983","#443a83","#443b84","#433d84","#433e85","#423f85","#424086","#424186","#414287","#414487","#404588","#404688","#3f4788","#3f4889","#3e4989","#3e4a89","#3e4c8a","#3d4d8a","#3d4e8a","#3c4f8a","#3c508b","#3b518b","#3b528b","#3a538b","#3a548c","#39558c","#39568c","#38588c","#38598c","#375a8c","#375b8d","#365c8d","#365d8d","#355e8d","#355f8d","#34608d","#34618d","#33628d","#33638d","#32648e","#32658e","#31668e","#31678e","#31688e","#30698e","#306a8e","#2f6b8e","#2f6c8e","#2e6d8e","#2e6e8e","#2e6f8e","#2d708e","#2d718e","#2c718e","#2c728e","#2c738e","#2b748e","#2b758e","#2a768e","#2a778e","#2a788e","#29798e","#297a8e","#297b8e","#287c8e","#287d8e","#277e8e","#277f8e","#27808e","#26818e","#26828e","#26828e","#25838e","#25848e","#25858e","#24868e","#24878e","#23888e","#23898e","#238a8d","#228b8d","#228c8d","#228d8d","#218e8d","#218f8d","#21908d","#21918c","#20928c","#20928c","#20938c","#1f948c","#1f958b","#1f968b","#1f978b","#1f988b","#1f998a","#1f9a8a","#1e9b8a","#1e9c89","#1e9d89","#1f9e89","#1f9f88","#1fa088","#1fa188","#1fa187","#1fa287","#20a386","#20a486","#21a585","#21a685","#22a785","#22a884","#23a983","#24aa83","#25ab82","#25ac82","#26ad81","#27ad81","#28ae80","#29af7f","#2ab07f","#2cb17e","#2db27d","#2eb37c","#2fb47c","#31b57b","#32b67a","#34b679","#35b779","#37b878","#38b977","#3aba76","#3bbb75","#3dbc74","#3fbc73","#40bd72","#42be71","#44bf70","#46c06f","#48c16e","#4ac16d","#4cc26c","#4ec36b","#50c46a","#52c569","#54c568","#56c667","#58c765","#5ac864","#5cc863","#5ec962","#60ca60","#63cb5f","#65cb5e","#67cc5c","#69cd5b","#6ccd5a","#6ece58","#70cf57","#73d056","#75d054","#77d153","#7ad151","#7cd250","#7fd34e","#81d34d","#84d44b","#86d549","#89d548","#8bd646","#8ed645","#90d743","#93d741","#95d840","#98d83e","#9bd93c","#9dd93b","#a0da39","#a2da37","#a5db36","#a8db34","#aadc32","#addc30","#b0dd2f","#b2dd2d","#b5de2b","#b8de29","#bade28","#bddf26","#c0df25","#c2df23","#c5e021","#c8e020","#cae11f","#cde11d","#d0e11c","#d2e21b","#d5e21a","#d8e219","#dae319","#dde318","#dfe318","#e2e418","#e5e419","#e7e419","#eae51a","#ece51b","#efe51c","#f1e51d","#f4e61e","#f6e620","#f8e621","#fbe723","#fde725"],type:"seq"}},t.default={Spectral:{3:["rgb(252,141,89)","rgb(255,255,191)","rgb(153,213,148)"],4:["rgb(215,25,28)","rgb(253,174,97)","rgb(171,221,164)","rgb(43,131,186)"],5:["rgb(215,25,28)","rgb(253,174,97)","rgb(255,255,191)","rgb(171,221,164)","rgb(43,131,186)"],6:["rgb(213,62,79)","rgb(252,141,89)","rgb(254,224,139)","rgb(230,245,152)","rgb(153,213,148)","rgb(50,136,189)"],7:["rgb(213,62,79)","rgb(252,141,89)","rgb(254,224,139)","rgb(255,255,191)","rgb(230,245,152)","rgb(153,213,148)","rgb(50,136,189)"],8:["rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)"],9:["rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)"],10:["rgb(158,1,66)","rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)","rgb(94,79,162)"],11:["rgb(158,1,66)","rgb(213,62,79)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(230,245,152)","rgb(171,221,164)","rgb(102,194,165)","rgb(50,136,189)","rgb(94,79,162)"],type:"div"},RdYlGn:{3:["rgb(252,141,89)","rgb(255,255,191)","rgb(145,207,96)"],4:["rgb(215,25,28)","rgb(253,174,97)","rgb(166,217,106)","rgb(26,150,65)"],5:["rgb(215,25,28)","rgb(253,174,97)","rgb(255,255,191)","rgb(166,217,106)","rgb(26,150,65)"],6:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,139)","rgb(217,239,139)","rgb(145,207,96)","rgb(26,152,80)"],7:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,139)","rgb(255,255,191)","rgb(217,239,139)","rgb(145,207,96)","rgb(26,152,80)"],8:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)"],9:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)"],10:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)","rgb(0,104,55)"],11:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,139)","rgb(255,255,191)","rgb(217,239,139)","rgb(166,217,106)","rgb(102,189,99)","rgb(26,152,80)","rgb(0,104,55)"],type:"div"},RdBu:{3:["rgb(239,138,98)","rgb(247,247,247)","rgb(103,169,207)"],4:["rgb(202,0,32)","rgb(244,165,130)","rgb(146,197,222)","rgb(5,113,176)"],5:["rgb(202,0,32)","rgb(244,165,130)","rgb(247,247,247)","rgb(146,197,222)","rgb(5,113,176)"],6:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(209,229,240)","rgb(103,169,207)","rgb(33,102,172)"],7:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(103,169,207)","rgb(33,102,172)"],8:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)"],9:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)"],10:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],11:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],type:"div"},PiYG:{3:["rgb(233,163,201)","rgb(247,247,247)","rgb(161,215,106)"],4:["rgb(208,28,139)","rgb(241,182,218)","rgb(184,225,134)","rgb(77,172,38)"],5:["rgb(208,28,139)","rgb(241,182,218)","rgb(247,247,247)","rgb(184,225,134)","rgb(77,172,38)"],6:["rgb(197,27,125)","rgb(233,163,201)","rgb(253,224,239)","rgb(230,245,208)","rgb(161,215,106)","rgb(77,146,33)"],7:["rgb(197,27,125)","rgb(233,163,201)","rgb(253,224,239)","rgb(247,247,247)","rgb(230,245,208)","rgb(161,215,106)","rgb(77,146,33)"],8:["rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)"],9:["rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(247,247,247)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)"],10:["rgb(142,1,82)","rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)","rgb(39,100,25)"],11:["rgb(142,1,82)","rgb(197,27,125)","rgb(222,119,174)","rgb(241,182,218)","rgb(253,224,239)","rgb(247,247,247)","rgb(230,245,208)","rgb(184,225,134)","rgb(127,188,65)","rgb(77,146,33)","rgb(39,100,25)"],type:"div"},PRGn:{3:["rgb(175,141,195)","rgb(247,247,247)","rgb(127,191,123)"],4:["rgb(123,50,148)","rgb(194,165,207)","rgb(166,219,160)","rgb(0,136,55)"],5:["rgb(123,50,148)","rgb(194,165,207)","rgb(247,247,247)","rgb(166,219,160)","rgb(0,136,55)"],6:["rgb(118,42,131)","rgb(175,141,195)","rgb(231,212,232)","rgb(217,240,211)","rgb(127,191,123)","rgb(27,120,55)"],7:["rgb(118,42,131)","rgb(175,141,195)","rgb(231,212,232)","rgb(247,247,247)","rgb(217,240,211)","rgb(127,191,123)","rgb(27,120,55)"],8:["rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)"],9:["rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(247,247,247)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)"],10:["rgb(64,0,75)","rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)","rgb(0,68,27)"],11:["rgb(64,0,75)","rgb(118,42,131)","rgb(153,112,171)","rgb(194,165,207)","rgb(231,212,232)","rgb(247,247,247)","rgb(217,240,211)","rgb(166,219,160)","rgb(90,174,97)","rgb(27,120,55)","rgb(0,68,27)"],type:"div"},RdYlBu:{3:["rgb(252,141,89)","rgb(255,255,191)","rgb(145,191,219)"],4:["rgb(215,25,28)","rgb(253,174,97)","rgb(171,217,233)","rgb(44,123,182)"],5:["rgb(215,25,28)","rgb(253,174,97)","rgb(255,255,191)","rgb(171,217,233)","rgb(44,123,182)"],6:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,144)","rgb(224,243,248)","rgb(145,191,219)","rgb(69,117,180)"],7:["rgb(215,48,39)","rgb(252,141,89)","rgb(254,224,144)","rgb(255,255,191)","rgb(224,243,248)","rgb(145,191,219)","rgb(69,117,180)"],8:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)"],9:["rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(255,255,191)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)"],10:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)","rgb(49,54,149)"],11:["rgb(165,0,38)","rgb(215,48,39)","rgb(244,109,67)","rgb(253,174,97)","rgb(254,224,144)","rgb(255,255,191)","rgb(224,243,248)","rgb(171,217,233)","rgb(116,173,209)","rgb(69,117,180)","rgb(49,54,149)"],type:"div"},BrBG:{3:["rgb(216,179,101)","rgb(245,245,245)","rgb(90,180,172)"],4:["rgb(166,97,26)","rgb(223,194,125)","rgb(128,205,193)","rgb(1,133,113)"],5:["rgb(166,97,26)","rgb(223,194,125)","rgb(245,245,245)","rgb(128,205,193)","rgb(1,133,113)"],6:["rgb(140,81,10)","rgb(216,179,101)","rgb(246,232,195)","rgb(199,234,229)","rgb(90,180,172)","rgb(1,102,94)"],7:["rgb(140,81,10)","rgb(216,179,101)","rgb(246,232,195)","rgb(245,245,245)","rgb(199,234,229)","rgb(90,180,172)","rgb(1,102,94)"],8:["rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)"],9:["rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(245,245,245)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)"],10:["rgb(84,48,5)","rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)","rgb(0,60,48)"],11:["rgb(84,48,5)","rgb(140,81,10)","rgb(191,129,45)","rgb(223,194,125)","rgb(246,232,195)","rgb(245,245,245)","rgb(199,234,229)","rgb(128,205,193)","rgb(53,151,143)","rgb(1,102,94)","rgb(0,60,48)"],type:"div"},RdGy:{3:["rgb(239,138,98)","rgb(255,255,255)","rgb(153,153,153)"],4:["rgb(202,0,32)","rgb(244,165,130)","rgb(186,186,186)","rgb(64,64,64)"],5:["rgb(202,0,32)","rgb(244,165,130)","rgb(255,255,255)","rgb(186,186,186)","rgb(64,64,64)"],6:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(224,224,224)","rgb(153,153,153)","rgb(77,77,77)"],7:["rgb(178,24,43)","rgb(239,138,98)","rgb(253,219,199)","rgb(255,255,255)","rgb(224,224,224)","rgb(153,153,153)","rgb(77,77,77)"],8:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)"],9:["rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(255,255,255)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)"],10:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)","rgb(26,26,26)"],11:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(255,255,255)","rgb(224,224,224)","rgb(186,186,186)","rgb(135,135,135)","rgb(77,77,77)","rgb(26,26,26)"],type:"div"},PuOr:{3:["rgb(241,163,64)","rgb(247,247,247)","rgb(153,142,195)"],4:["rgb(230,97,1)","rgb(253,184,99)","rgb(178,171,210)","rgb(94,60,153)"],5:["rgb(230,97,1)","rgb(253,184,99)","rgb(247,247,247)","rgb(178,171,210)","rgb(94,60,153)"],6:["rgb(179,88,6)","rgb(241,163,64)","rgb(254,224,182)","rgb(216,218,235)","rgb(153,142,195)","rgb(84,39,136)"],7:["rgb(179,88,6)","rgb(241,163,64)","rgb(254,224,182)","rgb(247,247,247)","rgb(216,218,235)","rgb(153,142,195)","rgb(84,39,136)"],8:["rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)"],9:["rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(247,247,247)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)"],10:["rgb(127,59,8)","rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)","rgb(45,0,75)"],11:["rgb(127,59,8)","rgb(179,88,6)","rgb(224,130,20)","rgb(253,184,99)","rgb(254,224,182)","rgb(247,247,247)","rgb(216,218,235)","rgb(178,171,210)","rgb(128,115,172)","rgb(84,39,136)","rgb(45,0,75)"],type:"div"},Set2:{3:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)"],4:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)"],5:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)"],6:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)"],7:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)","rgb(229,196,148)"],8:["rgb(102,194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)","rgb(229,196,148)","rgb(179,179,179)"],type:"qual"},Accent:{3:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)"],4:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)"],5:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)"],6:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)"],7:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)","rgb(191,91,23)"],8:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)","rgb(191,91,23)","rgb(102,102,102)"],type:"qual"},Set1:{3:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)"],4:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)"],5:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)"],6:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)"],7:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)","rgb(166,86,40)"],8:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)","rgb(166,86,40)","rgb(247,129,191)"],9:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(152,78,163)","rgb(255,127,0)","rgb(255,255,51)","rgb(166,86,40)","rgb(247,129,191)","rgb(153,153,153)"],type:"qual"},Set3:{3:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)"],4:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)"],5:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)"],6:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)"],7:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)"],8:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)"],9:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)"],10:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)"],11:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)","rgb(204,235,197)"],12:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)","rgb(204,235,197)","rgb(255,237,111)"],type:"qual"},Dark2:{3:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)"],4:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)"],5:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)"],6:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)"],7:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)","rgb(166,118,29)"],8:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)","rgb(166,118,29)","rgb(102,102,102)"],type:"qual"},Paired:{3:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)"],4:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)"],5:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)"],6:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)"],7:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)"],8:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)"],9:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)"],10:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)","rgb(106,61,154)"],11:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)","rgb(106,61,154)","rgb(255,255,153)"],12:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)","rgb(106,61,154)","rgb(255,255,153)","rgb(177,89,40)"],type:"qual"},Pastel2:{3:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)"],4:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)"],5:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)"],6:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)"],7:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)","rgb(241,226,204)"],8:["rgb(179,226,205)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)","rgb(241,226,204)","rgb(204,204,204)"],type:"qual"},Pastel1:{3:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)"],4:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)"],5:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)"],6:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)"],7:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)"],8:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)","rgb(253,218,236)"],9:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)","rgb(253,218,236)","rgb(242,242,242)"],type:"qual"},OrRd:{3:["rgb(254,232,200)","rgb(253,187,132)","rgb(227,74,51)"],4:["rgb(254,240,217)","rgb(253,204,138)","rgb(252,141,89)","rgb(215,48,31)"],5:["rgb(254,240,217)","rgb(253,204,138)","rgb(252,141,89)","rgb(227,74,51)","rgb(179,0,0)"],6:["rgb(254,240,217)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(227,74,51)","rgb(179,0,0)"],7:["rgb(254,240,217)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(239,101,72)","rgb(215,48,31)","rgb(153,0,0)"],8:["rgb(255,247,236)","rgb(254,232,200)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(239,101,72)","rgb(215,48,31)","rgb(153,0,0)"],9:["rgb(255,247,236)","rgb(254,232,200)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(239,101,72)","rgb(215,48,31)","rgb(179,0,0)","rgb(127,0,0)"],type:"seq"},PuBu:{3:["rgb(236,231,242)","rgb(166,189,219)","rgb(43,140,190)"],4:["rgb(241,238,246)","rgb(189,201,225)","rgb(116,169,207)","rgb(5,112,176)"],5:["rgb(241,238,246)","rgb(189,201,225)","rgb(116,169,207)","rgb(43,140,190)","rgb(4,90,141)"],6:["rgb(241,238,246)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(43,140,190)","rgb(4,90,141)"],7:["rgb(241,238,246)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(54,144,192)","rgb(5,112,176)","rgb(3,78,123)"],8:["rgb(255,247,251)","rgb(236,231,242)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(54,144,192)","rgb(5,112,176)","rgb(3,78,123)"],9:["rgb(255,247,251)","rgb(236,231,242)","rgb(208,209,230)","rgb(166,189,219)","rgb(116,169,207)","rgb(54,144,192)","rgb(5,112,176)","rgb(4,90,141)","rgb(2,56,88)"],type:"seq"},BuPu:{3:["rgb(224,236,244)","rgb(158,188,218)","rgb(136,86,167)"],4:["rgb(237,248,251)","rgb(179,205,227)","rgb(140,150,198)","rgb(136,65,157)"],5:["rgb(237,248,251)","rgb(179,205,227)","rgb(140,150,198)","rgb(136,86,167)","rgb(129,15,124)"],6:["rgb(237,248,251)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(136,86,167)","rgb(129,15,124)"],7:["rgb(237,248,251)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(140,107,177)","rgb(136,65,157)","rgb(110,1,107)"],8:["rgb(247,252,253)","rgb(224,236,244)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(140,107,177)","rgb(136,65,157)","rgb(110,1,107)"],9:["rgb(247,252,253)","rgb(224,236,244)","rgb(191,211,230)","rgb(158,188,218)","rgb(140,150,198)","rgb(140,107,177)","rgb(136,65,157)","rgb(129,15,124)","rgb(77,0,75)"],type:"seq"},Oranges:{3:["rgb(254,230,206)","rgb(253,174,107)","rgb(230,85,13)"],4:["rgb(254,237,222)","rgb(253,190,133)","rgb(253,141,60)","rgb(217,71,1)"],5:["rgb(254,237,222)","rgb(253,190,133)","rgb(253,141,60)","rgb(230,85,13)","rgb(166,54,3)"],6:["rgb(254,237,222)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(230,85,13)","rgb(166,54,3)"],7:["rgb(254,237,222)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(241,105,19)","rgb(217,72,1)","rgb(140,45,4)"],8:["rgb(255,245,235)","rgb(254,230,206)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(241,105,19)","rgb(217,72,1)","rgb(140,45,4)"],9:["rgb(255,245,235)","rgb(254,230,206)","rgb(253,208,162)","rgb(253,174,107)","rgb(253,141,60)","rgb(241,105,19)","rgb(217,72,1)","rgb(166,54,3)","rgb(127,39,4)"],type:"seq"},BuGn:{3:["rgb(229,245,249)","rgb(153,216,201)","rgb(44,162,95)"],4:["rgb(237,248,251)","rgb(178,226,226)","rgb(102,194,164)","rgb(35,139,69)"],5:["rgb(237,248,251)","rgb(178,226,226)","rgb(102,194,164)","rgb(44,162,95)","rgb(0,109,44)"],6:["rgb(237,248,251)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(44,162,95)","rgb(0,109,44)"],7:["rgb(237,248,251)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(65,174,118)","rgb(35,139,69)","rgb(0,88,36)"],8:["rgb(247,252,253)","rgb(229,245,249)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(65,174,118)","rgb(35,139,69)","rgb(0,88,36)"],9:["rgb(247,252,253)","rgb(229,245,249)","rgb(204,236,230)","rgb(153,216,201)","rgb(102,194,164)","rgb(65,174,118)","rgb(35,139,69)","rgb(0,109,44)","rgb(0,68,27)"],type:"seq"},YlOrBr:{3:["rgb(255,247,188)","rgb(254,196,79)","rgb(217,95,14)"],4:["rgb(255,255,212)","rgb(254,217,142)","rgb(254,153,41)","rgb(204,76,2)"],5:["rgb(255,255,212)","rgb(254,217,142)","rgb(254,153,41)","rgb(217,95,14)","rgb(153,52,4)"],6:["rgb(255,255,212)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(217,95,14)","rgb(153,52,4)"],7:["rgb(255,255,212)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(140,45,4)"],8:["rgb(255,255,229)","rgb(255,247,188)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(140,45,4)"],9:["rgb(255,255,229)","rgb(255,247,188)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(153,52,4)","rgb(102,37,6)"],type:"seq"},YlGn:{3:["rgb(247,252,185)","rgb(173,221,142)","rgb(49,163,84)"],4:["rgb(255,255,204)","rgb(194,230,153)","rgb(120,198,121)","rgb(35,132,67)"],5:["rgb(255,255,204)","rgb(194,230,153)","rgb(120,198,121)","rgb(49,163,84)","rgb(0,104,55)"],6:["rgb(255,255,204)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(49,163,84)","rgb(0,104,55)"],7:["rgb(255,255,204)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(65,171,93)","rgb(35,132,67)","rgb(0,90,50)"],8:["rgb(255,255,229)","rgb(247,252,185)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(65,171,93)","rgb(35,132,67)","rgb(0,90,50)"],9:["rgb(255,255,229)","rgb(247,252,185)","rgb(217,240,163)","rgb(173,221,142)","rgb(120,198,121)","rgb(65,171,93)","rgb(35,132,67)","rgb(0,104,55)","rgb(0,69,41)"],type:"seq"},Reds:{3:["rgb(254,224,210)","rgb(252,146,114)","rgb(222,45,38)"],4:["rgb(254,229,217)","rgb(252,174,145)","rgb(251,106,74)","rgb(203,24,29)"],5:["rgb(254,229,217)","rgb(252,174,145)","rgb(251,106,74)","rgb(222,45,38)","rgb(165,15,21)"],6:["rgb(254,229,217)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(222,45,38)","rgb(165,15,21)"],7:["rgb(254,229,217)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(239,59,44)","rgb(203,24,29)","rgb(153,0,13)"],8:["rgb(255,245,240)","rgb(254,224,210)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(239,59,44)","rgb(203,24,29)","rgb(153,0,13)"],9:["rgb(255,245,240)","rgb(254,224,210)","rgb(252,187,161)","rgb(252,146,114)","rgb(251,106,74)","rgb(239,59,44)","rgb(203,24,29)","rgb(165,15,21)","rgb(103,0,13)"],type:"seq"},RdPu:{3:["rgb(253,224,221)","rgb(250,159,181)","rgb(197,27,138)"],4:["rgb(254,235,226)","rgb(251,180,185)","rgb(247,104,161)","rgb(174,1,126)"],5:["rgb(254,235,226)","rgb(251,180,185)","rgb(247,104,161)","rgb(197,27,138)","rgb(122,1,119)"],6:["rgb(254,235,226)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(197,27,138)","rgb(122,1,119)"],7:["rgb(254,235,226)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(221,52,151)","rgb(174,1,126)","rgb(122,1,119)"],8:["rgb(255,247,243)","rgb(253,224,221)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(221,52,151)","rgb(174,1,126)","rgb(122,1,119)"],9:["rgb(255,247,243)","rgb(253,224,221)","rgb(252,197,192)","rgb(250,159,181)","rgb(247,104,161)","rgb(221,52,151)","rgb(174,1,126)","rgb(122,1,119)","rgb(73,0,106)"],type:"seq"},Greens:{3:["rgb(229,245,224)","rgb(161,217,155)","rgb(49,163,84)"],4:["rgb(237,248,233)","rgb(186,228,179)","rgb(116,196,118)","rgb(35,139,69)"],5:["rgb(237,248,233)","rgb(186,228,179)","rgb(116,196,118)","rgb(49,163,84)","rgb(0,109,44)"],6:["rgb(237,248,233)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(49,163,84)","rgb(0,109,44)"],7:["rgb(237,248,233)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(65,171,93)","rgb(35,139,69)","rgb(0,90,50)"],8:["rgb(247,252,245)","rgb(229,245,224)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(65,171,93)","rgb(35,139,69)","rgb(0,90,50)"],9:["rgb(247,252,245)","rgb(229,245,224)","rgb(199,233,192)","rgb(161,217,155)","rgb(116,196,118)","rgb(65,171,93)","rgb(35,139,69)","rgb(0,109,44)","rgb(0,68,27)"],type:"seq"},YlGnBu:{3:["rgb(237,248,177)","rgb(127,205,187)","rgb(44,127,184)"],4:["rgb(255,255,204)","rgb(161,218,180)","rgb(65,182,196)","rgb(34,94,168)"],5:["rgb(255,255,204)","rgb(161,218,180)","rgb(65,182,196)","rgb(44,127,184)","rgb(37,52,148)"],6:["rgb(255,255,204)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(44,127,184)","rgb(37,52,148)"],7:["rgb(255,255,204)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(29,145,192)","rgb(34,94,168)","rgb(12,44,132)"],8:["rgb(255,255,217)","rgb(237,248,177)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(29,145,192)","rgb(34,94,168)","rgb(12,44,132)"],9:["rgb(255,255,217)","rgb(237,248,177)","rgb(199,233,180)","rgb(127,205,187)","rgb(65,182,196)","rgb(29,145,192)","rgb(34,94,168)","rgb(37,52,148)","rgb(8,29,88)"],type:"seq"},Purples:{3:["rgb(239,237,245)","rgb(188,189,220)","rgb(117,107,177)"],4:["rgb(242,240,247)","rgb(203,201,226)","rgb(158,154,200)","rgb(106,81,163)"],5:["rgb(242,240,247)","rgb(203,201,226)","rgb(158,154,200)","rgb(117,107,177)","rgb(84,39,143)"],6:["rgb(242,240,247)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(117,107,177)","rgb(84,39,143)"],7:["rgb(242,240,247)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(128,125,186)","rgb(106,81,163)","rgb(74,20,134)"],8:["rgb(252,251,253)","rgb(239,237,245)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(128,125,186)","rgb(106,81,163)","rgb(74,20,134)"],9:["rgb(252,251,253)","rgb(239,237,245)","rgb(218,218,235)","rgb(188,189,220)","rgb(158,154,200)","rgb(128,125,186)","rgb(106,81,163)","rgb(84,39,143)","rgb(63,0,125)"],type:"seq"},GnBu:{3:["rgb(224,243,219)","rgb(168,221,181)","rgb(67,162,202)"],4:["rgb(240,249,232)","rgb(186,228,188)","rgb(123,204,196)","rgb(43,140,190)"],5:["rgb(240,249,232)","rgb(186,228,188)","rgb(123,204,196)","rgb(67,162,202)","rgb(8,104,172)"],6:["rgb(240,249,232)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(67,162,202)","rgb(8,104,172)"],7:["rgb(240,249,232)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(78,179,211)","rgb(43,140,190)","rgb(8,88,158)"],8:["rgb(247,252,240)","rgb(224,243,219)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(78,179,211)","rgb(43,140,190)","rgb(8,88,158)"],9:["rgb(247,252,240)","rgb(224,243,219)","rgb(204,235,197)","rgb(168,221,181)","rgb(123,204,196)","rgb(78,179,211)","rgb(43,140,190)","rgb(8,104,172)","rgb(8,64,129)"],type:"seq"},Greys:{3:["rgb(240,240,240)","rgb(189,189,189)","rgb(99,99,99)"],4:["rgb(247,247,247)","rgb(204,204,204)","rgb(150,150,150)","rgb(82,82,82)"],5:["rgb(247,247,247)","rgb(204,204,204)","rgb(150,150,150)","rgb(99,99,99)","rgb(37,37,37)"],6:["rgb(247,247,247)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(99,99,99)","rgb(37,37,37)"],7:["rgb(247,247,247)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(115,115,115)","rgb(82,82,82)","rgb(37,37,37)"],8:["rgb(255,255,255)","rgb(240,240,240)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(115,115,115)","rgb(82,82,82)","rgb(37,37,37)"],9:["rgb(255,255,255)","rgb(240,240,240)","rgb(217,217,217)","rgb(189,189,189)","rgb(150,150,150)","rgb(115,115,115)","rgb(82,82,82)","rgb(37,37,37)","rgb(0,0,0)"],type:"seq"},YlOrRd:{3:["rgb(255,237,160)","rgb(254,178,76)","rgb(240,59,32)"],4:["rgb(255,255,178)","rgb(254,204,92)","rgb(253,141,60)","rgb(227,26,28)"],5:["rgb(255,255,178)","rgb(254,204,92)","rgb(253,141,60)","rgb(240,59,32)","rgb(189,0,38)"],6:["rgb(255,255,178)","rgb(254,217,118)","rgb(254,178,76)","rgb(253,141,60)","rgb(240,59,32)","rgb(189,0,38)"],7:["rgb(255,255,178)","rgb(254,217,118)","rgb(254,178,76)","rgb(253,141,60)","rgb(252,78,42)","rgb(227,26,28)","rgb(177,0,38)"],8:["rgb(255,255,204)","rgb(255,237,160)","rgb(254,217,118)","rgb(254,178,76)","rgb(253,141,60)","rgb(252,78,42)","rgb(227,26,28)","rgb(177,0,38)"],type:"seq"},PuRd:{3:["rgb(231,225,239)","rgb(201,148,199)","rgb(221,28,119)"],4:["rgb(241,238,246)","rgb(215,181,216)","rgb(223,101,176)","rgb(206,18,86)"],5:["rgb(241,238,246)","rgb(215,181,216)","rgb(223,101,176)","rgb(221,28,119)","rgb(152,0,67)"],6:["rgb(241,238,246)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(221,28,119)","rgb(152,0,67)"],7:["rgb(241,238,246)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(231,41,138)","rgb(206,18,86)","rgb(145,0,63)"],8:["rgb(247,244,249)","rgb(231,225,239)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(231,41,138)","rgb(206,18,86)","rgb(145,0,63)"],9:["rgb(247,244,249)","rgb(231,225,239)","rgb(212,185,218)","rgb(201,148,199)","rgb(223,101,176)","rgb(231,41,138)","rgb(206,18,86)","rgb(152,0,67)","rgb(103,0,31)"],type:"seq"},Blues:{3:["rgb(222,235,247)","rgb(158,202,225)","rgb(49,130,189)"],4:["rgb(239,243,255)","rgb(189,215,231)","rgb(107,174,214)","rgb(33,113,181)"],5:["rgb(239,243,255)","rgb(189,215,231)","rgb(107,174,214)","rgb(49,130,189)","rgb(8,81,156)"],6:["rgb(239,243,255)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(49,130,189)","rgb(8,81,156)"],7:["rgb(239,243,255)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,69,148)"],8:["rgb(247,251,255)","rgb(222,235,247)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,69,148)"],9:["rgb(247,251,255)","rgb(222,235,247)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,81,156)","rgb(8,48,107)"],type:"seq"},PuBuGn:{3:["rgb(236,226,240)","rgb(166,189,219)","rgb(28,144,153)"],4:["rgb(246,239,247)","rgb(189,201,225)","rgb(103,169,207)","rgb(2,129,138)"],5:["rgb(246,239,247)","rgb(189,201,225)","rgb(103,169,207)","rgb(28,144,153)","rgb(1,108,89)"],6:["rgb(246,239,247)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(28,144,153)","rgb(1,108,89)"],7:["rgb(246,239,247)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(54,144,192)","rgb(2,129,138)","rgb(1,100,80)"],8:["rgb(255,247,251)","rgb(236,226,240)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(54,144,192)","rgb(2,129,138)","rgb(1,100,80)"],9:["rgb(255,247,251)","rgb(236,226,240)","rgb(208,209,230)","rgb(166,189,219)","rgb(103,169,207)","rgb(54,144,192)","rgb(2,129,138)","rgb(1,108,89)","rgb(1,70,54)"],type:"seq"},viridis:{256:["#440154","#440256","#450457","#450559","#46075a","#46085c","#460a5d","#460b5e","#470d60","#470e61","#471063","#471164","#471365","#481467","#481668","#481769","#48186a","#481a6c","#481b6d","#481c6e","#481d6f","#481f70","#482071","#482173","#482374","#482475","#482576","#482677","#482878","#482979","#472a7a","#472c7a","#472d7b","#472e7c","#472f7d","#46307e","#46327e","#46337f","#463480","#453581","#453781","#453882","#443983","#443a83","#443b84","#433d84","#433e85","#423f85","#424086","#424186","#414287","#414487","#404588","#404688","#3f4788","#3f4889","#3e4989","#3e4a89","#3e4c8a","#3d4d8a","#3d4e8a","#3c4f8a","#3c508b","#3b518b","#3b528b","#3a538b","#3a548c","#39558c","#39568c","#38588c","#38598c","#375a8c","#375b8d","#365c8d","#365d8d","#355e8d","#355f8d","#34608d","#34618d","#33628d","#33638d","#32648e","#32658e","#31668e","#31678e","#31688e","#30698e","#306a8e","#2f6b8e","#2f6c8e","#2e6d8e","#2e6e8e","#2e6f8e","#2d708e","#2d718e","#2c718e","#2c728e","#2c738e","#2b748e","#2b758e","#2a768e","#2a778e","#2a788e","#29798e","#297a8e","#297b8e","#287c8e","#287d8e","#277e8e","#277f8e","#27808e","#26818e","#26828e","#26828e","#25838e","#25848e","#25858e","#24868e","#24878e","#23888e","#23898e","#238a8d","#228b8d","#228c8d","#228d8d","#218e8d","#218f8d","#21908d","#21918c","#20928c","#20928c","#20938c","#1f948c","#1f958b","#1f968b","#1f978b","#1f988b","#1f998a","#1f9a8a","#1e9b8a","#1e9c89","#1e9d89","#1f9e89","#1f9f88","#1fa088","#1fa188","#1fa187","#1fa287","#20a386","#20a486","#21a585","#21a685","#22a785","#22a884","#23a983","#24aa83","#25ab82","#25ac82","#26ad81","#27ad81","#28ae80","#29af7f","#2ab07f","#2cb17e","#2db27d","#2eb37c","#2fb47c","#31b57b","#32b67a","#34b679","#35b779","#37b878","#38b977","#3aba76","#3bbb75","#3dbc74","#3fbc73","#40bd72","#42be71","#44bf70","#46c06f","#48c16e","#4ac16d","#4cc26c","#4ec36b","#50c46a","#52c569","#54c568","#56c667","#58c765","#5ac864","#5cc863","#5ec962","#60ca60","#63cb5f","#65cb5e","#67cc5c","#69cd5b","#6ccd5a","#6ece58","#70cf57","#73d056","#75d054","#77d153","#7ad151","#7cd250","#7fd34e","#81d34d","#84d44b","#86d549","#89d548","#8bd646","#8ed645","#90d743","#93d741","#95d840","#98d83e","#9bd93c","#9dd93b","#a0da39","#a2da37","#a5db36","#a8db34","#aadc32","#addc30","#b0dd2f","#b2dd2d","#b5de2b","#b8de29","#bade28","#bddf26","#c0df25","#c2df23","#c5e021","#c8e020","#cae11f","#cde11d","#d0e11c","#d2e21b","#d5e21a","#d8e219","#dae319","#dde318","#dfe318","#e2e418","#e5e419","#e7e419","#eae51a","#ece51b","#efe51c","#f1e51d","#f4e61e","#f6e620","#f8e621","#fbe723","#fde725"],type:"seq"},plasma:{256:["#0d0887","#100788","#130789","#16078a","#19068c","#1b068d","#1d068e","#20068f","#220690","#240691","#260591","#280592","#2a0593","#2c0594","#2e0595","#2f0596","#310597","#330597","#350498","#370499","#38049a","#3a049a","#3c049b","#3e049c","#3f049c","#41049d","#43039e","#44039e","#46039f","#48039f","#4903a0","#4b03a1","#4c02a1","#4e02a2","#5002a2","#5102a3","#5302a3","#5502a4","#5601a4","#5801a4","#5901a5","#5b01a5","#5c01a6","#5e01a6","#6001a6","#6100a7","#6300a7","#6400a7","#6600a7","#6700a8","#6900a8","#6a00a8","#6c00a8","#6e00a8","#6f00a8","#7100a8","#7201a8","#7401a8","#7501a8","#7701a8","#7801a8","#7a02a8","#7b02a8","#7d03a8","#7e03a8","#8004a8","#8104a7","#8305a7","#8405a7","#8606a6","#8707a6","#8808a6","#8a09a5","#8b0aa5","#8d0ba5","#8e0ca4","#8f0da4","#910ea3","#920fa3","#9410a2","#9511a1","#9613a1","#9814a0","#99159f","#9a169f","#9c179e","#9d189d","#9e199d","#a01a9c","#a11b9b","#a21d9a","#a31e9a","#a51f99","#a62098","#a72197","#a82296","#aa2395","#ab2494","#ac2694","#ad2793","#ae2892","#b02991","#b12a90","#b22b8f","#b32c8e","#b42e8d","#b52f8c","#b6308b","#b7318a","#b83289","#ba3388","#bb3488","#bc3587","#bd3786","#be3885","#bf3984","#c03a83","#c13b82","#c23c81","#c33d80","#c43e7f","#c5407e","#c6417d","#c7427c","#c8437b","#c9447a","#ca457a","#cb4679","#cc4778","#cc4977","#cd4a76","#ce4b75","#cf4c74","#d04d73","#d14e72","#d24f71","#d35171","#d45270","#d5536f","#d5546e","#d6556d","#d7566c","#d8576b","#d9586a","#da5a6a","#da5b69","#db5c68","#dc5d67","#dd5e66","#de5f65","#de6164","#df6263","#e06363","#e16462","#e26561","#e26660","#e3685f","#e4695e","#e56a5d","#e56b5d","#e66c5c","#e76e5b","#e76f5a","#e87059","#e97158","#e97257","#ea7457","#eb7556","#eb7655","#ec7754","#ed7953","#ed7a52","#ee7b51","#ef7c51","#ef7e50","#f07f4f","#f0804e","#f1814d","#f1834c","#f2844b","#f3854b","#f3874a","#f48849","#f48948","#f58b47","#f58c46","#f68d45","#f68f44","#f79044","#f79143","#f79342","#f89441","#f89540","#f9973f","#f9983e","#f99a3e","#fa9b3d","#fa9c3c","#fa9e3b","#fb9f3a","#fba139","#fba238","#fca338","#fca537","#fca636","#fca835","#fca934","#fdab33","#fdac33","#fdae32","#fdaf31","#fdb130","#fdb22f","#fdb42f","#fdb52e","#feb72d","#feb82c","#feba2c","#febb2b","#febd2a","#febe2a","#fec029","#fdc229","#fdc328","#fdc527","#fdc627","#fdc827","#fdca26","#fdcb26","#fccd25","#fcce25","#fcd025","#fcd225","#fbd324","#fbd524","#fbd724","#fad824","#fada24","#f9dc24","#f9dd25","#f8df25","#f8e125","#f7e225","#f7e425","#f6e626","#f6e826","#f5e926","#f5eb27","#f4ed27","#f3ee27","#f3f027","#f2f227","#f1f426","#f1f525","#f0f724","#f0f921"],type:"seq"},inferno:{256:["#000004","#010005","#010106","#010108","#02010a","#02020c","#02020e","#030210","#040312","#040314","#050417","#060419","#07051b","#08051d","#09061f","#0a0722","#0b0724","#0c0826","#0d0829","#0e092b","#10092d","#110a30","#120a32","#140b34","#150b37","#160b39","#180c3c","#190c3e","#1b0c41","#1c0c43","#1e0c45","#1f0c48","#210c4a","#230c4c","#240c4f","#260c51","#280b53","#290b55","#2b0b57","#2d0b59","#2f0a5b","#310a5c","#320a5e","#340a5f","#360961","#380962","#390963","#3b0964","#3d0965","#3e0966","#400a67","#420a68","#440a68","#450a69","#470b6a","#490b6a","#4a0c6b","#4c0c6b","#4d0d6c","#4f0d6c","#510e6c","#520e6d","#540f6d","#550f6d","#57106e","#59106e","#5a116e","#5c126e","#5d126e","#5f136e","#61136e","#62146e","#64156e","#65156e","#67166e","#69166e","#6a176e","#6c186e","#6d186e","#6f196e","#71196e","#721a6e","#741a6e","#751b6e","#771c6d","#781c6d","#7a1d6d","#7c1d6d","#7d1e6d","#7f1e6c","#801f6c","#82206c","#84206b","#85216b","#87216b","#88226a","#8a226a","#8c2369","#8d2369","#8f2469","#902568","#922568","#932667","#952667","#972766","#982766","#9a2865","#9b2964","#9d2964","#9f2a63","#a02a63","#a22b62","#a32c61","#a52c60","#a62d60","#a82e5f","#a92e5e","#ab2f5e","#ad305d","#ae305c","#b0315b","#b1325a","#b3325a","#b43359","#b63458","#b73557","#b93556","#ba3655","#bc3754","#bd3853","#bf3952","#c03a51","#c13a50","#c33b4f","#c43c4e","#c63d4d","#c73e4c","#c83f4b","#ca404a","#cb4149","#cc4248","#ce4347","#cf4446","#d04545","#d24644","#d34743","#d44842","#d54a41","#d74b3f","#d84c3e","#d94d3d","#da4e3c","#db503b","#dd513a","#de5238","#df5337","#e05536","#e15635","#e25734","#e35933","#e45a31","#e55c30","#e65d2f","#e75e2e","#e8602d","#e9612b","#ea632a","#eb6429","#eb6628","#ec6726","#ed6925","#ee6a24","#ef6c23","#ef6e21","#f06f20","#f1711f","#f1731d","#f2741c","#f3761b","#f37819","#f47918","#f57b17","#f57d15","#f67e14","#f68013","#f78212","#f78410","#f8850f","#f8870e","#f8890c","#f98b0b","#f98c0a","#f98e09","#fa9008","#fa9207","#fa9407","#fb9606","#fb9706","#fb9906","#fb9b06","#fb9d07","#fc9f07","#fca108","#fca309","#fca50a","#fca60c","#fca80d","#fcaa0f","#fcac11","#fcae12","#fcb014","#fcb216","#fcb418","#fbb61a","#fbb81d","#fbba1f","#fbbc21","#fbbe23","#fac026","#fac228","#fac42a","#fac62d","#f9c72f","#f9c932","#f9cb35","#f8cd37","#f8cf3a","#f7d13d","#f7d340","#f6d543","#f6d746","#f5d949","#f5db4c","#f4dd4f","#f4df53","#f4e156","#f3e35a","#f3e55d","#f2e661","#f2e865","#f2ea69","#f1ec6d","#f1ed71","#f1ef75","#f1f179","#f2f27d","#f2f482","#f3f586","#f3f68a","#f4f88e","#f5f992","#f6fa96","#f8fb9a","#f9fc9d","#fafda1","#fcffa4"],type:"seq"},magma:{256:["#000004","#010005","#010106","#010108","#020109","#02020b","#02020d","#03030f","#030312","#040414","#050416","#060518","#06051a","#07061c","#08071e","#090720","#0a0822","#0b0924","#0c0926","#0d0a29","#0e0b2b","#100b2d","#110c2f","#120d31","#130d34","#140e36","#150e38","#160f3b","#180f3d","#19103f","#1a1042","#1c1044","#1d1147","#1e1149","#20114b","#21114e","#221150","#241253","#251255","#271258","#29115a","#2a115c","#2c115f","#2d1161","#2f1163","#311165","#331067","#341069","#36106b","#38106c","#390f6e","#3b0f70","#3d0f71","#3f0f72","#400f74","#420f75","#440f76","#451077","#471078","#491078","#4a1079","#4c117a","#4e117b","#4f127b","#51127c","#52137c","#54137d","#56147d","#57157e","#59157e","#5a167e","#5c167f","#5d177f","#5f187f","#601880","#621980","#641a80","#651a80","#671b80","#681c81","#6a1c81","#6b1d81","#6d1d81","#6e1e81","#701f81","#721f81","#732081","#752181","#762181","#782281","#792282","#7b2382","#7c2382","#7e2482","#802582","#812581","#832681","#842681","#862781","#882781","#892881","#8b2981","#8c2981","#8e2a81","#902a81","#912b81","#932b80","#942c80","#962c80","#982d80","#992d80","#9b2e7f","#9c2e7f","#9e2f7f","#a02f7f","#a1307e","#a3307e","#a5317e","#a6317d","#a8327d","#aa337d","#ab337c","#ad347c","#ae347b","#b0357b","#b2357b","#b3367a","#b5367a","#b73779","#b83779","#ba3878","#bc3978","#bd3977","#bf3a77","#c03a76","#c23b75","#c43c75","#c53c74","#c73d73","#c83e73","#ca3e72","#cc3f71","#cd4071","#cf4070","#d0416f","#d2426f","#d3436e","#d5446d","#d6456c","#d8456c","#d9466b","#db476a","#dc4869","#de4968","#df4a68","#e04c67","#e24d66","#e34e65","#e44f64","#e55064","#e75263","#e85362","#e95462","#ea5661","#eb5760","#ec5860","#ed5a5f","#ee5b5e","#ef5d5e","#f05f5e","#f1605d","#f2625d","#f2645c","#f3655c","#f4675c","#f4695c","#f56b5c","#f66c5c","#f66e5c","#f7705c","#f7725c","#f8745c","#f8765c","#f9785d","#f9795d","#f97b5d","#fa7d5e","#fa7f5e","#fa815f","#fb835f","#fb8560","#fb8761","#fc8961","#fc8a62","#fc8c63","#fc8e64","#fc9065","#fd9266","#fd9467","#fd9668","#fd9869","#fd9a6a","#fd9b6b","#fe9d6c","#fe9f6d","#fea16e","#fea36f","#fea571","#fea772","#fea973","#feaa74","#feac76","#feae77","#feb078","#feb27a","#feb47b","#feb67c","#feb77e","#feb97f","#febb81","#febd82","#febf84","#fec185","#fec287","#fec488","#fec68a","#fec88c","#feca8d","#fecc8f","#fecd90","#fecf92","#fed194","#fed395","#fed597","#fed799","#fed89a","#fdda9c","#fddc9e","#fddea0","#fde0a1","#fde2a3","#fde3a5","#fde5a7","#fde7a9","#fde9aa","#fdebac","#fcecae","#fceeb0","#fcf0b2","#fcf2b4","#fcf4b6","#fcf6b8","#fcf7b9","#fcf9bb","#fcfbbd","#fcfdbf"],type:"seq"}}},1568:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||t.hasOwnProperty(s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,a(s(7931),t),a(s(9825),t),a(s(3332),t),a(s(3391),t),a(s(1007),t),a(s(9250),t),a(s(1871),t),a(s(5662),t),a(s(958),t),a(s(8276),t),a(s(4245),t),a(s(9401),t),a(s(3612),t),a(s(8881),t),a(s(9101),t),a(s(7829),t),a(s(4439),t),a(s(5935),t),a(s(5237),t),a(s(7384),t),a(s(3239),t),a(s(9461),t),a(s(5775),t),a(s(386),t),a(s(6401),t),a(s(1389),t),a(s(752),t),a(s(1718),t),a(s(1968),t),a(s(5252),t),a(s(7491),t),a(s(6535),t),a(s(5687),t),a(s(8393),t),a(s(9422),t),a(s(9498),t),a(s(7247),t),a(s(2205),t),a(s(8980),t),a(s(971),t),a(s(4060),t),a(s(6370),t),a(s(7119),t),a(s(9233),t),a(s(328),t),a(s(1266),t),a(s(8294),t),a(s(6589),t),a(s(8392),t),a(s(7676),t),a(s(3248),t),a(s(7105),t),a(s(9761),t),a(s(9539),t),a(s(6489),t),a(s(9096),t),a(s(7648),t),a(s(7703),t),a(s(657),t),a(s(36),t),a(s(3731),t),a(s(6988),t),a(s(6865),t),a(s(833),t),a(s(3445),t),a(s(7552),t),a(s(5561),t),a(s(4448),t),a(s(7408),t),a(s(9213),t),a(s(2931),t),a(s(6566),t),a(s(8137),t),a(s(9582),t),a(s(5997),t),t.version=s(306).version},1968:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.point_in_lasso=void 0,t.point_in_lasso=function(e,t){for(var s,i,a,r,n=e[0],l=e[1],o=!1,d=0,c=t.length-1;d<t.length;c=d++)s=t[d][0],a=t[d][1],i=t[c][0],a>l!=(r=t[c][1])>l&&n<(i-s)*(l-a)/(r-a)+s&&(o=!o);return o}},8882:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lasso_inter_rect=t.rect_inter_rect=t.point_in_rectangle=void 0;var i=s(1968);function a(e,t,s){if(0==t.length&&0==s.length)return!1;let i=!0;return 0!=t.length&&(i=i&&t[0]<=e[0]&&e[0]<=t[1]),0!=s.length&&(i=i&&s[0]<=e[1]&&e[1]<=s[1]),i}function r(e,t){return 0==e.length||0==t.length?0!=e.length||0!=t.length:(e.sort((function(e,t){return e-t})),t.sort((function(e,t){return e-t})),e[0]<t[0]!=e[0]<t[1]||e[1]<t[0]!=e[1]<t[1]||t[0]<e[0]!=t[0]<e[1]||t[1]<e[0]!=t[1]<e[1])}Object.defineProperty(t,"point_in_lasso",{enumerable:!0,get:function(){return i.point_in_lasso}}),t.point_in_rectangle=a,t.rect_inter_rect=function(e,t,s,i){return r(e,s)&&r(t,i)},t.lasso_inter_rect=function(e,t,s){for(let i=0;i<s.length;i++)if(a(s[i],e,t))return!0;return!1}},1961:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.array_or_json=void 0;const l=r(s(8731)),o=n(s(2729)),d={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array},c={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64"};t.array_or_json={deserialize:function e(t,s){if(!l.isArray(t)&&!l.isObject(t))return t;if(l.isArray(t))return l.map(t,(t=>e(t,s)));if(t.value&&t.dtype)return function(e){const t=d[e.dtype];if(null==e||!e.value||!e.value.buffer)throw new Error("Failed to deserialize data");const s=new t(e.value.buffer);if(s.type=e.type,e.shape&&e.shape.length>=2){if(e.shape.length>2)throw new Error("only arrays with rank 1 or 2 supported");const t=[];for(let i=0;i<e.shape[0];i++)t.push(s.slice(i*e.shape[1],(i+1)*e.shape[1]));return t}return s}(t);throw new Error("Failed to deserialize data")},serialize:function e(t,s){if(!l.isArray(t)&&!l.isObject(t))return t;if(l.isArray(t))return l.map(t,e);if(o.default(t))return function(e){null==e&&console.log("data is null"),e.buffer||console.log("ar.buffer is null or not defined");const t=c[e.constructor.name],s=e.type||null;return{dtype:t,value:new DataView(e.buffer),shape:[e.length],type:s}}(t);throw new Error("Failed to serialize data")}}},6988:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return a(t,e),t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getDate=t.is_array=t.is_valid_time_format=t.getCustomRange=t.convert_dates=t.deepCopy=void 0;const l=r(s(8944)),o=n(s(2729)),d=r(s(8731)),c=new RegExp("^(((((\\*)|(/*)|(-*))(\\s*)%([aAbBdeHIjmMLpSUwWyYZ]{1}))+)|((\\s*)%([cxX]{1})))$");t.deepCopy=function e(t){if(o.default(t))return Object.assign(t.slice(),t);if(d.isArray(t))return t.map((t=>e(t)));if(d.isNumber(t)||d.isString(t))return t;if(d.isDate(t))return new Date(t.getTime());{const s={};for(let i in t)t.hasOwnProperty(i)&&(s[i]=e(t[i]));return s}},t.convert_dates=function(e){if(o.default(e))return e;const t=function(e){const t=new Float64Array(e.map(Number));return t.type="date",t};return e[0]instanceof Array&&e[0][0]instanceof Date?e=e.map(t):e[0]instanceof Date&&(e=t(e)),e},t.getCustomRange=function(e){const t=e[0],s=e[e.length-1];let i;return i=e[0]>e[1]?l.min(e):l.max(e),[l.scaleLinear().range([t,i]),l.scaleLinear().range([i,s])]},t.is_valid_time_format=function(e){return c.test(e)},t.is_array=function(e){return e instanceof Array||o.default(e)},t.getDate=function(e){return null==e?null:new Date(e)}},8657:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.semver_range=void 0,t.semver_range="^"+s(306).version},8016:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i="float scale_transform_linear(float domain_value, vec2 range, vec2 domain) {\n    float normalized = (domain_value - domain[0]) / (domain[1] - domain[0]);\n    float range_value = normalized * (range[1] - range[0]) + range[0];\n    return range_value;\n}\n\nfloat scale_transform_linear_inverse(float range_value, vec2 range, vec2 domain) {\n    float normalized = (range_value - range[0]) / (range[1] - range[0]);\n    float domain_value = normalized * (domain[1] - domain[0]) + domain[0];\n    return domain_value;\n}\n\nfloat scale_transform_log(float domain_value, vec2 range, vec2 domain) {\n    float normalized = (log(domain_value) - log(domain[0])) / (log(domain[1]) - log(domain[0]));\n    float range_value = normalized * (range[1] - range[0]) + range[0];\n    return range_value;\n}\n\nfloat scale_transform_log_inverse(float range_value, vec2 range, vec2 domain) {\n    float normalized = (range_value - range[0]) / (range[1] - range[0]);\n    float domain_value = exp(normalized * (log(domain[1]) - log(domain[0])) + log(domain[0]));\n    return domain_value;\n}"},5289:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i="#include <fog_pars_fragment>\n#include <alphamap_pars_fragment>\n\nprecision highp float;\nprecision highp int;\n\n#define FAST_CIRCLE 1\n#define FAST_SQUARE 2\n#define FAST_ARROW 3\n#define FAST_CROSS 4\n#define FAST_TRIANGLE_UP 5\n#define FAST_TRIANGLE_DOWN 6\n\n// This parameter is used for reducing aliasing\n#define SMOOTH_PIXELS 1.0\n\n// ANGLE_X = X * PI / 180.\n#define ANGLE_20 0.3490658503988659\n#define ANGLE_60 1.0471975511965976\n\nvarying vec4 v_fill_color;\nvarying vec4 v_stroke_color;\nvarying float v_inner_size;\nvarying float v_outer_size;\nvarying vec2 v_pixel;\n\nuniform float stroke_width;\n\n\n/*\n * Rotate a point in the 2-D plane, given an angle in radians\n */\nvec2 rotate_xy(vec2 x, float angle) {\n    float sina = sin(angle);\n    float cosa = cos(angle);\n    mat2 m = mat2(cosa, -sina, sina, cosa);\n    return m * x.xy;\n}\n\n/*\n * Returns 1.0 if pixel inside of a circle (0.0 otherwise) given the circle radius and the\n * pixel position.\n */\nfloat smooth_circle(in float radius, in vec2 pixel_position) {\n    // This function does not use the ellipse function for optimization purpose\n    // Circle equation: x^2 + y^2 = radius^2\n    float d = dot(pixel_position, pixel_position);\n    float r1 = pow(radius - SMOOTH_PIXELS, 2.0);\n    float r2 = pow(radius + SMOOTH_PIXELS, 2.0);\n    return 1.0 - smoothstep(r1, r2, d);\n}\n\n/*\n * Returns 1.0 if pixel inside of an ellipse (0.0 otherwise) given the ellipse radius and the\n * pixel position.\n */\nfloat smooth_ellipse(in float a, in float b, in vec2 pixel_position) {\n    // Ellipse equation: b^2 * x^2 + a^2 * y^2 = a^2 * b^2\n    float r_x = pow(a, 2.0);\n    float r_y = pow(b, 2.0);\n    float d = r_y * pow(pixel_position.x, 2.0) + r_x * pow(pixel_position.y, 2.0);\n    float r1 = pow(a - SMOOTH_PIXELS, 2.0) * pow(b - SMOOTH_PIXELS, 2.0);\n    float r2 = pow(a + SMOOTH_PIXELS, 2.0) * pow(b + SMOOTH_PIXELS, 2.0);\n    return 1.0 - smoothstep(r1, r2, d);\n}\n\n/*\n * Returns 1.0 if pixel inside of a rectangle (0.0 otherwise) given the rectangle half-size\n * on the x and y axes and the pixel position.\n */\nfloat smooth_rectangle(in vec2 size, in vec2 pixel_position) {\n    vec2 rec = smoothstep(vec2(-SMOOTH_PIXELS), vec2(SMOOTH_PIXELS), size - abs(pixel_position));\n    return rec.x * rec.y;\n}\n\n/*\n * Returns 1.0 if pixel inside of a rectangle (0.0 otherwise) given the rectangle half-size\n * on the x and y axes and the pixel position.\n */\nfloat rectangle(in vec2 size, in vec2 pixel_position) {\n    vec2 rec = step(0.0, size - abs(pixel_position));\n    return rec.x * rec.y;\n}\n\n/*\n * Returns 1.0 if pixel inside of a square (0.0 otherwise) given the square half-size\n * and the pixel position.\n */\nfloat smooth_square(in float size, in vec2 pixel_position) {\n    return smooth_rectangle(vec2(size), pixel_position);\n}\n\nfloat smooth_isosceles_triangle(in float angle, in float height, in vec2 pixel_position) {\n    float half_angle = angle / 2.0;\n\n    // The triangle center is on vec2(0.0, -height/3.0)\n    vec2 translated_pixel = vec2(pixel_position.x, pixel_position.y - height / 3.0);\n\n    vec2 pixel_left = rotate_xy(translated_pixel, -half_angle);\n    vec2 pixel_right = rotate_xy(translated_pixel, half_angle);\n\n    float half_height = height * 0.5;\n\n    float half_bottom = half_height * tan(half_angle);\n\n    return smoothstep(-SMOOTH_PIXELS, SMOOTH_PIXELS, half_bottom + pixel_left.x) *\n           smoothstep(-SMOOTH_PIXELS, SMOOTH_PIXELS, half_bottom - pixel_right.x) *\n           smoothstep(-SMOOTH_PIXELS, SMOOTH_PIXELS, translated_pixel.y + half_height);\n}\n\n\n/*\n * Returns 1.0 if pixel inside of a cross shape (0.0 otherwise) given the cross half-size\n * on the x and y axes and the pixel position.\n */\nfloat cross(in vec2 size, in vec2 pixel_position) {\n    float cross_shape = rectangle(size.xy, pixel_position) +\n                        rectangle(size.yx, pixel_position);\n    return clamp(cross_shape, 0.0, 1.0);\n}\n\n\nvoid main(void) {\n    // fill_weight and stroke_weight are color factors\n    // e.g. if fill_weight == 1.0 then the pixel color will be v_fill_color\n    // e.g. if stroke_weight == 1.0 then the pixel color will be v_stroke_color\n    float fill_weight = 0.0;\n    float stroke_weight = 0.0;\n\n    // Note for the reader: In the following code,\n    // - `1.0`     -> True\n    // - `0.0`     -> False\n    // - `1.0 - A` -> NOT A\n    // - `A + B`   -> A OR B\n    // - `A * B`   -> A AND B\n\n    float inner_shape = 0.0;\n    float outer_shape = 0.0;\n\n#if FAST_DRAW == FAST_CIRCLE\n\n    inner_shape = smooth_circle(v_inner_size, v_pixel);\n    outer_shape = smooth_circle(v_outer_size, v_pixel);\n\n#elif FAST_DRAW == FAST_SQUARE\n\n    inner_shape = smooth_square(v_inner_size, v_pixel);\n    outer_shape = 1.0; // Always in the outer_shape\n\n#elif FAST_DRAW == FAST_CROSS\n\n    float r = v_outer_size / 3.0;\n\n    inner_shape = cross(vec2(v_inner_size, r - 2.0 * stroke_width), v_pixel);\n    outer_shape = cross(vec2(r, v_outer_size), v_pixel);\n\n#elif FAST_DRAW == FAST_ARROW\n\n    inner_shape = smooth_isosceles_triangle(ANGLE_20, v_inner_size, v_pixel);\n    outer_shape = smooth_isosceles_triangle(ANGLE_20, v_outer_size, v_pixel);\n\n#elif FAST_DRAW == FAST_TRIANGLE_UP\n\n    inner_shape = smooth_isosceles_triangle(ANGLE_60, v_inner_size, v_pixel);\n    outer_shape = smooth_isosceles_triangle(ANGLE_60, v_outer_size, v_pixel);\n\n#elif FAST_DRAW == FAST_TRIANGLE_DOWN\n\n    vec2 reversed_pixel = vec2(v_pixel.x, -v_pixel.y);\n\n    inner_shape = smooth_isosceles_triangle(ANGLE_60, v_inner_size, reversed_pixel);\n    outer_shape = smooth_isosceles_triangle(ANGLE_60, v_outer_size, reversed_pixel);\n\n#endif\n\n    // `inner_shape` is the shape without the stroke, `outer_shape` is the shape with the stroke\n    // note that the stroke is always drawn, only that it has the `v_fill_color` if stroke is None\n    fill_weight = inner_shape;\n    stroke_weight = (1.0 - inner_shape) * outer_shape;\n\n#if !FILL\n    fill_weight = 0.0;\n#endif\n\n    gl_FragColor = v_fill_color * fill_weight + v_stroke_color * stroke_weight;\n}\n"},2506:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i='#include <fog_pars_vertex>\n#include <scales>\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\n // for animation, all between 0 and 1\nuniform float animation_time_x;\nuniform float animation_time_y;\nuniform float animation_time_z;\nuniform float animation_time_size;\nuniform float animation_time_rotation;\nuniform float animation_time_opacity;\n\n#ifdef HAS_DEFAULT_STROKE_COLOR\nuniform vec4 default_stroke_color;\n#endif\n\nuniform bool has_selection;\nuniform bool has_hover;\n\n// maybe faster to use #IFDEFS\nuniform bool has_selected_fill;\nuniform vec4 selected_fill;\nuniform bool has_selected_stroke;\nuniform vec4 selected_stroke;\nuniform bool has_selected_opacity;\nuniform float selected_opacity;\n\nuniform bool has_unselected_fill;\nuniform vec4 unselected_fill;\nuniform bool has_unselected_stroke;\nuniform vec4 unselected_stroke;\nuniform bool has_unselected_opacity;\nuniform float unselected_opacity;\n\n\nuniform bool has_hovered_fill;\nuniform vec4 hovered_fill;\nuniform bool has_hovered_stroke;\nuniform vec4 hovered_stroke;\nuniform bool has_hovered_opacity;\nuniform float hovered_opacity;\n\nuniform bool has_unhovered_fill;\nuniform vec4 unhovered_fill;\nuniform bool has_unhovered_stroke;\nuniform vec4 unhovered_stroke;\nuniform bool has_unhovered_opacity;\nuniform float unhovered_opacity;\n\nuniform vec2 domain_x;\nuniform vec2 domain_y;\nuniform vec2 domain_z;\nuniform vec2 domain_size;\nuniform vec2 domain_rotation;\nuniform vec2 domain_opacity;\n\nuniform vec2 range_x;\nuniform vec2 range_y;\nuniform vec2 range_z;\nuniform vec2 range_size;\nuniform vec2 range_rotation;\nuniform vec2 range_opacity;\n\nuniform bool fill;\nuniform float stroke_width;\nuniform float marker_scale;\n\nvarying vec4 v_fill_color;\nvarying vec4 v_stroke_color;\nvarying float v_inner_size;\nvarying float v_outer_size;\nvarying vec2 v_pixel;\n\nattribute vec3 position;\nattribute vec2 uv;\n\nattribute float x;\nattribute float x_previous;\nattribute float y;\nattribute float y_previous;\n\nattribute float size;\nattribute float size_previous;\n\nattribute float rotation;\nattribute float rotation_previous;\n\nattribute float opacity;\nattribute float opacity_previous;\n\n// Boolean or int not supported for attributes, using a float instead\nattribute float selected;\n\nuniform sampler2D colormap;\nuniform vec2 domain_color;\n\n#ifdef USE_COLORMAP\nattribute float color;\n#else\nattribute vec3 color;\n#endif\n\n\n#define SCALE_X(x) scale_transform_linear(x, range_x, domain_x)\n#define SCALE_Y(x) scale_transform_linear(x, range_y, domain_y)\n#define SCALE_SIZE(x) scale_transform_linear(x, range_size, domain_size)\n#define SCALE_ROTATION(x) scale_transform_linear(x, range_rotation, domain_rotation)\n#define SCALE_OPACITY(x) scale_transform_linear(x, range_opacity, domain_opacity)\n\nvec3 rotate_xy(vec3 x, float angle) {\n    float sina = sin(angle);\n    float cosa = cos(angle);\n    mat2 m = mat2(cosa, -sina, sina, cosa);\n    return vec3(m * x.xy, x.z);\n}\n\nvoid main(void) {\n\n    vec3 animation_time = vec3(animation_time_x, animation_time_y, animation_time_z);\n\n\n    vec3 domain_offset = vec3(domain_x.x, domain_y.x, domain_z.x);\n    vec3 domain_scale  = vec3(domain_x.y, domain_y.y, domain_z.y) - domain_offset;\n    vec3 range_offset = vec3(range_x.x, range_y.x, range_z.x);\n    vec3 range_scale  = vec3(range_x.y, range_y.y, range_z.y) - range_offset;\n\n    vec3 center = mix(vec3(x_previous, y_previous, 0), vec3(x, y, 0), animation_time);\n\n    // vec3 center_normalized = (center - domain_offset) / domain_scale;\n    // vec3 center_pixels = ((center_normalized*2.)-0.) * range_scale + range_offset;\n    // times 2 because the normalized coordinates go from [-1, 1]\n    vec3 center_pixels = vec3(SCALE_X(center.x), SCALE_Y(center.y), 0) * 2.;\n\n\n    // times 4 because of the normalized coordinates, and radius vs diameter use\n    float marker_size = sqrt(mix(SCALE_SIZE(size_previous), SCALE_SIZE(size), animation_time_size)) * marker_scale * 4.;\n    // we draw larger than the size for the stroke_width (on both side)\n\n    // `v_inner_size` is the marker "radius" without the stroke, `v_outer_size` is the marker "radius" with the stroke\n    v_inner_size = marker_size * 0.5 - stroke_width;\n    v_outer_size = marker_size * 0.5 + stroke_width;\n\n    // `full_size` is the marker "diameter" with the stroke\n    float full_size = marker_size + 2.0 * stroke_width;\n\n    // `v_pixel` is the pixel position relatively to the marker,\n    // e.g. vec2(0.) would be the center of the square marker\n    // e.g. vec2(0.5 * full_size) would be the top-right pixel of the square marker\n    v_pixel = (uv - 0.5) * (full_size);\n\n    float angle = SCALE_ROTATION(mix(rotation_previous, rotation, animation_time_rotation));\n    vec3 model_pos = rotate_xy(position, 1.) * full_size + center_pixels;\n\n#ifdef USE_COLORMAP\n    float color_index = (color - domain_color.x) / (domain_color.y - domain_color.x);\n    vec4 color_rgba = texture2D(colormap, vec2(color_index, 0));\n#else\n    vec4 color_rgba = vec4(color, 1.0);\n#endif\n\n    v_fill_color = color_rgba;\n    v_stroke_color = color_rgba;\n\n#ifdef HAS_DEFAULT_STROKE_COLOR\n    v_stroke_color = default_stroke_color;\n#endif\n\n    float opacity_value = SCALE_OPACITY(mix(opacity_previous, opacity, animation_time_opacity));\n    v_fill_color.a *= opacity_value;\n    v_stroke_color.a *= opacity_value;\n\n    if(has_selection) {\n        if(has_selected_fill && selected > 0.5 )\n            v_fill_color = selected_fill;\n        if(has_unselected_fill && selected < 0.5 )\n            v_fill_color = unselected_fill;\n        if(has_selected_stroke && selected > 0.5 )\n            v_stroke_color = selected_stroke;\n        if(has_unselected_stroke && selected < 0.5 )\n            v_stroke_color = unselected_stroke;\n        if(has_selected_opacity && selected > 0.5 ) {\n            v_stroke_color.a *= selected_opacity;\n            v_fill_color.a *= selected_opacity;\n        }\n        if(has_unselected_opacity && selected < 0.5 ) {\n            v_stroke_color.a *= unselected_opacity;\n            v_fill_color.a *= unselected_opacity;\n        }\n    }\n\n    v_fill_color.rgb *= v_fill_color.a;\n    v_stroke_color.rgb *= v_stroke_color.a;\n\n    // color_rgba = has_selection && has_selected_color ? (selected > 0.5 ? selected_color : unselected_color) : color_rgba;\n    gl_Position = projectionMatrix * vec4(rotate_xy(position, angle) * full_size, 1.0) +\n                  projectionMatrix * modelViewMatrix * vec4(center_pixels + vec3(0., 0., 0.), 1.0);\n}\n'},306:e=>{"use strict";e.exports={version:"0.5.21"}}}]);